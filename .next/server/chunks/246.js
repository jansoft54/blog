"use strict";exports.id=246,exports.ids=[246],exports.modules={46246:(s,e,a)=>{a.d(e,{wz:()=>t,R6:()=>n}),a(87192);let n=JSON.parse('[{"title":"Introduction to Gaussian Process Regression","date":"2024-03-08T00:00:00.000Z","tags":["math","statistics","theory"],"draft":false,"summary":"A short introduction to gaussian processes and how one can employ them for regression tasks.","body":{"raw":"\\nGaussian processes are a robust and flexible method in machine learning, capable of leveraging prior information to make predictions.\\nTheir primary use is in regression, where they model data by fitting.\\nHowever, their utility goes beyond regression, extending to tasks like classification and clustering.\\nWhen faced with training data, countless functions can potentially describe it.\\nGaussian processes tackle this challenge by assigning a likelihood to each function, with the average of this distribution serving as the most plausible representation of the data.\\nMoreover, their probabilistic framework naturally incorporates prediction uncertainty, providing insights into the confidence of the results.\\n\\n## Introductory concepts\\n\\nGaussian processes are built upon the mathematical framework of the multivariate Gaussian distribution, which extends the familiar Gaussian (or normal) distribution to multiple random variables that are jointly normally distributed.\\nThis distribution is characterized by two key components: a mean vector, **$\\\\mu$**, and a covariance matrix, **$\\\\Sigma = \\\\text{Cov}(X_i, X_j)$**, which describes the relationships between pairs of variables.\\nBefore diving into these concepts, we will first cover some fundamental terms from probability theory to ensure we have a shared understanding.\\n\\nGenerally, a multivariate Gaussian distribution is expressed as:\\n\\n$$\\nX =\\n\\\\begin{bmatrix}\\nX_1 \\\\\\\\\\nX_2 \\\\\\\\\\n\\\\vdots \\\\\\\\\\nX_n\\n\\\\end{bmatrix}\\n\\\\sim \\\\mathcal{N}(\\\\mu, \\\\Sigma)\\n$$\\n\\nwhere $X$ is a vector of random variables.\\n\\nThe covariance matrix **$\\\\Sigma$** determines the shape of the distribution and, in the 2D case, can be represented as:\\n\\n$$\\n\\\\Sigma =\\n\\\\begin{bmatrix}\\n\\\\sigma_1^2 & \\\\sigma_1 \\\\sigma_2 \\\\\\\\\\n\\\\sigma_2 \\\\sigma_1 & \\\\sigma_2^2\\n\\\\end{bmatrix}\\n$$\\n\\nContour plots of the multivariate Gaussian distribution illustrate how $\\\\Sigma$ affects the spread and orientation of the distribution.\\nAn example of such plots for different covariance matrices $\\\\Sigma$ is shown in the [figure](#multivariate) below, demonstrating how the covariance influences the relationships between variables.\\n\\n    <img\\n    id=\\"multivariate\\"\\n    src=\\"/static/images/blog/gaussian-process/multivariate.png\\"\\n    alt=\\"Description of the image\\"\\n    style={{ width: \'80%\', height: \'auto\',\\"padding-left\\":\\"10%\\" }}\\n    />\\n\\n## Conditioning\\n\\nSuppose a joint dristribution of two vectors of gaussian random variables $$X$$ and $$Y$$\\n\\n$$\\nP_{X,Y} =\\n\\\\begin{bmatrix}\\nX \\\\\\\\\\nY\\n\\\\end{bmatrix}\\n\\\\sim \\\\mathcal{N}(\\\\mu, \\\\Sigma) =\\n\\\\mathcal{N}\\\\left(\\n\\\\begin{bmatrix}\\n\\\\mu_X \\\\\\\\\\n\\\\mu_Y\\n\\\\end{bmatrix},\\n\\\\begin{bmatrix}\\n\\\\Sigma_{XX} & \\\\Sigma_{XY} \\\\\\\\\\n\\\\Sigma_{YX} & \\\\Sigma_{YY}\\n\\\\end{bmatrix}\\n\\\\right).\\n$$\\n\\nThe covariance matrices, such as **$\\\\Sigma_{XX}$**, are themselves matrices, ensuring that the final covariance matrix has a size of **$|X| + |Y|$**.\\nWe can derive the conditional multivariate distributions using the following expressions:\\n\\n$$\\nP_{X \\\\mid Y} \\\\sim \\\\mathcal{N}\\\\left(\\n\\\\mu_X + \\\\Sigma_{XY} \\\\Sigma_{YY}^{-1} (Y - \\\\mu_Y),\\n\\\\Sigma_{XX} - \\\\Sigma_{XY} \\\\Sigma_{YY}^{-1} \\\\Sigma_{YX}\\n\\\\right)\\n$$\\n\\nor\\n\\n$$\\n\\nP_{Y \\\\mid X} \\\\sim \\\\mathcal{N}\\\\left(\\n\\\\mu_Y + \\\\Sigma_{YX} \\\\Sigma_{XX}^{-1} (X - \\\\mu_X),\\n\\\\Sigma_{YY} - \\\\Sigma_{YX} \\\\Sigma_{XX}^{-1} \\\\Sigma_{XY}\\n\\\\right).\\n$$\\n\\n## Marginalization\\n\\nAnother important concept is **marginalization**. Marginalization over a random variable in a joint distribution involves summing (or integrating) over all possible values of the other variable in the conditional distribution.\\n\\nFor example, given two vectors of Gaussian random variables:\\n\\n$$\\nX \\\\sim \\\\mathcal{N}(\\\\mu_X, \\\\Sigma_{XX})\\\\\\\\\\nY \\\\sim \\\\mathcal{N}(\\\\mu_Y, \\\\Sigma_{YY})\\n$$\\n\\nand their joint distribution $$P_{X,Y} $$, we can marginalize over $$ Y $$ as follows:\\n\\n$$\\np_X(x) = \\\\int_y p_{X,Y}(x, y) \\\\, dy = \\\\int_y p_{X \\\\mid Y}(x \\\\mid y) p_Y(y) \\\\, dy\\n$$\\n\\nWe can observe the differences between **conditioning** and **marginalization** in the [figure](#cond) below.\\n\\n<img\\n  id=\\"cond\\"\\n  src=\\"/static/images/blog/gaussian-process/cond.png\\"\\n  alt=\\"Description of the image\\"\\n  style={{ width: \'80%\', height: \'auto\', \'padding-left\': \'10%\' }}\\n/>\\nAs shown, **conditioning** involves slicing through the distribution at a specific value, resulting\\nin a distribution with one less dimension. In this case, it becomes a 1D distribution, which is a\\nsimple normal distribution. **Marginalization** on the other hand acts like projecting the whole 2D\\ndistribution into one dimension, in this case $$Y$$.\\n\\n## Gaussian processes\\n\\nNow that we have covered the basic concepts, we can discuss how to use them to formulate the ideas behind Gaussian processes and Gaussian process regression.\\nThe basic idea is as follows: given a set of sample positions **$\\\\{x_i\\\\}_1^n$** of a function $$ f$$, we aim to determine **$X_i = f(x_i)$**, where $$ X_i $$ is the i-th entry of a random vector $$ X $$. This vector follows a multivariate normal distribution, meaning:\\n\\n$$\\nX \\\\sim \\\\mathcal{N}(\\\\mu_X, \\\\Sigma_{XX}).\\n$$\\n\\nFor simplicity, we often assume **$\\\\mu_X = 0$**. However, calculating **$\\\\Sigma_{XX}$** involves another mathematical concept called a **kernel function**.\\n\\nThe **kernel** function **$k$**, defined as **$k \\\\colon \\\\mathbb{R}^n \\\\times \\\\mathbb{R}^n \\\\to \\\\mathbb{R}$**, is a measure of similarity between its inputs. A high output value for **$k$** indicates high similarity between inputs, and vice versa.\\n\\nIn our case, the kernel function is used to compute the covariance matrix **$\\\\Sigma_{XX}$** of the multivariate normal distribution. To calculate each entry of **$\\\\text{Cov}(X, X)$**, we assume:\\n\\n$$\\n\\\\text{Cov}(X_i, X_j) = k(x_i, x_j),\\n$$\\n\\nmeaning that the covariance between two function values **$X_i$** and **$X_j$** is high when their corresponding inputs **$x_i$** and **$x_j$** are close together.\\n\\n### Common Kernel Functions\\n\\nBelow are some commonly used kernel functions in the context of Gaussian processes, some of them take hyperparameters like $$l$$ or $$\\\\sigma$$:\\n\\n1. **RBF Kernel:**\\n\\n$$\\nk(t, t\') = \\\\sigma^2 \\\\exp\\\\left(-\\\\frac{\\\\|t - t\'\\\\|^2}{2l^2}\\\\right)\\n$$\\n\\n2. **Periodic Kernel:**\\n\\n$$\\nk(t, t\') = \\\\sigma^2 \\\\exp\\\\left(-\\\\frac{2 \\\\sin^2\\\\left(\\\\pi \\\\frac{|t - t\'|}{p}\\\\right)}{l^2}\\\\right)\\n$$\\n\\n3. **Linear Kernel:**\\n\\n$$\\nk(t, t\') = \\\\sigma_b^2 + \\\\sigma^2 (t - c)(t\' - c)\\n$$\\n\\nDifferent values for hyperparameters make the similarity measure of the kernels more or less strict, leading\\nto sharper or smoother functions in the process.\\n\\nNow that we have a method to compute the covariance matrix **$\\\\Sigma_{XX}$**, we can sample a random function $$ f $$ by drawing a sample $$ X $$ from the multivariate normal distribution **$\\\\mathcal{N}(\\\\mu_X, \\\\Sigma_{XX})$**.\\nEach entry $$ X_i $$ in the sampled vector corresponds to the value of $$ f $$ at $$ x_i $$, meaning $$X_i = f(x_i).$$\\n\\n## Gaussian Processes for Regression\\n\\nWe have now covered the fundamentals of Gaussian processes.\\nNext, we will extend our understanding to explore how Gaussian processes can be applied to solve regression tasks.\\n\\n<img\\n  id=\\"regression\\"\\n  src=\\"/static/images/blog/gaussian-process/regression.png\\"\\n  alt=\\"Description of the image\\"\\n  style={{ width: \'80%\', height: \'auto\', \'padding-left\': \'10%\' }}\\n/>\\nBefore diving into the technical details, our objective is clear: to model a distribution of\\nfunctions that pass through our training points ([as shown in the image above](#regression)) and are\\ntherefore able to explain the distribution of our data.\\n\\nNow, let $$ X $$ represent our test points and $$ Y $$ our training points. We aim to model the posterior distribution $$ X \\\\mid Y $$, which answers the question:\\n\\n_\\"What possible values for $$ X $$ are there, given the training points in $$ Y $$?\\"_\\n\\nThis is where **conditioning** comes into play. Computing the distribution $$P_{X|Y}$$ provides us with functions $$ f $$ that pass precisely through the points in $$ Y $$.\\nConceptually, we can think of this as slicing through a $$ |X| + |Y| $$-dimensional normal distribution, fixing the values at $$ |Y| $$ locations as constants. This results in a $$ |X| $$-dimensional normal distribution.\\n\\nAs we know it is easy to calculate distribution for $$P_{X, Y}$$ with\\n\\n$$\\nP_{X,Y}\\n\\\\sim\\n\\\\mathcal{N}\\\\left(\\n\\\\begin{bmatrix}\\n\\\\mu_X \\\\\\\\\\n\\\\mu_Y\\n\\\\end{bmatrix},\\n\\\\begin{bmatrix}\\n\\\\Sigma_{XX} & \\\\Sigma_{XY} \\\\\\\\\\n\\\\Sigma_{YX} & \\\\Sigma_{YY}\\n\\\\end{bmatrix}\\n\\\\right).\\n$$\\n\\nFrom our prerequisites, we know that $$P_{X|Y}$$ can be calculated as:\\n\\n$$\\nP_{X|Y} \\\\sim \\\\mathcal{N}\\\\left(\\n\\\\mu_X + \\\\Sigma_{XY} \\\\Sigma_{YY}^{-1} (Y - \\\\mu_Y),\\n\\\\Sigma_{XX} - \\\\Sigma_{XY} \\\\Sigma_{YY}^{-1} \\\\Sigma_{YX}\\n\\\\right)\\n$$\\n\\nThis is the final distribution from which we can sample.\\nIt provides functions that pass through all points in $$ Y $$ and whose behavior for $$ X $$ is modeled by $$P_{X|Y}$$ (see image above).\\nThe [figure](#regression) also illustrates the **95% confidence interval** ($$2\\\\sigma$$) and the mean function.\\nIn practice, the mean function is often the most useful for regression or prediction tasks, as it provides the expected value of the output based on the given data.\\nGetting the mean function as well as the $$2\\\\sigma$$ confidence interval is really easy once we obtained the $$\\\\mu$$ and $$\\\\Sigma$$ for $$P_{X|Y}$$.\\nWe can just query them at the i-th point and get the respective $$\\\\mu_i$$ and $$\\\\Sigma_{ii} = \\\\sigma_i$$. This wil result in\\n\\n$$\\n[\\\\mu_{X|Y}]_i = [\\\\mu_X + \\\\Sigma_{XY} \\\\Sigma_{YY}^{-1} (Y - \\\\mu_Y)]_i = [\\\\Sigma_{XY} \\\\Sigma_{YY}^{-1} Y]_i,\\n$$\\n\\nwhere the second equality stems from the fact that we assume $$\\\\mu_{X} = 0$$ and $$\\\\mu_{Y}=0$$. For the standart deviation we get\\n\\n$$\\n\\\\sigma_i = [\\\\Sigma_{XX} - \\\\Sigma_{XY} \\\\Sigma_{YY}^{-1} \\\\Sigma_{YX}.\\n]_{ii}\\n$$\\n\\nDoing this for every point $$x_i$$ will result in the same [figure](#regression) we saw above.\\n\\nSo in summary, gaussian processes are a flexible framework for regression, where functions are modeled as samples from a multivariate normal distribution.\\nA kernel function is used to compute the covariance matrix **$\\\\Sigma_{XX}$**, which encodes the similarity between inputs.\\nThe posterior distribution **$P_{X|Y}$** then allows us to generate functions that pass through the training points $$ Y $$ while predicting the behavior for test points $$ X $$.\\nIn the end, we use the mean function provided by this posterior because it represents the most likely prediction for the underlying function.\\n","code":"var Component=(()=>{var p=Object.create;var i=Object.defineProperty;var N=Object.getOwnPropertyDescriptor;var g=Object.getOwnPropertyNames;var o=Object.getPrototypeOf,y=Object.prototype.hasOwnProperty;var v=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),u=(a,e)=>{for(var l in e)i(a,l,{get:e[l],enumerable:!0})},t=(a,e,l,m)=>{if(e&&typeof e==\\"object\\"||typeof e==\\"function\\")for(let n of g(e))!y.call(a,n)&&n!==l&&i(a,n,{get:()=>e[n],enumerable:!(m=N(e,n))||m.enumerable});return a};var w=(a,e,l)=>(l=a!=null?p(o(a)):{},t(e||!a||!a.__esModule?i(l,\\"default\\",{value:a,enumerable:!0}):l,a)),x=a=>t(i({},\\"__esModule\\",{value:!0}),a);var r=v((f,c)=>{c.exports=_jsx_runtime});var R={};u(R,{default:()=>d,frontmatter:()=>b});var s=w(r()),b={title:\\"Introduction to Gaussian Process Regression\\",date:\\"2024-03-08\\",tags:[\\"math\\",\\"statistics\\",\\"theory\\"],draft:!1,summary:\\"A short introduction to gaussian processes and how one can employ them for regression tasks.\\"};function h(a){let e={a:\\"a\\",annotation:\\"annotation\\",em:\\"em\\",h2:\\"h2\\",h3:\\"h3\\",li:\\"li\\",math:\\"math\\",mfrac:\\"mfrac\\",mi:\\"mi\\",mn:\\"mn\\",mo:\\"mo\\",mpadded:\\"mpadded\\",mrow:\\"mrow\\",mspace:\\"mspace\\",mstyle:\\"mstyle\\",msub:\\"msub\\",msubsup:\\"msubsup\\",msup:\\"msup\\",mtable:\\"mtable\\",mtd:\\"mtd\\",mtext:\\"mtext\\",mtr:\\"mtr\\",ol:\\"ol\\",p:\\"p\\",path:\\"path\\",semantics:\\"semantics\\",span:\\"span\\",strong:\\"strong\\",svg:\\"svg\\",...a.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.p,{children:\\"Gaussian processes are a robust and flexible method in machine learning, capable of leveraging prior information to make predictions. Their primary use is in regression, where they model data by fitting. However, their utility goes beyond regression, extending to tasks like classification and clustering. When faced with training data, countless functions can potentially describe it. Gaussian processes tackle this challenge by assigning a likelihood to each function, with the average of this distribution serving as the most plausible representation of the data. Moreover, their probabilistic framework naturally incorporates prediction uncertainty, providing insights into the confidence of the results.\\"}),(0,s.jsxs)(e.h2,{className:\\"content-header\\",id:\\"introductory-concepts\\",children:[(0,s.jsx)(e.a,{href:\\"#introductory-concepts\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e.span,{className:\\"content-header-link\\",children:(0,s.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,s.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,s.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Introductory concepts\\"]}),(0,s.jsxs)(e.p,{children:[\\"Gaussian processes are built upon the mathematical framework of the multivariate Gaussian distribution, which extends the familiar Gaussian (or normal) distribution to multiple random variables that are jointly normally distributed. This distribution is characterized by two key components: a mean vector, \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\mu\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"})]})})]})}),\\", and a covariance matrix, \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mtext,{children:\\"Cov\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"j\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma = \\\\\\\\text{Cov}(X_i, X_j)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0361em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsx)(e.span,{className:\\"mord text\\",children:(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"Cov\\"})}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]})}),\\", which describes the relationships between pairs of variables. Before diving into these concepts, we will first cover some fundamental terms from probability theory to ensure we have a shared understanding.\\"]}),(0,s.jsx)(e.p,{children:\\"Generally, a multivariate Gaussian distribution is expressed as:\\"}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"[\\"}),(0,s.jsxs)(e.mtable,{columnalign:\\"center\\",columnspacing:\\"1em\\",rowspacing:\\"0.16em\\",children:[(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})})})}),(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]})})})}),(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.mi,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u22EE\\"}),(0,s.jsx)(e.mpadded,{height:\\"0em\\",voffset:\\"0em\\",children:(0,s.jsx)(e.mspace,{width:\\"0em\\",height:\\"1.5em\\",mathbackground:\\"black\\"})})]})})})}),(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"n\\"})]})})})})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"]\\"})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X = \\\\\\\\begin{bmatrix} X_1 \\\\\\\\\\\\\\\\ X_2 \\\\\\\\\\\\\\\\ \\\\\\\\vdots \\\\\\\\\\\\\\\\ X_n \\\\\\\\end{bmatrix} \\\\\\\\sim \\\\\\\\mathcal{N}(\\\\\\\\mu, \\\\\\\\Sigma)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"5.46em\\",verticalAlign:\\"-2.48em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen\\",children:(0,s.jsx)(e.span,{className:\\"delimsizing mult\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"2.95em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-4.95em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"7.4em\\"}}),(0,s.jsx)(e.span,{style:{width:\\".667em\\",height:\\"5.4em\\"},children:(0,s.jsx)(e.svg,{viewBox:\\"0 0 667 5400\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"5.400em\\",width:\\"0.667em\\",children:(0,s.jsx)(e.path,{d:`M403 1759 V84 H666 V0 H319 V1759 v1800 v1759 h347 v-84\\nH403z M403 1759 V0 H319 V1759 v1800 v1759 h84z`})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"2.45em\\"},children:(0,s.jsx)(e.span,{})})})]})})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsx)(e.span,{className:\\"mtable\\",children:(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"2.98em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-5.8275em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.6875em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-4.6275em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.6875em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.7675em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.6875em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u22EE\\"}),(0,s.jsx)(e.span,{className:\\"mord rule\\",style:{borderRightWidth:\\"0\\",borderTopWidth:\\"1.5em\\",bottom:\\"0\\"}})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-1.5675em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.6875em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".1514em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"n\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"2.48em\\"},children:(0,s.jsx)(e.span,{})})})]})})})}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:(0,s.jsx)(e.span,{className:\\"delimsizing mult\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"2.95em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-4.95em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"7.4em\\"}}),(0,s.jsx)(e.span,{style:{width:\\".667em\\",height:\\"5.4em\\"},children:(0,s.jsx)(e.svg,{viewBox:\\"0 0 667 5400\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"5.400em\\",width:\\"0.667em\\",children:(0,s.jsx)(e.path,{d:`M347 1759 V0 H0 V84 H263 V1759 v1800 v1759 H0 v84 H347z\\nM347 1759 V0 H263 V1759 v1800 v1759 h84z`})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"2.45em\\"},children:(0,s.jsx)(e.span,{})})})]})})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"where \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\" is a vector of random variables.\\"]}),(0,s.jsxs)(e.p,{children:[\\"The covariance matrix \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"})]})})]})}),\\" determines the shape of the distribution and, in the 2D case, can be represented as:\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"[\\"}),(0,s.jsxs)(e.mtable,{columnalign:\\"center center\\",columnspacing:\\"1em\\",rowspacing:\\"0.16em\\",children:[(0,s.jsxs)(e.mtr,{children:[(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]})})}),(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]})]})})})]}),(0,s.jsxs)(e.mtr,{children:[(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]})})}),(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]})})})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"]\\"})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma = \\\\\\\\begin{bmatrix} \\\\\\\\sigma_1^2 & \\\\\\\\sigma_1 \\\\\\\\sigma_2 \\\\\\\\\\\\\\\\ \\\\\\\\sigma_2 \\\\\\\\sigma_1 & \\\\\\\\sigma_2^2 \\\\\\\\end{bmatrix}\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4em\\",verticalAlign:\\"-.95em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"[\\"})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mtable\\",children:[(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8141em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4519em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2481em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})}),(0,s.jsx)(e.span,{className:\\"arraycolsep\\",style:{width:\\".5em\\"}}),(0,s.jsx)(e.span,{className:\\"arraycolsep\\",style:{width:\\".5em\\"}}),(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8141em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4519em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2481em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"]\\"})})]})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"Contour plots of the multivariate Gaussian distribution illustrate how \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"})]})})]}),\\" affects the spread and orientation of the distribution. An example of such plots for different covariance matrices \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"})]})})]}),\\" is shown in the \\",(0,s.jsx)(e.a,{href:\\"#multivariate\\",children:\\"figure\\"}),\\" below, demonstrating how the covariance influences the relationships between variables.\\"]}),(0,s.jsx)(\\"img\\",{id:\\"multivariate\\",src:\\"/static/images/blog/gaussian-process/multivariate.png\\",alt:\\"Description of the image\\",style:{width:\\"80%\\",height:\\"auto\\",\\"padding-left\\":\\"10%\\"}}),(0,s.jsxs)(e.h2,{className:\\"content-header\\",id:\\"conditioning\\",children:[(0,s.jsx)(e.a,{href:\\"#conditioning\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e.span,{className:\\"content-header-link\\",children:(0,s.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,s.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,s.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Conditioning\\"]}),(0,s.jsxs)(e.p,{children:[\\"Suppose a joint dristribution of two vectors of gaussian random variables \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\" and \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"[\\"}),(0,s.jsxs)(e.mtable,{columnalign:\\"center\\",columnspacing:\\"1em\\",rowspacing:\\"0.16em\\",children:[(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsx)(e.mi,{children:\\"X\\"})})})}),(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsx)(e.mi,{children:\\"Y\\"})})})})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"]\\"})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"[\\"}),(0,s.jsxs)(e.mtable,{columnalign:\\"center\\",columnspacing:\\"1em\\",rowspacing:\\"0.16em\\",children:[(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})})})}),(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})})})})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"]\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"[\\"}),(0,s.jsxs)(e.mtable,{columnalign:\\"center center\\",columnspacing:\\"1em\\",rowspacing:\\"0.16em\\",children:[(0,s.jsxs)(e.mtr,{children:[(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})})}),(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})})})]}),(0,s.jsxs)(e.mtr,{children:[(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})})}),(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})})})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"]\\"})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\".\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X,Y} = \\\\\\\\begin{bmatrix} X \\\\\\\\\\\\\\\\ Y \\\\\\\\end{bmatrix} \\\\\\\\sim \\\\\\\\mathcal{N}(\\\\\\\\mu, \\\\\\\\Sigma) = \\\\\\\\mathcal{N}\\\\\\\\left( \\\\\\\\begin{bmatrix} \\\\\\\\mu_X \\\\\\\\\\\\\\\\ \\\\\\\\mu_Y \\\\\\\\end{bmatrix}, \\\\\\\\begin{bmatrix} \\\\\\\\Sigma_{XX} & \\\\\\\\Sigma_{XY} \\\\\\\\\\\\\\\\ \\\\\\\\Sigma_{YX} & \\\\\\\\Sigma_{YY} \\\\\\\\end{bmatrix} \\\\\\\\right).\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".9694em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4em\\",verticalAlign:\\"-.95em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"[\\"})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsx)(e.span,{className:\\"mtable\\",children:(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})})})}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"]\\"})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4em\\",verticalAlign:\\"-.95em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"(\\"})}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"[\\"})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsx)(e.span,{className:\\"mtable\\",children:(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})})})}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"]\\"})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"[\\"})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mtable\\",children:[(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})}),(0,s.jsx)(e.span,{className:\\"arraycolsep\\",style:{width:\\".5em\\"}}),(0,s.jsx)(e.span,{className:\\"arraycolsep\\",style:{width:\\".5em\\"}}),(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"]\\"})})]}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\")\\"})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\".\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"The covariance matrices, such as \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma_{XX}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\", are themselves matrices, ensuring that the final covariance matrix has a size of \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mo,{children:\\"+\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"|X| + |Y|\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"+\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"})]})]})]})}),\\". We can derive the conditional multivariate distributions using the following expressions:\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{children:\\"+\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X \\\\\\\\mid Y} \\\\\\\\sim \\\\\\\\mathcal{N}\\\\\\\\left( \\\\\\\\mu_X + \\\\\\\\Sigma_{XY} \\\\\\\\Sigma_{YY}^{-1} (Y - \\\\\\\\mu_Y), \\\\\\\\Sigma_{XX} - \\\\\\\\Sigma_{XY} \\\\\\\\Sigma_{YY}^{-1} \\\\\\\\Sigma_{YX} \\\\\\\\right)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mtight mrel\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.2141em\\",verticalAlign:\\"-.35em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size1\\",children:\\"(\\"})}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"+\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size1\\",children:\\")\\"})})]})]})]})]})}),(0,s.jsx)(e.p,{children:\\"or\\"}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.mo,{children:\\"+\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\".\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\" P_{Y \\\\\\\\mid X} \\\\\\\\sim \\\\\\\\mathcal{N}\\\\\\\\left( \\\\\\\\mu_Y + \\\\\\\\Sigma_{YX} \\\\\\\\Sigma_{XX}^{-1} (X - \\\\\\\\mu_X), \\\\\\\\Sigma_{YY} - \\\\\\\\Sigma_{YX} \\\\\\\\Sigma_{XX}^{-1} \\\\\\\\Sigma_{XY} \\\\\\\\right).\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mtight mrel\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.2141em\\",verticalAlign:\\"-.35em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size1\\",children:\\"(\\"})}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"+\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size1\\",children:\\")\\"})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\".\\"})]})]})]})}),(0,s.jsxs)(e.h2,{className:\\"content-header\\",id:\\"marginalization\\",children:[(0,s.jsx)(e.a,{href:\\"#marginalization\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e.span,{className:\\"content-header-link\\",children:(0,s.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,s.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,s.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Marginalization\\"]}),(0,s.jsxs)(e.p,{children:[\\"Another important concept is \\",(0,s.jsx)(e.strong,{children:\\"marginalization\\"}),\\". Marginalization over a random variable in a joint distribution involves summing (or integrating) over all possible values of the other variable in the conditional distribution.\\"]}),(0,s.jsx)(e.p,{children:\\"For example, given two vectors of Gaussian random variables:\\"}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mspace,{linebreak:\\"newline\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X \\\\\\\\sim \\\\\\\\mathcal{N}(\\\\\\\\mu_X, \\\\\\\\Sigma_{XX})\\\\\\\\\\\\\\\\ Y \\\\\\\\sim \\\\\\\\mathcal{N}(\\\\\\\\mu_Y, \\\\\\\\Sigma_{YY})\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]}),(0,s.jsx)(e.span,{className:\\"mspace newline\\"}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"and their joint distribution \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X,Y} \\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".9694em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\", we can marginalize over \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]}),\\" as follows:\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"p\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u222B\\"}),(0,s.jsx)(e.mi,{children:\\"y\\"})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"p\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{children:\\"y\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mtext,{children:\\"\\\\u2009\\"}),(0,s.jsx)(e.mi,{children:\\"d\\"}),(0,s.jsx)(e.mi,{children:\\"y\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u222B\\"}),(0,s.jsx)(e.mi,{children:\\"y\\"})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"p\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"y\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"p\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"y\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mtext,{children:\\"\\\\u2009\\"}),(0,s.jsx)(e.mi,{children:\\"d\\"}),(0,s.jsx)(e.mi,{children:\\"y\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"p_X(x) = \\\\\\\\int_y p_{X,Y}(x, y) \\\\\\\\, dy = \\\\\\\\int_y p_{X \\\\\\\\mid Y}(x \\\\\\\\mid y) p_Y(y) \\\\\\\\, dy\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4081em\\",verticalAlign:\\"-1.0481em\\"}}),(0,s.jsxs)(e.span,{className:\\"mop\\",children:[(0,s.jsx)(e.span,{className:\\"mop large-op op-symbol\\",style:{marginRight:\\".44445em\\",position:\\"relative\\",top:\\"-.0011em\\"},children:\\"\\\\u222B\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"-.6106em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-1.7881em\\",marginLeft:\\"-.4445em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"1.0481em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4081em\\",verticalAlign:\\"-1.0481em\\"}}),(0,s.jsxs)(e.span,{className:\\"mop\\",children:[(0,s.jsx)(e.span,{className:\\"mop large-op op-symbol\\",style:{marginRight:\\".44445em\\",position:\\"relative\\",top:\\"-.0011em\\"},children:\\"\\\\u222B\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"-.6106em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-1.7881em\\",marginLeft:\\"-.4445em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"1.0481em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mtight mrel\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"We can observe the differences between \\",(0,s.jsx)(e.strong,{children:\\"conditioning\\"}),\\" and \\",(0,s.jsx)(e.strong,{children:\\"marginalization\\"}),\\" in the \\",(0,s.jsx)(e.a,{href:\\"#cond\\",children:\\"figure\\"}),\\" below.\\"]}),(0,s.jsx)(\\"img\\",{id:\\"cond\\",src:\\"/static/images/blog/gaussian-process/cond.png\\",alt:\\"Description of the image\\",style:{width:\\"80%\\",height:\\"auto\\",\\"padding-left\\":\\"10%\\"}}),(0,s.jsxs)(e.p,{children:[\\"As shown, \\",(0,s.jsx)(e.strong,{children:\\"conditioning\\"}),\\" involves slicing through the distribution at a specific value, resulting in a distribution with one less dimension. In this case, it becomes a 1D distribution, which is a simple normal distribution. \\",(0,s.jsx)(e.strong,{children:\\"Marginalization\\"}),\\" on the other hand acts like projecting the whole 2D distribution into one dimension, in this case \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]}),\\".\\"]}),(0,s.jsxs)(e.h2,{className:\\"content-header\\",id:\\"gaussian-processes\\",children:[(0,s.jsx)(e.a,{href:\\"#gaussian-processes\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e.span,{className:\\"content-header-link\\",children:(0,s.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,s.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,s.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Gaussian processes\\"]}),(0,s.jsxs)(e.p,{children:[\\"Now that we have covered the basic concepts, we can discuss how to use them to formulate the ideas behind Gaussian processes and Gaussian process regression. The basic idea is as follows: given a set of sample positions \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"{\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"}\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"}),(0,s.jsx)(e.mi,{children:\\"n\\"})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\{x_i\\\\\\\\}_1^n\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"{\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mclose\\",children:[(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\"}\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".6644em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4519em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"n\\"})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2481em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" of a function \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"f\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\" f\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8889em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10764em\\"},children:\\"f\\"})]})})]}),\\", we aim to determine \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mi,{children:\\"f\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X_i = f(x_i)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10764em\\"},children:\\"f\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]})}),\\", where \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X_i\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" is the i-th entry of a random vector \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\". This vector follows a multivariate normal distribution, meaning:\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\".\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X \\\\\\\\sim \\\\\\\\mathcal{N}(\\\\\\\\mu_X, \\\\\\\\Sigma_{XX}).\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\".\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"For simplicity, we often assume \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mn,{children:\\"0\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\mu_X = 0\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"0\\"})]})]})]})}),\\". However, calculating \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma_{XX}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" involves another mathematical concept called a \\",(0,s.jsx)(e.strong,{children:\\"kernel function\\"}),\\".\\"]}),(0,s.jsxs)(e.p,{children:[\\"The \\",(0,s.jsx)(e.strong,{children:\\"kernel\\"}),\\" function \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"k\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"k\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})]})})]})}),\\", defined as \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"k\\"}),(0,s.jsx)(e.mspace,{}),(0,s.jsx)(e.mspace,{width:\\"0.1111em\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0.17em\\"}),(0,s.jsx)(e.mtext,{children:\\"\\\\u2009\\\\u2063\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0em\\",children:\\":\\"}),(0,s.jsx)(e.mspace,{width:\\"0.3333em\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"double-struck\\",children:\\"R\\"}),(0,s.jsx)(e.mi,{children:\\"n\\"})]}),(0,s.jsx)(e.mo,{children:\\"\\\\xD7\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"double-struck\\",children:\\"R\\"}),(0,s.jsx)(e.mi,{children:\\"n\\"})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u2192\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"double-struck\\",children:\\"R\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"k \\\\\\\\colon \\\\\\\\mathbb{R}^n \\\\\\\\times \\\\\\\\mathbb{R}^n \\\\\\\\to \\\\\\\\mathbb{R}\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".7778em\\",verticalAlign:\\"-.0833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"}),(0,s.jsx)(e.span,{className:\\"mspace nobreak\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1111em\\"}}),(0,s.jsx)(e.span,{className:\\"mpunct\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\"-.1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\":\\"})}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".3333em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathbb\\",children:\\"R\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".6644em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"n\\"})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\xD7\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6889em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathbb\\",children:\\"R\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".6644em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"n\\"})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u2192\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6889em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathbb\\",children:\\"R\\"})]})]})]})}),\\", is a measure of similarity between its inputs. A high output value for \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"k\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"k\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})]})})]})}),\\" indicates high similarity between inputs, and vice versa.\\"]}),(0,s.jsxs)(e.p,{children:[\\"In our case, the kernel function is used to compute the covariance matrix \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma_{XX}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" of the multivariate normal distribution. To calculate each entry of \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mtext,{children:\\"Cov\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{Cov}(X, X)\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord text\\",children:(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"Cov\\"})}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})})]})}),\\", we assume:\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mtext,{children:\\"Cov\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"j\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mi,{children:\\"k\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"j\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{Cov}(X_i, X_j) = k(x_i, x_j),\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0361em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsx)(e.span,{className:\\"mord text\\",children:(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"Cov\\"})}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0361em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"meaning that the covariance between two function values \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X_i\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" and \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"j\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X_j\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".9694em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" is high when their corresponding inputs \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"x_i\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".5806em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" and \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"j\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"x_j\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".7167em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" are close together.\\"]}),(0,s.jsxs)(e.h3,{className:\\"content-header\\",id:\\"common-kernel-functions\\",children:[(0,s.jsx)(e.a,{href:\\"#common-kernel-functions\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e.span,{className:\\"content-header-link\\",children:(0,s.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,s.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,s.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Common Kernel Functions\\"]}),(0,s.jsxs)(e.p,{children:[\\"Below are some commonly used kernel functions in the context of Gaussian processes, some of them take hyperparameters like \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"l\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"l\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"})]})})]}),\\" or \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\sigma\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".4306em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"})]})})]}),\\":\\"]}),(0,s.jsx)(e.ol,{children:(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:\\"RBF Kernel:\\"})})}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"k\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0em\\",mathvariant:\\"normal\\",children:\\"\\\\u2032\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]}),(0,s.jsx)(e.mi,{children:\\"exp\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2061\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.mfrac,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2225\\"}),(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0em\\",mathvariant:\\"normal\\",children:\\"\\\\u2032\\"})]}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2225\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mn,{children:\\"2\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"l\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"k(t, t\') = \\\\\\\\sigma^2 \\\\\\\\exp\\\\\\\\left(-\\\\\\\\frac{\\\\\\\\|t - t\'\\\\\\\\|^2}{2l^2}\\\\\\\\right)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0519em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8019em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2032\\"})})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4411em\\",verticalAlign:\\"-.95em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mop\\",children:\\"exp\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"(\\"})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mopen nulldelimiter\\"}),(0,s.jsx)(e.span,{className:\\"mfrac\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.4911em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.314em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"2\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".7401em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.989em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})})})})})]})]})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.23em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.677em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2225\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".7519em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2032\\"})})})]})})})})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2225\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8141em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})})})})})]})]})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".686em\\"},children:(0,s.jsx)(e.span,{})})})]})}),(0,s.jsx)(e.span,{className:\\"mclose nulldelimiter\\"})]}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\")\\"})})]})]})]})]})}),(0,s.jsx)(e.ol,{start:\\"2\\",children:(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:\\"Periodic Kernel:\\"})})}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"k\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0em\\",mathvariant:\\"normal\\",children:\\"\\\\u2032\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]}),(0,s.jsx)(e.mi,{children:\\"exp\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2061\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.mfrac,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mn,{children:\\"2\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"sin\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2061\\"})]}),(0,s.jsx)(e.mn,{children:\\"2\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"\\\\u03C0\\"}),(0,s.jsxs)(e.mfrac,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0em\\",mathvariant:\\"normal\\",children:\\"\\\\u2032\\"})]}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"})]}),(0,s.jsx)(e.mi,{children:\\"p\\"})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]})]}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"l\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"k(t, t\') = \\\\\\\\sigma^2 \\\\\\\\exp\\\\\\\\left(-\\\\\\\\frac{2 \\\\\\\\sin^2\\\\\\\\left(\\\\\\\\pi \\\\\\\\frac{|t - t\'|}{p}\\\\\\\\right)}{l^2}\\\\\\\\right)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0519em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8019em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2032\\"})})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"3.74em\\",verticalAlign:\\"-1.55em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mop\\",children:\\"exp\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen\\",children:(0,s.jsx)(e.span,{className:\\"delimsizing mult\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"2.05em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-4.05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"5.6em\\"}}),(0,s.jsx)(e.span,{style:{width:\\".875em\\",height:\\"3.6em\\"},children:(0,s.jsx)(e.svg,{viewBox:\\"0 0 875 3600\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"3.600em\\",width:\\"0.875em\\",children:(0,s.jsx)(e.path,{d:`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1\\nc-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,\\n-36,557 l0,84c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,\\n949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9\\nc0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,\\n-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189\\nl0,-92c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,\\n-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"1.55em\\"},children:(0,s.jsx)(e.span,{})})})]})})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mopen nulldelimiter\\"}),(0,s.jsx)(e.span,{className:\\"mfrac\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"2.19em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.464em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.15em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".7401em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.989em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})})})})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.38em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.15em\\"}}),(0,s.jsx)(e.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,s.jsxs)(e.span,{style:{top:\\"-4.19em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"2\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mop\\",children:[(0,s.jsx)(e.span,{className:\\"mop\\",children:\\"sin\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8719em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.1208em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size2\\",children:\\"(\\"})}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C0\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mopen nulldelimiter\\"}),(0,s.jsx)(e.span,{className:\\"mfrac\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.0645em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.655em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"p\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.23em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.485em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"mtight mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8278em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.931em\\",marginRight:\\".0714em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight sizing size1 reset-size3\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2032\\"})})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".4811em\\"},children:(0,s.jsx)(e.span,{})})})]})}),(0,s.jsx)(e.span,{className:\\"mclose nulldelimiter\\"})]}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size2\\",children:\\")\\"})})]})]})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".686em\\"},children:(0,s.jsx)(e.span,{})})})]})}),(0,s.jsx)(e.span,{className:\\"mclose nulldelimiter\\"})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:(0,s.jsx)(e.span,{className:\\"delimsizing mult\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"2.05em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-4.05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"5.6em\\"}}),(0,s.jsx)(e.span,{style:{width:\\".875em\\",height:\\"3.6em\\"},children:(0,s.jsx)(e.svg,{viewBox:\\"0 0 875 3600\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"3.600em\\",width:\\"0.875em\\",children:(0,s.jsx)(e.path,{d:`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,\\n63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5\\nc11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,9\\nc-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664\\nc-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11\\nc0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17\\nc242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558\\nl0,-144c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,\\n-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"1.55em\\"},children:(0,s.jsx)(e.span,{})})})]})})})]})]})]})]})}),(0,s.jsx)(e.ol,{start:\\"3\\",children:(0,s.jsx)(e.li,{children:(0,s.jsx)(e.strong,{children:\\"Linear Kernel:\\"})})}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"k\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0em\\",mathvariant:\\"normal\\",children:\\"\\\\u2032\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mi,{children:\\"b\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]}),(0,s.jsx)(e.mo,{children:\\"+\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mn,{children:\\"2\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mi,{children:\\"c\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msup,{children:[(0,s.jsx)(e.mi,{children:\\"t\\"}),(0,s.jsx)(e.mo,{lspace:\\"0em\\",rspace:\\"0em\\",mathvariant:\\"normal\\",children:\\"\\\\u2032\\"})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mi,{children:\\"c\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"k(t, t\') = \\\\\\\\sigma_b^2 + \\\\\\\\sigma^2 (t - c)(t\' - c)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0519em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8019em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2032\\"})})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.1111em\\",verticalAlign:\\"-.247em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.453em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"b\\"})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".247em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"+\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.1141em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0519em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"c\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsx)(e.span,{className:\\"vlist-t\\",children:(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8019em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2032\\"})})})]})})})})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"c\\"}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]})}),(0,s.jsx)(e.p,{children:\\"Different values for hyperparameters make the similarity measure of the kernels more or less strict, leading to sharper or smoother functions in the process.\\"}),(0,s.jsxs)(e.p,{children:[\\"Now that we have a method to compute the covariance matrix \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma_{XX}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\", we can sample a random function \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"f\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"f\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8889em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10764em\\"},children:\\"f\\"})]})})]}),\\" by drawing a sample \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\" from the multivariate normal distribution \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\mathcal{N}(\\\\\\\\mu_X, \\\\\\\\Sigma_{XX})\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})})]})}),\\". Each entry \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X_i\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" in the sampled vector corresponds to the value of \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"f\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"f\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8889em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10764em\\"},children:\\"f\\"})]})})]}),\\" at \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"x_i\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".5806em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\", meaning \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mi,{children:\\"f\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\".\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X_i = f(x_i).\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0785em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10764em\\"},children:\\"f\\"}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\".\\"})]})]})]})]}),(0,s.jsxs)(e.h2,{className:\\"content-header\\",id:\\"gaussian-processes-for-regression\\",children:[(0,s.jsx)(e.a,{href:\\"#gaussian-processes-for-regression\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,s.jsx)(s.Fragment,{children:(0,s.jsx)(e.span,{className:\\"content-header-link\\",children:(0,s.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,s.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,s.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Gaussian Processes for Regression\\"]}),(0,s.jsx)(e.p,{children:\\"We have now covered the fundamentals of Gaussian processes. Next, we will extend our understanding to explore how Gaussian processes can be applied to solve regression tasks.\\"}),(0,s.jsx)(\\"img\\",{id:\\"regression\\",src:\\"/static/images/blog/gaussian-process/regression.png\\",alt:\\"Description of the image\\",style:{width:\\"80%\\",height:\\"auto\\",\\"padding-left\\":\\"10%\\"}}),(0,s.jsxs)(e.p,{children:[\\"Before diving into the technical details, our objective is clear: to model a distribution of functions that pass through our training points (\\",(0,s.jsx)(e.a,{href:\\"#regression\\",children:\\"as shown in the image above\\"}),\\") and are therefore able to explain the distribution of our data.\\"]}),(0,s.jsxs)(e.p,{children:[\\"Now, let \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\" represent our test points and \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]}),\\" our training points. We aim to model the posterior distribution \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X \\\\\\\\mid Y\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})]})]}),\\", which answers the question:\\"]}),(0,s.jsx)(e.p,{children:(0,s.jsxs)(e.em,{children:[\'\\"What possible values for \',(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\" are there, given the training points in \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]}),\'?\\"\']})}),(0,s.jsxs)(e.p,{children:[\\"This is where \\",(0,s.jsx)(e.strong,{children:\\"conditioning\\"}),\\" comes into play. Computing the distribution \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X|Y}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" provides us with functions \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"f\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"f\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8889em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10764em\\"},children:\\"f\\"})]})})]}),\\" that pass precisely through the points in \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]}),\\". Conceptually, we can think of this as slicing through a \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mo,{children:\\"+\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"|X| + |Y|\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"+\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"})]})]})]}),\\"-dimensional normal distribution, fixing the values at \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"|Y|\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"})]})})]}),\\" locations as constants. This results in a \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"|X|\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2223\\"})]})})]}),\\"-dimensional normal distribution.\\"]}),(0,s.jsxs)(e.p,{children:[\\"As we know it is easy to calculate distribution for \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X, Y}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".9694em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" with\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"[\\"}),(0,s.jsxs)(e.mtable,{columnalign:\\"center\\",columnspacing:\\"1em\\",rowspacing:\\"0.16em\\",children:[(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})})})}),(0,s.jsx)(e.mtr,{children:(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})})})})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"]\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"[\\"}),(0,s.jsxs)(e.mtable,{columnalign:\\"center center\\",columnspacing:\\"1em\\",rowspacing:\\"0.16em\\",children:[(0,s.jsxs)(e.mtr,{children:[(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})})}),(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})})})]}),(0,s.jsxs)(e.mtr,{children:[(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})})}),(0,s.jsx)(e.mtd,{children:(0,s.jsx)(e.mstyle,{displaystyle:\\"false\\",scriptlevel:\\"0\\",children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})})})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"]\\"})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\".\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X,Y} \\\\\\\\sim \\\\\\\\mathcal{N}\\\\\\\\left( \\\\\\\\begin{bmatrix} \\\\\\\\mu_X \\\\\\\\\\\\\\\\ \\\\\\\\mu_Y \\\\\\\\end{bmatrix}, \\\\\\\\begin{bmatrix} \\\\\\\\Sigma_{XX} & \\\\\\\\Sigma_{XY} \\\\\\\\\\\\\\\\ \\\\\\\\Sigma_{YX} & \\\\\\\\Sigma_{YY} \\\\\\\\end{bmatrix} \\\\\\\\right).\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".9694em\\",verticalAlign:\\"-.2861em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4em\\",verticalAlign:\\"-.95em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"(\\"})}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"[\\"})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsx)(e.span,{className:\\"mtable\\",children:(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})})})}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"]\\"})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"[\\"})}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mtable\\",children:[(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})}),(0,s.jsx)(e.span,{className:\\"arraycolsep\\",style:{width:\\".5em\\"}}),(0,s.jsx)(e.span,{className:\\"arraycolsep\\",style:{width:\\".5em\\"}}),(0,s.jsx)(e.span,{className:\\"col-align-c\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.45em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-3.61em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-2.41em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".95em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\"]\\"})})]}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"size3 delimsizing\\",children:\\")\\"})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\".\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"From our prerequisites, we know that \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X|Y}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" can be calculated as:\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u223C\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"script\\",children:\\"N\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\"(\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{children:\\"+\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{fence:\\"true\\",children:\\")\\"})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X|Y} \\\\\\\\sim \\\\\\\\mathcal{N}\\\\\\\\left( \\\\\\\\mu_X + \\\\\\\\Sigma_{XY} \\\\\\\\Sigma_{YY}^{-1} (Y - \\\\\\\\mu_Y), \\\\\\\\Sigma_{XX} - \\\\\\\\Sigma_{XY} \\\\\\\\Sigma_{YY}^{-1} \\\\\\\\Sigma_{YX} \\\\\\\\right)\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"\\\\u223C\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.2141em\\",verticalAlign:\\"-.35em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathcal\\",style:{marginRight:\\".14736em\\"},children:\\"N\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"minner\\",children:[(0,s.jsx)(e.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size1\\",children:\\"(\\"})}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"+\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,s.jsx)(e.span,{className:\\"delimsizing size1\\",children:\\")\\"})})]})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"This is the final distribution from which we can sample. It provides functions that pass through all points in \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]}),\\" and whose behavior for \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\" is modeled by \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X|Y}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" (see image above). The \\",(0,s.jsx)(e.a,{href:\\"#regression\\",children:\\"figure\\"}),\\" also illustrates the \\",(0,s.jsx)(e.strong,{children:\\"95% confidence interval\\"}),\\" (\\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mn,{children:\\"2\\"}),(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"2\\\\\\\\sigma\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"2\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"})]})})]}),\\") and the mean function. In practice, the mean function is often the most useful for regression or prediction tasks, as it provides the expected value of the output based on the given data. Getting the mean function as well as the \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mn,{children:\\"2\\"}),(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"2\\\\\\\\sigma\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"2\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"})]})})]}),\\" confidence interval is really easy once we obtained the \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\mu\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"})]})})]}),\\" and \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"})]})})]}),\\" for \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X|Y}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\". We can just query them at the i-th point and get the respective \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\mu_i\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" and \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"i\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma_{ii} = \\\\\\\\sigma_i\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"ii\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".5806em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})]})]}),\\". This wil result in\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"[\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"]\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"[\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{children:\\"+\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"]\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"[\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"]\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"[\\\\\\\\mu_{X|Y}]_i = [\\\\\\\\mu_X + \\\\\\\\Sigma_{XY} \\\\\\\\Sigma_{YY}^{-1} (Y - \\\\\\\\mu_Y)]_i = [\\\\\\\\Sigma_{XY} \\\\\\\\Sigma_{YY}^{-1} Y]_i,\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.1052em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"[\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mclose\\",children:[(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\"]\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"[\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"+\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.1478em\\",verticalAlign:\\"-.2837em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,s.jsxs)(e.span,{className:\\"mclose\\",children:[(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\"]\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.1478em\\",verticalAlign:\\"-.2837em\\"}}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"[\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsxs)(e.span,{className:\\"mclose\\",children:[(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\"]\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"where the second equality stems from the fact that we assume \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mn,{children:\\"0\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\mu_{X} = 0\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"0\\"})]})]})]}),\\" and \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mn,{children:\\"0\\"})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\mu_{Y}=0\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"\\\\u03BC\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"0\\"})]})]})]}),\\". For the standart deviation we get\\"]}),(0,s.jsx)(e.span,{className:\\"katex-display\\",children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsxs)(e.mrow,{children:[(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]}),(0,s.jsx)(e.mo,{children:\\"=\\"}),(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"[\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]}),(0,s.jsxs)(e.msubsup,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,s.jsx)(e.mn,{children:\\"1\\"})]})]}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"Y\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\".\\"}),(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mo,{stretchy:\\"false\\",children:\\"]\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"i\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})]})]}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\sigma_i = [\\\\\\\\Sigma_{XX} - \\\\\\\\Sigma_{XY} \\\\\\\\Sigma_{YY}^{-1} \\\\\\\\Sigma_{YX}. ]_{ii}\\"})]})})}),(0,s.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".5806em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,s.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,s.jsx)(e.span,{className:\\"mopen\\",children:\\"[\\"}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,s.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.1478em\\",verticalAlign:\\"-.2837em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8641em\\"},children:[(0,s.jsxs)(e.span,{style:{top:\\"-2.4163em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"YY\\"})})})]}),(0,s.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]})]}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2837em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]}),(0,s.jsx)(e.span,{className:\\"mord\\",children:\\".\\"}),(0,s.jsxs)(e.span,{className:\\"mclose\\",children:[(0,s.jsx)(e.span,{className:\\"mclose\\",children:\\"]\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"ii\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})]})]})}),(0,s.jsxs)(e.p,{children:[\\"Doing this for every point \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"x\\"}),(0,s.jsx)(e.mi,{children:\\"i\\"})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"x_i\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".5806em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]}),\\" will result in the same \\",(0,s.jsx)(e.a,{href:\\"#regression\\",children:\\"figure\\"}),\\" we saw above.\\"]}),(0,s.jsxs)(e.p,{children:[\\"So in summary, gaussian processes are a flexible framework for regression, where functions are modeled as samples from a multivariate normal distribution. A kernel function is used to compute the covariance matrix \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u03A3\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{children:\\"X\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\Sigma_{XX}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u03A3\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"XX\\"})})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\", which encodes the similarity between inputs. The posterior distribution \\",(0,s.jsx)(e.strong,{children:(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsxs)(e.msub,{children:[(0,s.jsx)(e.mi,{children:\\"P\\"}),(0,s.jsxs)(e.mrow,{children:[(0,s.jsx)(e.mi,{children:\\"X\\"}),(0,s.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.mi,{children:\\"Y\\"})]})]})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"P_{X|Y}\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,s.jsxs)(e.span,{className:\\"mord\\",children:[(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,s.jsx)(e.span,{className:\\"msupsub\\",children:(0,s.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,s.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,s.jsxs)(e.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,s.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,s.jsx)(e.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,s.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2223\\"}),(0,s.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]})}),(0,s.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,s.jsx)(e.span,{className:\\"vlist-r\\",children:(0,s.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,s.jsx)(e.span,{})})})]})})]})]})})]})}),\\" then allows us to generate functions that pass through the training points \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"Y\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"Y\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"Y\\"})]})})]}),\\" while predicting the behavior for test points \\",(0,s.jsxs)(e.span,{className:\\"katex\\",children:[(0,s.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,s.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,s.jsxs)(e.semantics,{children:[(0,s.jsx)(e.mrow,{children:(0,s.jsx)(e.mi,{children:\\"X\\"})}),(0,s.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,s.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,s.jsxs)(e.span,{className:\\"base\\",children:[(0,s.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,s.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\". In the end, we use the mean function provided by this posterior because it represents the most likely prediction for the underlying function.\\"]})]})}function d(a={}){let{wrapper:e}=a.components||{};return e?(0,s.jsx)(e,{...a,children:(0,s.jsx)(h,{...a})}):h(a)}return x(R);})();\\n;return Component;"},"_id":"blog/gaussian-processes.mdx","_raw":{"sourceFilePath":"blog/gaussian-processes.mdx","sourceFileName":"gaussian-processes.mdx","sourceFileDir":"blog","contentType":"mdx","flattenedPath":"blog/gaussian-processes"},"type":"Blog","readingTime":{"text":"8 min read","minutes":7.375,"time":442500,"words":1475},"slug":"gaussian-processes","path":"blog/gaussian-processes","filePath":"blog/gaussian-processes.mdx","toc":[{"value":"Introductory concepts","url":"#introductory-concepts","depth":2},{"value":"Conditioning","url":"#conditioning","depth":2},{"value":"Marginalization","url":"#marginalization","depth":2},{"value":"Gaussian processes","url":"#gaussian-processes","depth":2},{"value":"Common Kernel Functions","url":"#common-kernel-functions","depth":3},{"value":"Gaussian Processes for Regression","url":"#gaussian-processes-for-regression","depth":2}],"structuredData":{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introduction to Gaussian Process Regression","datePublished":"2024-03-08T00:00:00.000Z","dateModified":"2024-03-08T00:00:00.000Z","description":"A short introduction to gaussian processes and how one can employ them for regression tasks.","image":"/static/images/twitter-card.png","url":"https://janhardtke.com/blog/gaussian-processes"}},{"title":"Introduction to Transformers - Part 00 - Architecture","date":"2024-08-21T00:00:00.000Z","tags":["transformer","nlp","theory"],"draft":false,"summary":"A short introduction to the architecture behind transformers how they can be utilized in NLP tasks.","body":{"raw":"\\nTransformers have revolutionized the field of natural language processing (NLP), becoming the foundation for state-of-the-art models like BERT, GPT, and T5. Introduced in the seminal paper <a href=\\"https://arxiv.org/abs/1706.03762\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">Attention Is All You Need</a>, transformers replaced recurrent and convolutional architectures by leveraging a novel mechanism called **self-attention**.\\n\\nAt their core, transformers process entire input sequences simultaneously, allowing them to capture global relationships within the data efficiently. This architecture not only improves performance on complex NLP tasks like machine translation and text summarization but also scales effectively to massive datasets and models.\\n\\nIn this series, we will explore the key components of the transformer architecture, starting with its foundational building blocks and how they enable efficient learning from sequential data.\\n\\n## Architecture Overview\\n\\nBefore explaining every bit of the transformer model in detail, we will take a quick step back and give a small Overview\\nof the steps we will cover. The below [image](#transformer) describes the whole model very accuarctly.\\n\\n<figure style={{ width: \'40%\', margin: \'auto\', paddingLeft: \'0%\' }}>\\n  <img\\n    id=\\"transformer\\"\\n    src=\\"/static/images/blog/transformers00/transformer.png\\"\\n    alt=\\"Description of the image\\"\\n    style={{ width: \'100%\', height: \'auto\' }}\\n  />\\n  <figcaption style={{ textAlign: \'center\', fontSize: \'0.9rem\', color: \'#666\' }}>\\n    <a href=\\"https://arxiv.org/abs/1706.03762\\" target=\\"_blank\\" rel=\\"noopener noreferrer\\">\\n      Image source{\' \'}\\n    </a>\\n  </figcaption>\\n</figure>\\n\\nAs the original [transformer](#transformer) was designed as a sequence-to-sequence processing model,\\nits primary application in the original paper was for translation tasks. The model takes two input\\nsequences: a source sequence and a target sequence. While modern large language models (LLMs) have\\nadapted and expanded upon this architecture for various tasks, we will focus for now on the original\\napplication of translation to understand the foundational principles. Later, we will explore how\\nthese principles are adjusted to form the backbone of modern LLMs.\\n\\n[We can see](#transformer) that this model takes two inputs. One for the encoder, the other for the decoder. Before feeding this inputs into the\\nmodel we create tokenizations and then embeddings for each token. These embeddings are concatenated with what one calls _positional encoding_.\\nAs we will see later, the positional encoding gives the model a sense of ordering inside of the token sequence.\\n\\nAfter the inputs are embedded and positional encoding is added, they are fed into the model. In the **encoder**, the inputs are duplicated three times and passed through a **Multi-Head Attention** block. Simply put, this block calculates the relative importance of each token (or its embedding) in relation to the others in the sequence. This mechanism, known as **self-attention**, was the groundbreaking innovation that paved the way for the development of modern large language models (LLMs).\\n\\nFollowing the attention block, the outputs are normalized using a **LayerNorm** to ensure they have a mean of zero. This normalization step enhances stability and convergence during training.\\n\\nOnce normalized, the outputs are passed into an **MLP (Multi-Layer Perceptron)**, which is a simple feed-forward neural network. The MLP applies additional transformations to the data, further refining the representations.\\n\\nThese processed outputs are then passed to another encoder block, and this process is repeated for a total of $$n$$ such blocks. The stacking of these blocks allows the model to capture increasingly complex patterns and relationships in the data.\\nThe decoder block in a [Transformer](#transformer) is composed of several key components, each designed to process the target sequence and incorporate context from the input sequence encoded by the encoder.\\n\\nThe process begins with a **masked multi-head self-attention layer**. This layer operates on the embedded tokens of the target sequence and applies a mask to ensure causality.\\nMasking ensures that each token can only attend to itself and tokens that came before it, preventing the decoder from accessing information about future tokens during sequence generation.\\nThis mechanism is crucial for autoregressive tasks like language generation, where the model predicts one token at a time.\\n\\nThe output of this masked self-attention, also called **causal self-attention**, layer is then passed into a second attention block. This second block is different from the first because it performs **cross-attention**. Instead of attending solely to the target sequence, it uses the outputs of the encoder for two of its inputs: the keys $$K$$ and values $$V$$. The queries $$Q$$, however, are derived from the output of the masked self-attention layer.\\nThis setup allows the decoder to focus on relevant parts of the input sequence, using the context provided by the encoder\'s output. Importantly, this attention block is **not masked**, as it operates on the encoder outputs, which remain static and do not require causality constraints.\\nFinally, the output of the cross-attention block is passed through a feed-forward neural network, similar to the one used in the encoder. This feed-forward step refines the representation and prepares it for either the next decoder layer or the output layer, where probabilities over the vocabulary are computed.\\n\\nNow, this provides a high-level and simplified overview of the Transformer architecture, which gave us a foundational understanding of how this model operates. Now, let’s dive into each step of the architecture with **great detail** so we can implement the Transformer from scratch in our machine learning library of choice. For me, that\'s **PyTorch**.\\n\\n## Tokenization & Embedding\\n\\nBefore a language model can operate on any kind of natural language, the text needs to be transformed into a form that a computer can understand. In the field of **Natural Language Processing (NLP)**, this process is known as **tokenization**.\\n\\nTokenization refers to the process of assigning a unique number (or token ID) to a unit of text. These units are typically referred to as **tokens**, and their definition can vary depending on the type of tokenizer used. However, in most cases, tokens are **larger than a single character but smaller than an entire word**.\\n\\nFor example:\\n\\n- The word \\"unbelievable\\" might be split into sub-tokens: `\\"un\\"`, `\\"believe\\"`, and `\\"able\\"`.\\n- These sub-tokens are then mapped to unique numerical IDs.\\n\\nTake the sentence `The dog jumped over the green door!` for example. The tokenizer of OpenAI for\\ntheir _GPT4o_ model, would make\\n\\n<img\\n  id=\\"token\\"\\n  src=\\"/static/images/blog/transformers00/token.png\\"\\n  alt=\\"Description of the image\\"\\n  style={{ width: \'40%\', height: \'auto\', \'padding-left\': \'0%\' }}\\n/>\\nout of this. The respective token IDs would be `[976, 6446, 48704, 1072, 290, 8851, 42166, 13]`.\\nNow that we have the token IDs, the next step is to map them into a **high-dimensional vector space**.\\nThis is done by using the token IDs as indices into an **embedding matrix**, which is essentially an array of vectors.\\nThe dimension of these vectors is referred to as **$$ d_{\\\\text{model}} $$**, often called the embedding dimension.\\n## Positional encoding\\nIn a [Transformer](#transformer), there is no inherent notion of sequence order because the architecture processes tokens in parallel.\\nTo address this, we use **positional encoding**, which injects information about the position of each token in the sequence into its embedding.\\nThis is achieved by adding a positional vector to the token embedding, where each position is represented using a combination of sine and cosine functions of different frequencies.\\nThese encodings allow the model to understand the relative and absolute positions of tokens within the sequence, enabling it to capture sequential information without explicit recurrence.\\n\\nMathematically, the positional encoding for a position $$pos$$ and dimension $$i$$ is defined as:\\n\\n$$\\nPE_{(pos, 2i)} = \\\\sin\\\\left(\\\\frac{pos}{10000^{2i/d_{\\\\text{model}}}}\\\\right) \\\\\\\\\\nPE_{(pos, 2i+1)} = \\\\cos\\\\left(\\\\frac{pos}{10000^{2i/d_{\\\\text{model}}}}\\\\right)\\n$$\\n\\nTo see how this works in practice, let\'s again consider the following sequence of tokens:\\n`[976, 6446, 48704, 1072, 290, 8851, 42166, 13]`.\\nFor simplicity, we\'ll assume that $$ d\\\\_{\\\\text{model}} = 4 $$.\\nThis means each token will be represented by a 4-dimensional embedding vector.\\nA matrix where each **row** corresponds to the $$ d*{\\\\text{model}}$$-dimensional embedding of a token could look like this:\\n\\n```python\\nimport torch\\n\\n# Example embedding matrix\\nembedding_matrix = torch.tensor([\\n    [0.12, 0.32, -0.54, 0.87],  # Embedding for token 976\\n    [0.05, 0.73, -0.12, 0.45],  # Embedding for token 6446\\n    [0.93, -0.34, 0.17, -0.87], # Embedding for token 48704\\n    [0.15, 0.22, -0.11, 0.34],  # Embedding for token 1072\\n    [0.29, -0.12, 0.54, -0.23], # Embedding for token 290\\n    [0.43, 0.56, -0.32, 0.12],  # Embedding for token 8851\\n    [0.91, -0.13, 0.38, -0.44], # Embedding for token 42166\\n    [0.07, 0.41, -0.25, 0.89]   # Embedding for token 13\\n])\\n```\\n\\nWe will then iterate through every position of the sequence and denote the current position as $$ pos $$.\\nFor each position, we calculate the positional encoding vector and add it to the corresponding token embedding.\\nThe calculation depends on whether the dimension index  $$i$$ is even or odd.\\n\\nFor an **even** dimension index $$ 2i $$, the positional encoding is calculated using $$PE_{(pos, 2i)}$$, otherwise $$PE_{(pos, 2i+1)}$$.\\nThe resulting positional encoding is then added element-wise to the embedding vector of the token at position $$ pos $$.\\nThis ensures that the embedding incorporates both semantic information (from the token embeddings) and positional information (from the positional encodings).\\n\\n# Encoder\\n\\nNow that we have the **positional encoded embeddings** of the source sequence, we can start feeding them into the **encoder** block.\\nThe first block of the encoder is the **attention layer**, which is not only the starting point but also the most important layer in the entire Transformer architecture.\\n\\n## Self-Attention\\n\\n<figure style={{ width: \'80%\', margin: \'auto\', paddingLeft: \'0%\' }}>\\n  <img\\n    id=\\"attention\\"\\n    src=\\"/static/images/blog/transformers00/attention.png\\"\\n    alt=\\"Description of the image\\"\\n    style={{ width: \'100%\', height: \'auto\' }}\\n  />\\n  <figcaption style={{ textAlign: \'center\', fontSize: \'0.9rem\', color: \'#666\' }}>\\n    <a\\n      href=\\"https://pub.towardsai.net/explaining-attention-in-transformers-from-the-encoder-point-of-view-5f8026634a34\\"\\n      target=\\"_blank\\"\\n      rel=\\"noopener noreferrer\\"\\n    >\\n      Image source{\' \'}\\n    </a>\\n  </figcaption>\\n</figure>\\nThe most important concept to understand in the Transformer architecture is the so-called\\n**self-attention** mechanism. This mechanism establishes an \\"attendance\\" between tokens that are\\nlikely related to each other. It helps the model understand dependencies and relationships across a\\nsequence of tokens.\\n\\nSuppose we have a sequence of tokens of length $$seq\\\\_len$$, and each token is represented by an embedding of size $$d_{\\\\text{model}} $$.\\nThis gives us a matrix of shape $$(seq_len,d\\\\_{\\\\text{model}}) $$, where each row corresponds to the embedding of a token in the sequence.\\n\\nTo perform self-attention, we copy this matrix **three times** and create three different matrices:\\n\\n- **Queries ($$ Q $$)**\\n- **Keys ($$ K $$)**\\n- **Values ($$ V $$)**\\n\\nMathematically, these are obtained by multiplying the original matrix $$X$$ (the token embeddings), of shape $$(seq\\\\_len,d\\\\_{\\\\text{model}}) $$, with learned weight matrices:\\n\\n$$\\nQ = XW_Q, \\\\quad K = XW_K, \\\\quad V = XW_V\\n$$\\n\\nThe self-attention mechanism computes the relationship between tokens in a sequence using **Queries ( $$Q$$ )**, **Keys ($$K$$)**, and **Values ($$V$$)**.\\nThe formula for self-attention is as follows:\\n\\n$$\\n\\\\text{Attention}(Q, K, V) = \\\\text{softmax}\\\\left(\\\\frac{QK^\\\\top}{\\\\sqrt{d_{\\\\text{model}}}}\\\\right)V\\n$$\\n\\n<figure style={{ width: \'100%\', margin: \'auto\', paddingLeft: \'0%\' }}>\\n  <img\\n    id=\\"token\\"\\n    src=\\"/static/images/blog/transformers00/atttention_weights.jpeg\\"\\n    alt=\\"Description of the image\\"\\n    style={{ width: \'100%\', height: \'auto\' }}\\n  />\\n  <figcaption style={{ textAlign: \'center\', fontSize: \'0.9rem\', color: \'#666\' }}>\\n    <a\\n      href=\\"https://medium.com/@amansinghalml_33304/llama-2-ec7d53cd4e04\\"\\n      target=\\"_blank\\"\\n      rel=\\"noopener noreferrer\\"\\n    >\\n      Image source{\' \'}\\n    </a>\\n  </figcaption>\\n</figure>\\n\\nThe first step in the attention mechanism is the **matrix multiplication** $$QK^\\\\top$$, which computes the relationships between query and key tokens.\\n\\nEach row $$i$$ in the resulting matrix contains the dot product of the embedding of the $$i$$-th token (from $$Q$$) with the embeddings of all other tokens (from $$K$$). For example, the first row represents how the token \\"Your\\" relates to all other tokens in the sequence based on their embeddings.\\n\\nAfter this, a **row-wise softmax operation** is applied. This converts the raw dot product scores into probabilities:\\n\\n- Each value in a row is normalized to fall between $$0$$ and $$1$$.\\n- The values in each row sum to $$1$$, allowing us to interpret them as probabilities or percentages showing how much a **query** token attends to each **key** token.\\n\\nTo prevent large values from destabilizing the softmax function, the result of $$QK^\\\\top$$ is divided by $$\\\\sqrt{d_{\\\\text{model}}}$$. This scaling is necessary because:\\n\\n- The variance of the dot product increases with $$d_{\\\\text{model}}$$, leading to a standard deviation of $$\\\\sqrt{d_{\\\\text{model}}} \\\\cdot \\\\sigma$$, where $$\\\\sigma$$ is the standard deviation of $$Q$$ and $$K$$.\\n- Dividing by $$\\\\sqrt{d_{\\\\text{model}}}$$ ensures that the standard deviation of the scaled values remains consistent, stabilizing the softmax operation and improving training stability.\\n\\nOnce we have calculated the attention weights, which form a matrix of shape $$(seq\\\\_len, seq\\\\_len)$$, the next step is to multiply this matrix with $$V$$. The $$V$$ matrix, which represents the values, is of shape $$(seq\\\\_len, d_{\\\\text{model}})$$.\\n\\nThe result of this multiplication is a new matrix of shape $$(seq\\\\_len, d_{\\\\text{model}})$$, where each row corresponds to a weighted combination of the embedding vectors, determined by the attention weights.\\n\\nTo understand this in detail, consider an example:\\n\\n- The entry $$11$$ (first row, first column) of the resulting matrix is computed as the **weighted sum** of the first entries of all embedding vectors (rows in $$V$$), where the weights are the attention values from the first token to all other tokens.\\n- More generally, for an entry $$ij$$ of the resulting matrix:\\n  - We **accumulate** all $$j$$-values (columns) of the embedding vectors, weighted by how much attention token $$i$$ pays to all other tokens.\\n\\nNow intuitively:\\n\\n- Each resulting row represents a \\"mix\\" of embedding vector values, where the mix is determined by the attention weights.\\n- The attention mechanism essentially highlights the most important parts of the embedding vectors for each token, allowing the model to focus on relevant context within the sequence.\\n\\nThis step combines the relationships (from the attention weights) with the actual content of the embedding vectors, producing an output that captures both context and meaning.\\n\\n## Skip connections & Normalization\\n\\nAfter the self-attention layer, we end up with a matrix of shape $$(seq\\\\_len, d_{\\\\text{model}})$$.\\nThe next step is to add the **input** of the attention layer to its **output**, a process known as a **skip connection** (or residual connection).\\n\\nSkip connections are introduced to address the **vanishing gradient problem**.\\nDuring backpropagation, gradients are repeatedly multiplied as they propagate backward through the network.\\nIf the gradient values are less than 1, this repeated multiplication can lead to extremely small gradient values, effectively stalling learning in earlier layers.\\nAdding a skip connection introduces an **additive term** that ensures the flow of gradients is not entirely dependent on the transformations within the layer.\\nThis mechanism helps preserve information from earlier layers and keep the gradient from underflowing during traing\\n\\nThis result is then passed to a **normalization layer** (commonly layer normalization) to ensure a mean of $$0$$ and unit standart deviation.\\n\\n## FFN\\n\\nNow the last part of the **encoder** is a final feed-forward network.\\nThis layer applies a fully connected transformation to each token independently, enhancing the model\'s capacity to learn complex representations.\\nLike the attention layer, the feed-forward network is followed by another **skip connection** and subsequent **normalization**.\\nThe output of each **encoder** layer has a shape of $$(seq\\\\_len, d_{\\\\text{model}})$$.\\nThese outputs are then passed to the **decoder** in the so-called **cross-attention layer**, which we will explore next.\\n\\n# Decoder\\n\\nNow that we explored how the encoder transforms our input, we will look at the decoder and how we can use it the solve our\\ntask of translation.\\nNow that we have explored how the encoder transforms the input, let’s turn our attention to the decoder and see how it helps solve the task of translation. To revisit our original goal, we are working on a **translation task**, where we have a **source** sentence in one language and a corresponding **target** sentence in another.\\n\\nFor example, consider the source sentence:  \\n`The dog jumped over the green door!`\\n\\nIts translation in German would be:  \\n`Der Hund springt \xfcber die gr\xfcne T\xfcr!`\\n\\nAfter tokenization, these sentences are converted into sequences of token IDs. For instance:\\n\\n- Source sentence (in English): `src = [976, 6446, 48704, 1072, 290, 8851, 42166, 13]`\\n- Target sentence (in German): `trg = [0, 12, 4433, 2304, 8872, 2240, 456, 2349, 13]`\\n\\nHere $$0$$ acts as a special `<START>` token that signifies the start of the sentence.\\nNow the decoder will use the **target (trg)** sequence as input and attempt to output a sequence that is **shifted by one token to the left**. This means the model predicts the next token in the sequence based on the previous tokens it has seen.\\n\\nFor example, given the target sequence:  \\n`trg = [0, 12, 4433, 2304, 8872, 2240, 456, 2349, 13]`\\n\\nThe **ground truth** for the decoder will be:  \\n`ground_truth = [12, 4433, 2304, 8872, 2240, 456, 2349, 13, 99999]`\\n\\nHere, $$99999$$ acts as a special `<END>` token that signifies the end of the sequence.\\nThe decoder learns to predict this `<END>` token to indicate that the translation process is complete.\\nEach token in the `ground_truth` corresponds to what the decoder should produce for the respective input token in the **shifted target sequence**.\\n\\n## Masked Multi-Head Attention\\n\\nNow that we understand what kind of inputs (targets) are fed into the decoder, let’s examine the first block, which is called the **Masked Multi-Head Attention** layer. Before diving into the **Multi-Head** aspect, let’s briefly explore the concept of **masking**.\\n\\n### Masking\\n\\nMasking refers to the process of **nullifying some of the attention weights** in the attention layer. This ensures that, in this block, a given token can **only attend to tokens that came before it** in the sequence (or itself).\\nThe purpose of masking is to enforce causality, meaning the model is not allowed to \\"look ahead\\" at future tokens while generating its output.\\nThis behavior mirrors the way the Transformer is used during sampling after it has been trained.\\nFor example, when generating text, the model predicts the next token one step at a time, based only on the tokens it has already seen.\\nTraining the model with this restriction ensures that it doesn\'t rely on information from tokens that are \\"in the future\\" relative to the current step.\\nBy applying masking in the attention mechanism, the Transformer learns to predict tokens in a sequential, autoregressive manner, maintaining the same causal relationship as during inference.\\nThis type of self-attention is therefore called **causal self-attention**.\\nTo build the mask, we use an **upper triangular mask**, where `1` indicates _masked_ positions, and `0` indicates _unmasked_ positions.\\n\\n```python\\nimport torch\\n\\n# Sequence length\\nseq_len = 8\\n\\n# Explicitly define the upper triangular mask as a tensor\\nupper_triangular_mask = torch.tensor([\\n    [0, 1, 1, 1, 1, 1, 1, 1],\\n    [0, 0, 1, 1, 1, 1, 1, 1],\\n    [0, 0, 0, 1, 1, 1, 1, 1],\\n    [0, 0, 0, 0, 1, 1, 1, 1],\\n    [0, 0, 0, 0, 0, 1, 1, 1],\\n    [0, 0, 0, 0, 0, 0, 1, 1],\\n    [0, 0, 0, 0, 0, 0, 0, 1],\\n    [0, 0, 0, 0, 0, 0, 0, 0],\\n], dtype=torch.float32)\\n\\n# Example attention scores (random values)\\nattention_scores = torch.randn((seq_len, seq_len))\\n\\n# Apply the mask using torch.where\\nmasked_attention_scores = torch.where(upper_triangular_mask.bool(), float(\'-inf\'), attention_scores)\\n\\n```\\n\\nInstead of directly multiplying the attention matrices by this mask, we modify the attention mechanism by setting specific attention values to negative infinity (`-inf`).\\n\\nGiven the output of $$\\\\frac{QK^\\\\top}{\\\\sqrt{d_{\\\\text{model}}}}$$, which is of shape $$(seq\\\\_len, seq\\\\_len)$$, we set attention values $$attention_{i,j}$$ where $$mask_{i,j} == 1 $$ to $$attention_{i,j} = -\\\\infty $$.\\nThis ensures that, when we apply the softmax function, these masked values are transformed to $$ 0 $$, while the other attention weights in each row still sum to $$ 1 $$.\\n\\n### Multi-Head Attention\\n\\nNow that we have an understanding of the self-attention mechanism, let’s add an important detail: **Multi-Head Attention**.\\nSo far, we’ve only described something akin to single-head self-attention.\\nIn **Multi-Head Attention**, we split the embedding dimension into $$h$$ parts, with each part becoming one of the attention heads.\\n\\nThis means that our input matrix, originally of shape $$(seq\\\\_len, d_{\\\\text{model}})$$, is transformed into a matrix of shape $$(h, seq\\\\_len, d_k)$$, where:\\n\\n$$\\nd_k = \\\\frac{d_{\\\\text{model}}}{h}\\n$$\\n\\nEach of these heads independently performs self-attention. For every head, we use separate learnable projection matrices $$W^Q$$, $$W^K$$, and $$W^V$$.\\nThis allows each head to focus on different parts of the sequence or capture different relationships within the data.\\n\\n<figure style={{ width: \'100%\', margin: \'auto\', paddingLeft: \'0%\' }}>\\n  <img\\n    id=\\"head\\"\\n    src=\\"/static/images/blog/transformers00/head.png\\"\\n    alt=\\"Description of the image\\"\\n    style={{ width: \'100%\', height: \'auto\' }}\\n  />\\n  <figcaption style={{ textAlign: \'center\', fontSize: \'0.9rem\', color: \'#666\' }}>\\n    <a\\n      href=\\"https://ai.stackexchange.com/questions/45329/how-the-q-k-v-be-calculated-in-multi-head-attention\\"\\n      target=\\"_blank\\"\\n      rel=\\"noopener noreferrer\\"\\n    >\\n      Image source{\' \'}\\n    </a>\\n  </figcaption>\\n</figure>\\n\\nAfter performing self-attention for all $$h$$ heads, their outputs are concatenated back together, resulting in a matrix of shape $$(seq\\\\_len, d_{\\\\text{model}})$$.\\nFinally, this concatenated matrix is projected back to the original embedding dimension using a final learnable matrix $$W_O$$, which is of shape $$(d_{\\\\text{model}}, d_{\\\\text{model}})$$.\\nThis can be summarized as follows:\\n\\n$$\\n\\\\text{MultiHead}(Q, K, V) = \\\\text{Concat}(\\\\text{head}_1, \\\\text{head}_2, \\\\dots, \\\\text{head}_h)W^O\\n$$\\n\\n$$\\n\\\\text{where head}_i = \\\\text{Attention}(XW^Q_i, XW^K_i, XW^V_i) = \\\\text{Softmax}\\\\left(\\\\frac{Q_iK_i^\\\\top}{\\\\sqrt{d_k}}\\\\right)V_i\\n$$\\n\\nAfter this layer, we apply a skip connection and normalization, just as we did before. The outputs are then fed into the next attention layer,\\nwhich lies at the heart of the model. As this layer is where the decoder integrates the outputs of the encoder it is therefore called the **cross-attention layer**.\\n\\n## Cross Attention\\n\\nNow the **cross-attention** layer is where the decoder integrates the outputs of the encoder. Instead of performing self-attention solely on the target sequence, the decoder uses the encoder\'s outputs as the **keys** and **values** while the decoder\'s outputs from the previous layer serve as the **queries**.\\nThe primary goal of the cross-attention layer is to allow the decoder to focus on relevant parts of the input sequence (processed by the encoder) when generating each token of the output sequence.\\n\\n<figure style={{ width: \'100%\', margin: \'auto\', paddingLeft: \'0%\' }}>\\n  <img\\n    id=\\"cross\\"\\n    src=\\"/static/images/blog/transformers00/cross.png\\"\\n    alt=\\"Description of the image\\"\\n    style={{ width: \'100%\', height: \'auto\' }}\\n  />\\n  <figcaption style={{ textAlign: \'center\', fontSize: \'0.9rem\', color: \'#666\' }}>\\n    <a\\n      href=\\"https://toloka.ai/blog/transformer-architecture/\\"\\n      target=\\"_blank\\"\\n      rel=\\"noopener noreferrer\\"\\n    >\\n      Image source{\' \'}\\n    </a>\\n  </figcaption>\\n</figure>\\n\\nTherefore, in the **cross-attention layer**, we use the target embeddings as the **queries**, which\\nattend to the source sequence embeddings (the **keys**). The attention mechanism computes the\\nalignment between the source and target sequences. Using the calculated attention weights, we\\nmultiply this matrix by the **values** (i.e., the outputs of the encoder).\\nAgain, formulating this mathematically and with the target embeddings $$T$$ and encoder ouput $$S$$, we get\\n\\n$$\\n\\\\text{MultiHead}(Q, K, V) = \\\\text{Concat}(\\\\text{head}_1, \\\\text{head}_2, \\\\dots, \\\\text{head}_h)W^O\\n$$\\n\\n$$\\n\\\\text{where head}_i = \\\\text{Attention}(TW^Q_i, SW^K_i, SW^V_i) = \\\\text{Softmax}\\\\left(\\\\frac{Q_iK_i^\\\\top}{\\\\sqrt{d_k}}\\\\right)V_i\\n$$\\n\\nThis operation\\naccumulates information from the encoder, weighted by how much each target token attends to\\ndifferent parts of the source sequence. As usual, after this layer, we add the inputs of the layer\\nto its output as a **skip connection**. Following this, we apply **normalization** to the result.\\n\\n## End of the Decoder\\n\\nNow, before reaching the end of the decoder block, we pass the current values through another **feed-forward network (FFN)**. As with previous layers, we add the input of the FFN to its output via a **skip connection** and apply **normalization** to the result.\\nThis marks the conclusion of a single decoder block.\\nIn practice, we stack multiple decoder blocks in sequence, with each block refining the outputs of the previous one, enabling the model to better capture complex relationships within the data.\\n\\n## Final prediction\\n\\nNow that we have the outputs of the decoder, we need to map them to **probabilities** over our vocabulary of tokens. Given the input:\\n\\n- **Source sentence (in English)**: `src = [976, 6446, 48704, 1072, 290, 8851, 42166, 13]`\\n- **Target sentence (in German)**: `trg = [0, 12, 4433, 2304, 8872, 2240, 456, 2349, 13]`\\n\\nWe aim to predict the next token for each position in the target sequence. This means our **ground truth** will be:\\n`ground_truth = [12, 4433, 2304, 8872, 2240, 456, 2349, 13, 99999]`, where `99999` represents the `<END>` token.\\n\\nThe output of the decoder has a shape of $$(target\\\\_seq\\\\_len, d_{\\\\text{model}})$$, which contains the contextualized embeddings of each token. However, to generate probabilities over the vocabulary, we need to map these outputs to a new shape: $$(target\\\\_seq\\\\_len, vocab\\\\_size)$$.\\n\\nThis is achieved by applying a **linear projection** (a dense layer) that transforms the decoder outputs into the vocabulary space. The $$i$$-th entry of this transformed output will contain the probabilities over all tokens in the vocabulary, representing the likelihood of each token being the **next token** after token $$i$$.\\n\\n### Steps:\\n\\n1. **Linear Layer**: The decoder output is passed through a dense layer with weights of shape $$(d_{\\\\text{model}}, vocab\\\\_size)$$ to project each token embedding into the vocabulary space.\\n2. **Softmax**: A softmax operation is applied to the output of the linear layer to compute the probabilities for each token in the vocabulary.\\n\\nThis final output provides a distribution over the vocabulary for each position in the target sequence, enabling the model to predict the next token at each step.\\n\\n## Next up\\n\\nNow that we understand how a Transformer works internally, in the next post, we will implement one from scratch.\\nThere, we will focus on building a translation model, applying the concepts we\'ve explored to transform a source sentence into its corresponding target sentence.\\n","code":"var Component=(()=>{var o=Object.create;var i=Object.defineProperty;var p=Object.getOwnPropertyDescriptor;var N=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,u=Object.prototype.hasOwnProperty;var y=(s,a)=>()=>(a||s((a={exports:{}}).exports,a),a.exports),w=(s,a)=>{for(var n in a)i(s,n,{get:a[n],enumerable:!0})},r=(s,a,n,t)=>{if(a&&typeof a==\\"object\\"||typeof a==\\"function\\")for(let l of N(a))!u.call(s,l)&&l!==n&&i(s,l,{get:()=>a[l],enumerable:!(t=p(a,l))||t.enumerable});return s};var v=(s,a,n)=>(n=s!=null?o(g(s)):{},r(a||!s||!s.__esModule?i(n,\\"default\\",{value:s,enumerable:!0}):n,s)),x=s=>r(i({},\\"__esModule\\",{value:!0}),s);var m=y((M,c)=>{c.exports=_jsx_runtime});var f={};w(f,{default:()=>d,frontmatter:()=>k});var e=v(m()),k={title:\\"Introduction to Transformers - Part 00 - Architecture\\",date:\\"2024-08-21\\",tags:[\\"transformer\\",\\"nlp\\",\\"theory\\"],draft:!1,summary:\\"A short introduction to the architecture behind transformers how they can be utilized in NLP tasks.\\"};function h(s){let a={a:\\"a\\",annotation:\\"annotation\\",br:\\"br\\",code:\\"code\\",em:\\"em\\",h1:\\"h1\\",h2:\\"h2\\",h3:\\"h3\\",li:\\"li\\",math:\\"math\\",mfrac:\\"mfrac\\",mi:\\"mi\\",mn:\\"mn\\",mo:\\"mo\\",mrow:\\"mrow\\",mspace:\\"mspace\\",msqrt:\\"msqrt\\",msub:\\"msub\\",msubsup:\\"msubsup\\",msup:\\"msup\\",mtext:\\"mtext\\",ol:\\"ol\\",p:\\"p\\",path:\\"path\\",pre:\\"pre\\",semantics:\\"semantics\\",span:\\"span\\",strong:\\"strong\\",svg:\\"svg\\",ul:\\"ul\\",...s.components};return(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)(a.p,{children:[\\"Transformers have revolutionized the field of natural language processing (NLP), becoming the foundation for state-of-the-art models like BERT, GPT, and T5. Introduced in the seminal paper \\",(0,e.jsx)(\\"a\\",{href:\\"https://arxiv.org/abs/1706.03762\\",target:\\"_blank\\",rel:\\"noopener noreferrer\\",children:\\"Attention Is All You Need\\"}),\\", transformers replaced recurrent and convolutional architectures by leveraging a novel mechanism called \\",(0,e.jsx)(a.strong,{children:\\"self-attention\\"}),\\".\\"]}),(0,e.jsx)(a.p,{children:\\"At their core, transformers process entire input sequences simultaneously, allowing them to capture global relationships within the data efficiently. This architecture not only improves performance on complex NLP tasks like machine translation and text summarization but also scales effectively to massive datasets and models.\\"}),(0,e.jsx)(a.p,{children:\\"In this series, we will explore the key components of the transformer architecture, starting with its foundational building blocks and how they enable efficient learning from sequential data.\\"}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"architecture-overview\\",children:[(0,e.jsx)(a.a,{href:\\"#architecture-overview\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Architecture Overview\\"]}),(0,e.jsxs)(a.p,{children:[\\"Before explaining every bit of the transformer model in detail, we will take a quick step back and give a small Overview of the steps we will cover. The below \\",(0,e.jsx)(a.a,{href:\\"#transformer\\",children:\\"image\\"}),\\" describes the whole model very accuarctly.\\"]}),(0,e.jsxs)(\\"figure\\",{style:{width:\\"40%\\",margin:\\"auto\\",paddingLeft:\\"0%\\"},children:[(0,e.jsx)(\\"img\\",{id:\\"transformer\\",src:\\"/static/images/blog/transformers00/transformer.png\\",alt:\\"Description of the image\\",style:{width:\\"100%\\",height:\\"auto\\"}}),(0,e.jsx)(\\"figcaption\\",{style:{textAlign:\\"center\\",fontSize:\\"0.9rem\\",color:\\"#666\\"},children:(0,e.jsx)(\\"a\\",{href:\\"https://arxiv.org/abs/1706.03762\\",target:\\"_blank\\",rel:\\"noopener noreferrer\\",children:(0,e.jsxs)(a.p,{children:[\\"Image source\\",\\" \\"]})})})]}),(0,e.jsxs)(a.p,{children:[\\"As the original \\",(0,e.jsx)(a.a,{href:\\"#transformer\\",children:\\"transformer\\"}),\\" was designed as a sequence-to-sequence processing model, its primary application in the original paper was for translation tasks. The model takes two input sequences: a source sequence and a target sequence. While modern large language models (LLMs) have adapted and expanded upon this architecture for various tasks, we will focus for now on the original application of translation to understand the foundational principles. Later, we will explore how these principles are adjusted to form the backbone of modern LLMs.\\"]}),(0,e.jsxs)(a.p,{children:[(0,e.jsx)(a.a,{href:\\"#transformer\\",children:\\"We can see\\"}),\\" that this model takes two inputs. One for the encoder, the other for the decoder. Before feeding this inputs into the model we create tokenizations and then embeddings for each token. These embeddings are concatenated with what one calls \\",(0,e.jsx)(a.em,{children:\\"positional encoding\\"}),\\". As we will see later, the positional encoding gives the model a sense of ordering inside of the token sequence.\\"]}),(0,e.jsxs)(a.p,{children:[\\"After the inputs are embedded and positional encoding is added, they are fed into the model. In the \\",(0,e.jsx)(a.strong,{children:\\"encoder\\"}),\\", the inputs are duplicated three times and passed through a \\",(0,e.jsx)(a.strong,{children:\\"Multi-Head Attention\\"}),\\" block. Simply put, this block calculates the relative importance of each token (or its embedding) in relation to the others in the sequence. This mechanism, known as \\",(0,e.jsx)(a.strong,{children:\\"self-attention\\"}),\\", was the groundbreaking innovation that paved the way for the development of modern large language models (LLMs).\\"]}),(0,e.jsxs)(a.p,{children:[\\"Following the attention block, the outputs are normalized using a \\",(0,e.jsx)(a.strong,{children:\\"LayerNorm\\"}),\\" to ensure they have a mean of zero. This normalization step enhances stability and convergence during training.\\"]}),(0,e.jsxs)(a.p,{children:[\\"Once normalized, the outputs are passed into an \\",(0,e.jsx)(a.strong,{children:\\"MLP (Multi-Layer Perceptron)\\"}),\\", which is a simple feed-forward neural network. The MLP applies additional transformations to the data, further refining the representations.\\"]}),(0,e.jsxs)(a.p,{children:[\\"These processed outputs are then passed to another encoder block, and this process is repeated for a total of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"n\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"n\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".4306em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"})]})})]}),\\" such blocks. The stacking of these blocks allows the model to capture increasingly complex patterns and relationships in the data. The decoder block in a \\",(0,e.jsx)(a.a,{href:\\"#transformer\\",children:\\"Transformer\\"}),\\" is composed of several key components, each designed to process the target sequence and incorporate context from the input sequence encoded by the encoder.\\"]}),(0,e.jsxs)(a.p,{children:[\\"The process begins with a \\",(0,e.jsx)(a.strong,{children:\\"masked multi-head self-attention layer\\"}),\\". This layer operates on the embedded tokens of the target sequence and applies a mask to ensure causality. Masking ensures that each token can only attend to itself and tokens that came before it, preventing the decoder from accessing information about future tokens during sequence generation. This mechanism is crucial for autoregressive tasks like language generation, where the model predicts one token at a time.\\"]}),(0,e.jsxs)(a.p,{children:[\\"The output of this masked self-attention, also called \\",(0,e.jsx)(a.strong,{children:\\"causal self-attention\\"}),\\", layer is then passed into a second attention block. This second block is different from the first because it performs \\",(0,e.jsx)(a.strong,{children:\\"cross-attention\\"}),\\". Instead of attending solely to the target sequence, it uses the outputs of the encoder for two of its inputs: the keys \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"K\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"K\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})]})})]}),\\" and values \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"V\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"V\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})})]}),\\". The queries \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"Q\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"Q\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8778em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"})]})})]}),\\", however, are derived from the output of the masked self-attention layer. This setup allows the decoder to focus on relevant parts of the input sequence, using the context provided by the encoder\'s output. Importantly, this attention block is \\",(0,e.jsx)(a.strong,{children:\\"not masked\\"}),\\", as it operates on the encoder outputs, which remain static and do not require causality constraints. Finally, the output of the cross-attention block is passed through a feed-forward neural network, similar to the one used in the encoder. This feed-forward step refines the representation and prepares it for either the next decoder layer or the output layer, where probabilities over the vocabulary are computed.\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now, this provides a high-level and simplified overview of the Transformer architecture, which gave us a foundational understanding of how this model operates. Now, let\\\\u2019s dive into each step of the architecture with \\",(0,e.jsx)(a.strong,{children:\\"great detail\\"}),\\" so we can implement the Transformer from scratch in our machine learning library of choice. For me, that\'s \\",(0,e.jsx)(a.strong,{children:\\"PyTorch\\"}),\\".\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"tokenization--embedding\\",children:[(0,e.jsx)(a.a,{href:\\"#tokenization--embedding\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Tokenization & Embedding\\"]}),(0,e.jsxs)(a.p,{children:[\\"Before a language model can operate on any kind of natural language, the text needs to be transformed into a form that a computer can understand. In the field of \\",(0,e.jsx)(a.strong,{children:\\"Natural Language Processing (NLP)\\"}),\\", this process is known as \\",(0,e.jsx)(a.strong,{children:\\"tokenization\\"}),\\".\\"]}),(0,e.jsxs)(a.p,{children:[\\"Tokenization refers to the process of assigning a unique number (or token ID) to a unit of text. These units are typically referred to as \\",(0,e.jsx)(a.strong,{children:\\"tokens\\"}),\\", and their definition can vary depending on the type of tokenizer used. However, in most cases, tokens are \\",(0,e.jsx)(a.strong,{children:\\"larger than a single character but smaller than an entire word\\"}),\\".\\"]}),(0,e.jsx)(a.p,{children:\\"For example:\\"}),(0,e.jsxs)(a.ul,{children:[(0,e.jsxs)(a.li,{children:[\'The word \\"unbelievable\\" might be split into sub-tokens: \',(0,e.jsx)(a.code,{children:\'\\"un\\"\'}),\\", \\",(0,e.jsx)(a.code,{children:\'\\"believe\\"\'}),\\", and \\",(0,e.jsx)(a.code,{children:\'\\"able\\"\'}),\\".\\"]}),(0,e.jsx)(a.li,{children:\\"These sub-tokens are then mapped to unique numerical IDs.\\"})]}),(0,e.jsxs)(a.p,{children:[\\"Take the sentence \\",(0,e.jsx)(a.code,{children:\\"The dog jumped over the green door!\\"}),\\" for example. The tokenizer of OpenAI for their \\",(0,e.jsx)(a.em,{children:\\"GPT4o\\"}),\\" model, would make\\"]}),(0,e.jsx)(\\"img\\",{id:\\"token\\",src:\\"/static/images/blog/transformers00/token.png\\",alt:\\"Description of the image\\",style:{width:\\"40%\\",height:\\"auto\\",\\"padding-left\\":\\"0%\\"}}),(0,e.jsxs)(a.p,{children:[\\"out of this. The respective token IDs would be \\",(0,e.jsx)(a.code,{children:\\"[976, 6446, 48704, 1072, 290, 8851, 42166, 13]\\"}),\\". Now that we have the token IDs, the next step is to map them into a \\",(0,e.jsx)(a.strong,{children:\\"high-dimensional vector space\\"}),\\". This is done by using the token IDs as indices into an \\",(0,e.jsx)(a.strong,{children:\\"embedding matrix\\"}),\\", which is essentially an array of vectors. The dimension of these vectors is referred to as \\",(0,e.jsx)(a.strong,{children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"d_{\\\\\\\\text{model}}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8444em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]})}),\\", often called the embedding dimension.\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"positional-encoding\\",children:[(0,e.jsx)(a.a,{href:\\"#positional-encoding\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Positional encoding\\"]}),(0,e.jsxs)(a.p,{children:[\\"In a \\",(0,e.jsx)(a.a,{href:\\"#transformer\\",children:\\"Transformer\\"}),\\", there is no inherent notion of sequence order because the architecture processes tokens in parallel. To address this, we use \\",(0,e.jsx)(a.strong,{children:\\"positional encoding\\"}),\\", which injects information about the position of each token in the sequence into its embedding. This is achieved by adding a positional vector to the token embedding, where each position is represented using a combination of sine and cosine functions of different frequencies. These encodings allow the model to understand the relative and absolute positions of tokens within the sequence, enabling it to capture sequential information without explicit recurrence.\\"]}),(0,e.jsxs)(a.p,{children:[\\"Mathematically, the positional encoding for a position \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"pos\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"os\\"})]})})]}),\\" and dimension \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"i\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\" is defined as:\\"]}),(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"P\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"E\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mn,{children:\\"2\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]})]}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mi,{children:\\"sin\\"}),(0,e.jsx)(a.mo,{children:\\"\\\\u2061\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\"(\\"}),(0,e.jsxs)(a.mfrac,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"})]}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mn,{children:\\"1000\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mn,{children:\\"0\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mn,{children:\\"2\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"/\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})]})]})]})]}),(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\")\\"})]}),(0,e.jsx)(a.mspace,{linebreak:\\"newline\\"}),(0,e.jsx)(a.mi,{children:\\"P\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"E\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mn,{children:\\"2\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mo,{children:\\"+\\"}),(0,e.jsx)(a.mn,{children:\\"1\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]})]}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mi,{children:\\"cos\\"}),(0,e.jsx)(a.mo,{children:\\"\\\\u2061\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\"(\\"}),(0,e.jsxs)(a.mfrac,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"})]}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mn,{children:\\"1000\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mn,{children:\\"0\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mn,{children:\\"2\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"/\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})]})]})]})]}),(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\")\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"PE_{(pos, 2i)} = \\\\\\\\sin\\\\\\\\left(\\\\\\\\frac{pos}{10000^{2i/d_{\\\\\\\\text{model}}}}\\\\\\\\right) \\\\\\\\\\\\\\\\ PE_{(pos, 2i+1)} = \\\\\\\\cos\\\\\\\\left(\\\\\\\\frac{pos}{10000^{2i/d_{\\\\\\\\text{model}}}}\\\\\\\\right)\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05764em\\"},children:\\"E\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.0576em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mtight mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"os\\"}),(0,e.jsx)(a.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mtight mclose\\",children:\\")\\"})]})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.854em\\",verticalAlign:\\"-.704em\\"}}),(0,e.jsx)(a.span,{className:\\"mop\\",children:\\"sin\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"minner\\",children:[(0,e.jsx)(a.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"delimsizing size2\\",children:\\"(\\"})}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mopen nulldelimiter\\"}),(0,e.jsx)(a.span,{className:\\"mfrac\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\"1.1076em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.296em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"1000\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".814em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.989em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"/\\"}),(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.3488em\\",marginLeft:\\"0\\",marginRight:\\".0714em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1512em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]})})})})})]})]})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.23em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.677em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"os\\"})]})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".704em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mclose nulldelimiter\\"})]}),(0,e.jsx)(a.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"delimsizing size2\\",children:\\")\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"mspace newline\\"}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05764em\\"},children:\\"E\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.0576em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mtight mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"os\\"}),(0,e.jsx)(a.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mtight mbin\\",children:\\"+\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"mtight mclose\\",children:\\")\\"})]})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.854em\\",verticalAlign:\\"-.704em\\"}}),(0,e.jsx)(a.span,{className:\\"mop\\",children:\\"cos\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"minner\\",children:[(0,e.jsx)(a.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"delimsizing size2\\",children:\\"(\\"})}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mopen nulldelimiter\\"}),(0,e.jsx)(a.span,{className:\\"mfrac\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\"1.1076em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.296em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"1000\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".814em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.989em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"/\\"}),(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.3488em\\",marginLeft:\\"0\\",marginRight:\\".0714em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1512em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]})})})})})]})]})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.23em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.677em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"os\\"})]})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".704em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mclose nulldelimiter\\"})]}),(0,e.jsx)(a.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"delimsizing size2\\",children:\\")\\"})})]})]})]})]})}),(0,e.jsxs)(a.p,{children:[\\"To see how this works in practice, let\'s again consider the following sequence of tokens: \\",(0,e.jsx)(a.code,{children:\\"[976, 6446, 48704, 1072, 290, 8851, 42166, 13]\\"}),\\". For simplicity, we\'ll assume that \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mn,{children:\\"4\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"d\\\\\\\\_{\\\\\\\\text{model}} = 4\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0044em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"model\\"})})}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"4\\"})]})]})]}),\\". This means each token will be represented by a 4-dimensional embedding vector. A matrix where each \\",(0,e.jsx)(a.strong,{children:\\"row\\"}),\\" corresponds to the \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mo,{children:\\"\\\\u2217\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\" d*{\\\\\\\\text{model}}\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,e.jsx)(a.span,{className:\\"mbin\\",children:\\"\\\\u2217\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"model\\"})})})]})]})]}),\\"-dimensional embedding of a token could look like this:\\"]}),(0,e.jsx)(a.pre,{className:\\"language-python\\",children:(0,e.jsxs)(a.code,{className:\\"language-python code-highlight\\",children:[(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token keyword\\",children:\\"import\\"}),` torch\\n`]}),(0,e.jsx)(a.span,{className:\\"code-line\\",children:`\\n`}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Example embedding matrix\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"embedding_matrix \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"tensor\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.12\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.32\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.54\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.87\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"  \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 976\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.05\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.73\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.12\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.45\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"  \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 6446\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.93\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.34\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.17\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.87\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 48704\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.15\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.22\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.11\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.34\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"  \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 1072\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.29\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.12\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.54\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.23\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 290\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.43\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.56\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.32\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.12\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"  \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 8851\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.91\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.13\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.38\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.44\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 42166\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.07\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.41\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"-\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.25\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0.89\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\"   \\",(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Embedding for token 13\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,e.jsxs)(a.p,{children:[\\"We will then iterate through every position of the sequence and denote the current position as \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"pos\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"os\\"})]})})]}),\\". For each position, we calculate the positional encoding vector and add it to the corresponding token embedding. The calculation depends on whether the dimension index \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"i\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\" is even or odd.\\"]}),(0,e.jsxs)(a.p,{children:[\\"For an \\",(0,e.jsx)(a.strong,{children:\\"even\\"}),\\" dimension index \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mn,{children:\\"2\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"2i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"2\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\", the positional encoding is calculated using \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"P\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"E\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mn,{children:\\"2\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"PE_{(pos, 2i)}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05764em\\"},children:\\"E\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.0576em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mtight mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"os\\"}),(0,e.jsx)(a.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mtight mclose\\",children:\\")\\"})]})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]}),\\", otherwise \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"P\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"E\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mn,{children:\\"2\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mo,{children:\\"+\\"}),(0,e.jsx)(a.mn,{children:\\"1\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"PE_{(pos, 2i+1)}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0385em\\",verticalAlign:\\"-.3552em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"P\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05764em\\"},children:\\"E\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.5198em\\",marginLeft:\\"-.0576em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mtight mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"os\\"}),(0,e.jsx)(a.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mtight mbin\\",children:\\"+\\"}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"mtight mclose\\",children:\\")\\"})]})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3552em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]}),\\". The resulting positional encoding is then added element-wise to the embedding vector of the token at position \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"p\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"pos\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"p\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"os\\"})]})})]}),\\". This ensures that the embedding incorporates both semantic information (from the token embeddings) and positional information (from the positional encodings).\\"]}),(0,e.jsxs)(a.h1,{className:\\"content-header\\",id:\\"encoder\\",children:[(0,e.jsx)(a.a,{href:\\"#encoder\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Encoder\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now that we have the \\",(0,e.jsx)(a.strong,{children:\\"positional encoded embeddings\\"}),\\" of the source sequence, we can start feeding them into the \\",(0,e.jsx)(a.strong,{children:\\"encoder\\"}),\\" block. The first block of the encoder is the \\",(0,e.jsx)(a.strong,{children:\\"attention layer\\"}),\\", which is not only the starting point but also the most important layer in the entire Transformer architecture.\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"self-attention\\",children:[(0,e.jsx)(a.a,{href:\\"#self-attention\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Self-Attention\\"]}),(0,e.jsxs)(\\"figure\\",{style:{width:\\"80%\\",margin:\\"auto\\",paddingLeft:\\"0%\\"},children:[(0,e.jsx)(\\"img\\",{id:\\"attention\\",src:\\"/static/images/blog/transformers00/attention.png\\",alt:\\"Description of the image\\",style:{width:\\"100%\\",height:\\"auto\\"}}),(0,e.jsx)(\\"figcaption\\",{style:{textAlign:\\"center\\",fontSize:\\"0.9rem\\",color:\\"#666\\"},children:(0,e.jsx)(\\"a\\",{href:\\"https://pub.towardsai.net/explaining-attention-in-transformers-from-the-encoder-point-of-view-5f8026634a34\\",target:\\"_blank\\",rel:\\"noopener noreferrer\\",children:(0,e.jsxs)(a.p,{children:[\\"Image source\\",\\" \\"]})})})]}),(0,e.jsxs)(a.p,{children:[\\"The most important concept to understand in the Transformer architecture is the so-called \\",(0,e.jsx)(a.strong,{children:\\"self-attention\\"}),\' mechanism. This mechanism establishes an \\"attendance\\" between tokens that are likely related to each other. It helps the model understand dependencies and relationships across a sequence of tokens.\']}),(0,e.jsxs)(a.p,{children:[\\"Suppose we have a sequence of tokens of length \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"seq\\\\\\\\_len\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0044em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"})]})})]}),\\", and each token is represented by an embedding of size \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"d_{\\\\\\\\text{model}} \\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8444em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]}),\\". This gives us a matrix of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"})]}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq_len,d\\\\\\\\_{\\\\\\\\text{model}}) \\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"model\\"})})}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", where each row corresponds to the embedding of a token in the sequence.\\"]}),(0,e.jsxs)(a.p,{children:[\\"To perform self-attention, we copy this matrix \\",(0,e.jsx)(a.strong,{children:\\"three times\\"}),\\" and create three different matrices:\\"]}),(0,e.jsxs)(a.ul,{children:[(0,e.jsx)(a.li,{children:(0,e.jsxs)(a.strong,{children:[\\"Queries (\\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"Q\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"Q\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8778em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"})]})})]}),\\")\\"]})}),(0,e.jsx)(a.li,{children:(0,e.jsxs)(a.strong,{children:[\\"Keys (\\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"K\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"K\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})]})})]}),\\")\\"]})}),(0,e.jsx)(a.li,{children:(0,e.jsxs)(a.strong,{children:[\\"Values (\\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"V\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"V\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})})]}),\\")\\"]})})]}),(0,e.jsxs)(a.p,{children:[\\"Mathematically, these are obtained by multiplying the original matrix \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"X\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"X\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"})]})})]}),\\" (the token embeddings), of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len,d\\\\\\\\_{\\\\\\\\text{model}}) \\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"model\\"})})}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", with learned weight matrices:\\"]}),(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mi,{children:\\"X\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"Q\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mspace,{width:\\"1em\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mi,{children:\\"X\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mspace,{width:\\"1em\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mi,{children:\\"X\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"Q = XW_Q, \\\\\\\\quad K = XW_K, \\\\\\\\quad V = XW_V\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8778em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".9694em\\",verticalAlign:\\"-.2861em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"Q\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\"1em\\"}}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8778em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\"1em\\"}}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})]})]})}),(0,e.jsxs)(a.p,{children:[\\"The self-attention mechanism computes the relationship between tokens in a sequence using \\",(0,e.jsxs)(a.strong,{children:[\\"Queries ( \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"Q\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"Q\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8778em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"})]})})]}),\\" )\\"]}),\\", \\",(0,e.jsxs)(a.strong,{children:[\\"Keys (\\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"K\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"K\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})]})})]}),\\")\\"]}),\\", and \\",(0,e.jsxs)(a.strong,{children:[\\"Values (\\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"V\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"V\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})})]}),\\")\\"]}),\\". The formula for self-attention is as follows:\\"]}),(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mtext,{children:\\"Attention\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mtext,{children:\\"softmax\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\"(\\"}),(0,e.jsxs)(a.mfrac,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"\\\\u22A4\\"})]})]}),(0,e.jsx)(a.msqrt,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})})]}),(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\")\\"})]}),(0,e.jsx)(a.mi,{children:\\"V\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{Attention}(Q, K, V) = \\\\\\\\text{softmax}\\\\\\\\left(\\\\\\\\frac{QK^\\\\\\\\top}{\\\\\\\\sqrt{d_{\\\\\\\\text{model}}}}\\\\\\\\right)V\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"Attention\\"})}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"2.4761em\\",verticalAlign:\\"-.95em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"softmax\\"})}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"minner\\",children:[(0,e.jsx)(a.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"size3 delimsizing\\",children:\\"(\\"})}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mopen nulldelimiter\\"}),(0,e.jsx)(a.span,{className:\\"mfrac\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\"1.5261em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.2528em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord sqrt\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8572em\\"},children:[(0,e.jsxs)(a.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{paddingLeft:\\".833em\\"},children:(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-2.8172em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,e.jsx)(a.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,e.jsx)(a.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1828em\\"},children:(0,e.jsx)(a.span,{})})})]})})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.23em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.677em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8491em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"\\\\u22A4\\"})})]})})})})})]})]})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".93em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mclose nulldelimiter\\"})]}),(0,e.jsx)(a.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"size3 delimsizing\\",children:\\")\\"})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})]})]})}),\\" \\",(0,e.jsxs)(\\"figure\\",{style:{width:\\"100%\\",margin:\\"auto\\",paddingLeft:\\"0%\\"},children:[(0,e.jsx)(\\"img\\",{id:\\"token\\",src:\\"/static/images/blog/transformers00/atttention_weights.jpeg\\",alt:\\"Description of the image\\",style:{width:\\"100%\\",height:\\"auto\\"}}),(0,e.jsx)(\\"figcaption\\",{style:{textAlign:\\"center\\",fontSize:\\"0.9rem\\",color:\\"#666\\"},children:(0,e.jsx)(\\"a\\",{href:\\"https://medium.com/@amansinghalml_33304/llama-2-ec7d53cd4e04\\",target:\\"_blank\\",rel:\\"noopener noreferrer\\",children:(0,e.jsxs)(a.p,{children:[\\"Image source\\",\\" \\"]})})})]}),(0,e.jsxs)(a.p,{children:[\\"The first step in the attention mechanism is the \\",(0,e.jsx)(a.strong,{children:\\"matrix multiplication\\"}),\\" \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"\\\\u22A4\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"QK^\\\\\\\\top\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0435em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8491em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"\\\\u22A4\\"})})]})})})})})]})]})})]}),\\", which computes the relationships between query and key tokens.\\"]}),(0,e.jsxs)(a.p,{children:[\\"Each row \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"i\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\" in the resulting matrix contains the dot product of the embedding of the \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"i\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\"-th token (from \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"Q\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"Q\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8778em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"})]})})]}),\\") with the embeddings of all other tokens (from \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"K\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"K\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})]})})]}),\'). For example, the first row represents how the token \\"Your\\" relates to all other tokens in the sequence based on their embeddings.\']}),(0,e.jsxs)(a.p,{children:[\\"After this, a \\",(0,e.jsx)(a.strong,{children:\\"row-wise softmax operation\\"}),\\" is applied. This converts the raw dot product scores into probabilities:\\"]}),(0,e.jsxs)(a.ul,{children:[(0,e.jsxs)(a.li,{children:[\\"Each value in a row is normalized to fall between \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"0\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"0\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"0\\"})]})})]}),\\" and \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"1\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"1\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"1\\"})]})})]}),\\".\\"]}),(0,e.jsxs)(a.li,{children:[\\"The values in each row sum to \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"1\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"1\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"1\\"})]})})]}),\\", allowing us to interpret them as probabilities or percentages showing how much a \\",(0,e.jsx)(a.strong,{children:\\"query\\"}),\\" token attends to each \\",(0,e.jsx)(a.strong,{children:\\"key\\"}),\\" token.\\"]})]}),(0,e.jsxs)(a.p,{children:[\\"To prevent large values from destabilizing the softmax function, the result of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"\\\\u22A4\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"QK^\\\\\\\\top\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.0435em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8491em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"\\\\u22A4\\"})})]})})})})})]})]})})]}),\\" is divided by \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.msqrt,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\sqrt{d_{\\\\\\\\text{model}}}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.04em\\",verticalAlign:\\"-.1828em\\"}}),(0,e.jsx)(a.span,{className:\\"mord sqrt\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8572em\\"},children:[(0,e.jsxs)(a.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{paddingLeft:\\".833em\\"},children:(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-2.8172em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,e.jsx)(a.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,e.jsx)(a.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1828em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),\\". This scaling is necessary because:\\"]}),(0,e.jsxs)(a.ul,{children:[(0,e.jsxs)(a.li,{children:[\\"The variance of the dot product increases with \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"d_{\\\\\\\\text{model}}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8444em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]}),\\", leading to a standard deviation of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.msqrt,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})}),(0,e.jsx)(a.mo,{children:\\"\\\\u22C5\\"}),(0,e.jsx)(a.mi,{children:\\"\\\\u03C3\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\sqrt{d_{\\\\\\\\text{model}}} \\\\\\\\cdot \\\\\\\\sigma\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.04em\\",verticalAlign:\\"-.1828em\\"}}),(0,e.jsx)(a.span,{className:\\"mord sqrt\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8572em\\"},children:[(0,e.jsxs)(a.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{paddingLeft:\\".833em\\"},children:(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-2.8172em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,e.jsx)(a.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,e.jsx)(a.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1828em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,e.jsx)(a.span,{className:\\"mbin\\",children:\\"\\\\u22C5\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".4306em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"})]})]})]}),\\", where \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"\\\\u03C3\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\sigma\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".4306em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"\\\\u03C3\\"})]})})]}),\\" is the standard deviation of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"Q\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"Q\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8778em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"})]})})]}),\\" and \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"K\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"K\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})]})})]}),\\".\\"]}),(0,e.jsxs)(a.li,{children:[\\"Dividing by \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.msqrt,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\sqrt{d_{\\\\\\\\text{model}}}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.04em\\",verticalAlign:\\"-.1828em\\"}}),(0,e.jsx)(a.span,{className:\\"mord sqrt\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8572em\\"},children:[(0,e.jsxs)(a.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{paddingLeft:\\".833em\\"},children:(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-2.8172em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,e.jsx)(a.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,e.jsx)(a.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1828em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),\\" ensures that the standard deviation of the scaled values remains consistent, stabilizing the softmax operation and improving training stability.\\"]})]}),(0,e.jsxs)(a.p,{children:[\\"Once we have calculated the attention weights, which form a matrix of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, seq\\\\\\\\_len)\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", the next step is to multiply this matrix with \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"V\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"V\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})})]}),\\". The \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"V\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"V\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})})]}),\\" matrix, which represents the values, is of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\".\\"]}),(0,e.jsxs)(a.p,{children:[\\"The result of this multiplication is a new matrix of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", where each row corresponds to a weighted combination of the embedding vectors, determined by the attention weights.\\"]}),(0,e.jsx)(a.p,{children:\\"To understand this in detail, consider an example:\\"}),(0,e.jsxs)(a.ul,{children:[(0,e.jsxs)(a.li,{children:[\\"The entry \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"11\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"11\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"11\\"})]})})]}),\\" (first row, first column) of the resulting matrix is computed as the \\",(0,e.jsx)(a.strong,{children:\\"weighted sum\\"}),\\" of the first entries of all embedding vectors (rows in \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"V\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"V\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})})]}),\\"), where the weights are the attention values from the first token to all other tokens.\\"]}),(0,e.jsxs)(a.li,{children:[\\"More generally, for an entry \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"j\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"ij\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".854em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"ij\\"})]})})]}),\\" of the resulting matrix:\\",(0,e.jsx)(a.ul,{children:(0,e.jsxs)(a.li,{children:[\\"We \\",(0,e.jsx)(a.strong,{children:\\"accumulate\\"}),\\" all \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"j\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"j\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".854em\\",verticalAlign:\\"-.1944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})]})})]}),\\"-values (columns) of the embedding vectors, weighted by how much attention token \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"i\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\" pays to all other tokens.\\"]})})]})]}),(0,e.jsx)(a.p,{children:\\"Now intuitively:\\"}),(0,e.jsxs)(a.ul,{children:[(0,e.jsx)(a.li,{children:\'Each resulting row represents a \\"mix\\" of embedding vector values, where the mix is determined by the attention weights.\'}),(0,e.jsx)(a.li,{children:\\"The attention mechanism essentially highlights the most important parts of the embedding vectors for each token, allowing the model to focus on relevant context within the sequence.\\"})]}),(0,e.jsx)(a.p,{children:\\"This step combines the relationships (from the attention weights) with the actual content of the embedding vectors, producing an output that captures both context and meaning.\\"}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"skip-connections--normalization\\",children:[(0,e.jsx)(a.a,{href:\\"#skip-connections--normalization\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Skip connections & Normalization\\"]}),(0,e.jsxs)(a.p,{children:[\\"After the self-attention layer, we end up with a matrix of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\". The next step is to add the \\",(0,e.jsx)(a.strong,{children:\\"input\\"}),\\" of the attention layer to its \\",(0,e.jsx)(a.strong,{children:\\"output\\"}),\\", a process known as a \\",(0,e.jsx)(a.strong,{children:\\"skip connection\\"}),\\" (or residual connection).\\"]}),(0,e.jsxs)(a.p,{children:[\\"Skip connections are introduced to address the \\",(0,e.jsx)(a.strong,{children:\\"vanishing gradient problem\\"}),\\". During backpropagation, gradients are repeatedly multiplied as they propagate backward through the network. If the gradient values are less than 1, this repeated multiplication can lead to extremely small gradient values, effectively stalling learning in earlier layers. Adding a skip connection introduces an \\",(0,e.jsx)(a.strong,{children:\\"additive term\\"}),\\" that ensures the flow of gradients is not entirely dependent on the transformations within the layer. This mechanism helps preserve information from earlier layers and keep the gradient from underflowing during traing\\"]}),(0,e.jsxs)(a.p,{children:[\\"This result is then passed to a \\",(0,e.jsx)(a.strong,{children:\\"normalization layer\\"}),\\" (commonly layer normalization) to ensure a mean of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"0\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"0\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"0\\"})]})})]}),\\" and unit standart deviation.\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"ffn\\",children:[(0,e.jsx)(a.a,{href:\\"#ffn\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"FFN\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now the last part of the \\",(0,e.jsx)(a.strong,{children:\\"encoder\\"}),\\" is a final feed-forward network. This layer applies a fully connected transformation to each token independently, enhancing the model\'s capacity to learn complex representations. Like the attention layer, the feed-forward network is followed by another \\",(0,e.jsx)(a.strong,{children:\\"skip connection\\"}),\\" and subsequent \\",(0,e.jsx)(a.strong,{children:\\"normalization\\"}),\\". The output of each \\",(0,e.jsx)(a.strong,{children:\\"encoder\\"}),\\" layer has a shape of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\". These outputs are then passed to the \\",(0,e.jsx)(a.strong,{children:\\"decoder\\"}),\\" in the so-called \\",(0,e.jsx)(a.strong,{children:\\"cross-attention layer\\"}),\\", which we will explore next.\\"]}),(0,e.jsxs)(a.h1,{className:\\"content-header\\",id:\\"decoder\\",children:[(0,e.jsx)(a.a,{href:\\"#decoder\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Decoder\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now that we explored how the encoder transforms our input, we will look at the decoder and how we can use it the solve our task of translation. Now that we have explored how the encoder transforms the input, let\\\\u2019s turn our attention to the decoder and see how it helps solve the task of translation. To revisit our original goal, we are working on a \\",(0,e.jsx)(a.strong,{children:\\"translation task\\"}),\\", where we have a \\",(0,e.jsx)(a.strong,{children:\\"source\\"}),\\" sentence in one language and a corresponding \\",(0,e.jsx)(a.strong,{children:\\"target\\"}),\\" sentence in another.\\"]}),(0,e.jsxs)(a.p,{children:[\\"For example, consider the source sentence:\\",(0,e.jsx)(a.br,{}),(0,e.jsx)(a.code,{children:\\"The dog jumped over the green door!\\"})]}),(0,e.jsxs)(a.p,{children:[\\"Its translation in German would be:\\",(0,e.jsx)(a.br,{}),(0,e.jsx)(a.code,{children:\\"Der Hund springt \\\\xFCber die gr\\\\xFCne T\\\\xFCr!\\"})]}),(0,e.jsx)(a.p,{children:\\"After tokenization, these sentences are converted into sequences of token IDs. For instance:\\"}),(0,e.jsxs)(a.ul,{children:[(0,e.jsxs)(a.li,{children:[\\"Source sentence (in English): \\",(0,e.jsx)(a.code,{children:\\"src = [976, 6446, 48704, 1072, 290, 8851, 42166, 13]\\"})]}),(0,e.jsxs)(a.li,{children:[\\"Target sentence (in German): \\",(0,e.jsx)(a.code,{children:\\"trg = [0, 12, 4433, 2304, 8872, 2240, 456, 2349, 13]\\"})]})]}),(0,e.jsxs)(a.p,{children:[\\"Here \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"0\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"0\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"0\\"})]})})]}),\\" acts as a special \\",(0,e.jsx)(a.code,{children:\\"<START>\\"}),\\" token that signifies the start of the sentence. Now the decoder will use the \\",(0,e.jsx)(a.strong,{children:\\"target (trg)\\"}),\\" sequence as input and attempt to output a sequence that is \\",(0,e.jsx)(a.strong,{children:\\"shifted by one token to the left\\"}),\\". This means the model predicts the next token in the sequence based on the previous tokens it has seen.\\"]}),(0,e.jsxs)(a.p,{children:[\\"For example, given the target sequence:\\",(0,e.jsx)(a.br,{}),(0,e.jsx)(a.code,{children:\\"trg = [0, 12, 4433, 2304, 8872, 2240, 456, 2349, 13]\\"})]}),(0,e.jsxs)(a.p,{children:[\\"The \\",(0,e.jsx)(a.strong,{children:\\"ground truth\\"}),\\" for the decoder will be:\\",(0,e.jsx)(a.br,{}),(0,e.jsx)(a.code,{children:\\"ground_truth = [12, 4433, 2304, 8872, 2240, 456, 2349, 13, 99999]\\"})]}),(0,e.jsxs)(a.p,{children:[\\"Here, \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"99999\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"99999\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"99999\\"})]})})]}),\\" acts as a special \\",(0,e.jsx)(a.code,{children:\\"<END>\\"}),\\" token that signifies the end of the sequence. The decoder learns to predict this \\",(0,e.jsx)(a.code,{children:\\"<END>\\"}),\\" token to indicate that the translation process is complete. Each token in the \\",(0,e.jsx)(a.code,{children:\\"ground_truth\\"}),\\" corresponds to what the decoder should produce for the respective input token in the \\",(0,e.jsx)(a.strong,{children:\\"shifted target sequence\\"}),\\".\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"masked-multi-head-attention\\",children:[(0,e.jsx)(a.a,{href:\\"#masked-multi-head-attention\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Masked Multi-Head Attention\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now that we understand what kind of inputs (targets) are fed into the decoder, let\\\\u2019s examine the first block, which is called the \\",(0,e.jsx)(a.strong,{children:\\"Masked Multi-Head Attention\\"}),\\" layer. Before diving into the \\",(0,e.jsx)(a.strong,{children:\\"Multi-Head\\"}),\\" aspect, let\\\\u2019s briefly explore the concept of \\",(0,e.jsx)(a.strong,{children:\\"masking\\"}),\\".\\"]}),(0,e.jsxs)(a.h3,{className:\\"content-header\\",id:\\"masking\\",children:[(0,e.jsx)(a.a,{href:\\"#masking\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Masking\\"]}),(0,e.jsxs)(a.p,{children:[\\"Masking refers to the process of \\",(0,e.jsx)(a.strong,{children:\\"nullifying some of the attention weights\\"}),\\" in the attention layer. This ensures that, in this block, a given token can \\",(0,e.jsx)(a.strong,{children:\\"only attend to tokens that came before it\\"}),` in the sequence (or itself). The purpose of masking is to enforce causality, meaning the model is not allowed to \\"look ahead\\" at future tokens while generating its output. This behavior mirrors the way the Transformer is used during sampling after it has been trained. For example, when generating text, the model predicts the next token one step at a time, based only on the tokens it has already seen. Training the model with this restriction ensures that it doesn\'t rely on information from tokens that are \\"in the future\\" relative to the current step. By applying masking in the attention mechanism, the Transformer learns to predict tokens in a sequential, autoregressive manner, maintaining the same causal relationship as during inference. This type of self-attention is therefore called `,(0,e.jsx)(a.strong,{children:\\"causal self-attention\\"}),\\". To build the mask, we use an \\",(0,e.jsx)(a.strong,{children:\\"upper triangular mask\\"}),\\", where \\",(0,e.jsx)(a.code,{children:\\"1\\"}),\\" indicates \\",(0,e.jsx)(a.em,{children:\\"masked\\"}),\\" positions, and \\",(0,e.jsx)(a.code,{children:\\"0\\"}),\\" indicates \\",(0,e.jsx)(a.em,{children:\\"unmasked\\"}),\\" positions.\\"]}),(0,e.jsx)(a.pre,{className:\\"language-python\\",children:(0,e.jsxs)(a.code,{className:\\"language-python code-highlight\\",children:[(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token keyword\\",children:\\"import\\"}),` torch\\n`]}),(0,e.jsx)(a.span,{className:\\"code-line\\",children:`\\n`}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Sequence length\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"seq_len \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"8\\"}),`\\n`]}),(0,e.jsx)(a.span,{className:\\"code-line\\",children:`\\n`}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Explicitly define the upper triangular mask as a tensor\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"upper_triangular_mask \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"tensor\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"1\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"    \\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token number\\",children:\\"0\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" dtype\\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"=\\"}),\\"torch\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"float32\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,e.jsx)(a.span,{className:\\"code-line\\",children:`\\n`}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Example attention scores (random values)\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"attention_scores \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"randn\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"seq_len\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" seq_len\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,e.jsx)(a.span,{className:\\"code-line\\",children:`\\n`}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[(0,e.jsx)(a.span,{className:\\"token comment\\",children:\\"# Apply the mask using torch.where\\"}),`\\n`]}),(0,e.jsxs)(a.span,{className:\\"code-line\\",children:[\\"masked_attention_scores \\",(0,e.jsx)(a.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"where\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"upper_triangular_mask\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\".\\"}),(0,e.jsx)(a.span,{className:\\"token builtin\\",children:\\"bool\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,e.jsx)(a.span,{className:\\"token builtin\\",children:\\"float\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"token string\\",children:\\"\'-inf\'\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" attention_scores\\",(0,e.jsx)(a.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,e.jsx)(a.span,{className:\\"code-line\\",children:`\\n`})]})}),(0,e.jsxs)(a.p,{children:[\\"Instead of directly multiplying the attention matrices by this mask, we modify the attention mechanism by setting specific attention values to negative infinity (\\",(0,e.jsx)(a.code,{children:\\"-inf\\"}),\\").\\"]}),(0,e.jsxs)(a.p,{children:[\\"Given the output of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.mfrac,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"\\\\u22A4\\"})]})]}),(0,e.jsx)(a.msqrt,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]})})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\frac{QK^\\\\\\\\top}{\\\\\\\\sqrt{d_{\\\\\\\\text{model}}}}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.633em\\",verticalAlign:\\"-.538em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mopen nulldelimiter\\"}),(0,e.jsx)(a.span,{className:\\"mfrac\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\"1.095em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.5864em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight sqrt\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8622em\\"},children:[(0,e.jsxs)(a.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mtight\\",style:{paddingLeft:\\".833em\\"},children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.3488em\\",marginLeft:\\"0\\",marginRight:\\".0714em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1512em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-2.8222em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,e.jsx)(a.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,e.jsx)(a.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1778em\\"},children:(0,e.jsx)(a.span,{})})})]})})})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.23em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.4461em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"Q\\"}),(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".927em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.931em\\",marginRight:\\".0714em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"\\\\u22A4\\"})})]})})})})})]})]})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".538em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mclose nulldelimiter\\"})]})]})})]}),\\", which is of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, seq\\\\\\\\_len)\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", we set attention values \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"a\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"j\\"})]})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"attention_{i,j}\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".9456em\\",verticalAlign:\\"-.2861em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"a\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"tt\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"o\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})]})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]}),\\" where \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"m\\"}),(0,e.jsx)(a.mi,{children:\\"a\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"k\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"j\\"})]})]}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mn,{children:\\"1\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"mask_{i,j} == 1 \\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".9805em\\",verticalAlign:\\"-.2861em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"ma\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"s\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0315em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})]})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"==\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"1\\"})]})]})]}),\\" to \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"a\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"j\\"})]})]}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mo,{children:\\"\\\\u2212\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"\\\\u221E\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"attention_{i,j} = -\\\\\\\\infty \\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".9456em\\",verticalAlign:\\"-.2861em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"a\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"tt\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"o\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsxs)(a.span,{className:\\"mord mtight\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mtight mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})]})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6667em\\",verticalAlign:\\"-.0833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"\\\\u2212\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"\\\\u221E\\"})]})]})]}),\\". This ensures that, when we apply the softmax function, these masked values are transformed to \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"0\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"0\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"0\\"})]})})]}),\\", while the other attention weights in each row still sum to \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mn,{children:\\"1\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"1\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"1\\"})]})})]}),\\".\\"]}),(0,e.jsxs)(a.h3,{className:\\"content-header\\",id:\\"multi-head-attention\\",children:[(0,e.jsx)(a.a,{href:\\"#multi-head-attention\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Multi-Head Attention\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now that we have an understanding of the self-attention mechanism, let\\\\u2019s add an important detail: \\",(0,e.jsx)(a.strong,{children:\\"Multi-Head Attention\\"}),\\". So far, we\\\\u2019ve only described something akin to single-head self-attention. In \\",(0,e.jsx)(a.strong,{children:\\"Multi-Head Attention\\"}),\\", we split the embedding dimension into \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"h\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"h\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"h\\"})]})})]}),\\" parts, with each part becoming one of the attention heads.\\"]}),(0,e.jsxs)(a.p,{children:[\\"This means that our input matrix, originally of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", is transformed into a matrix of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"h\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mi,{children:\\"k\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(h, seq\\\\\\\\_len, d_k)\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"h\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", where:\\"]}),(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mi,{children:\\"k\\"})]}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsxs)(a.mfrac,{children:[(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mi,{children:\\"h\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"d_k = \\\\\\\\frac{d_{\\\\\\\\text{model}}}{h}\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8444em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"2.0574em\\",verticalAlign:\\"-.686em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mopen nulldelimiter\\"}),(0,e.jsx)(a.span,{className:\\"mfrac\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\"1.3714em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.314em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"h\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.23em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.677em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".686em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mclose nulldelimiter\\"})]})]})]})]})}),(0,e.jsxs)(a.p,{children:[\\"Each of these heads independently performs self-attention. For every head, we use separate learnable projection matrices \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"Q\\"})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"W^Q\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8413em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8413em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"Q\\"})})]})})})})})]})]})})]}),\\", \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"W^K\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8413em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8413em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})})]})})})})})]})]})})]}),\\", and \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"W^V\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8413em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8413em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})})]})})})})})]})]})})]}),\\". This allows each head to focus on different parts of the sequence or capture different relationships within the data.\\"]}),(0,e.jsxs)(\\"figure\\",{style:{width:\\"100%\\",margin:\\"auto\\",paddingLeft:\\"0%\\"},children:[(0,e.jsx)(\\"img\\",{id:\\"head\\",src:\\"/static/images/blog/transformers00/head.png\\",alt:\\"Description of the image\\",style:{width:\\"100%\\",height:\\"auto\\"}}),(0,e.jsx)(\\"figcaption\\",{style:{textAlign:\\"center\\",fontSize:\\"0.9rem\\",color:\\"#666\\"},children:(0,e.jsx)(\\"a\\",{href:\\"https://ai.stackexchange.com/questions/45329/how-the-q-k-v-be-calculated-in-multi-head-attention\\",target:\\"_blank\\",rel:\\"noopener noreferrer\\",children:(0,e.jsxs)(a.p,{children:[\\"Image source\\",\\" \\"]})})})]}),(0,e.jsxs)(a.p,{children:[\\"After performing self-attention for all \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"h\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"h\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6944em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"h\\"})]})})]}),\\" heads, their outputs are concatenated back together, resulting in a matrix of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(seq\\\\\\\\_len, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\". Finally, this concatenated matrix is projected back to the original embedding dimension using a final learnable matrix \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"O\\"})]})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"W_O\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8333em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3283em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".02778em\\"},children:\\"O\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})})]}),\\", which is of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(d_{\\\\\\\\text{model}}, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\". This can be summarized as follows:\\"]}),(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mtext,{children:\\"MultiHead\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mtext,{children:\\"Concat\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"head\\"}),(0,e.jsx)(a.mn,{children:\\"1\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"head\\"}),(0,e.jsx)(a.mn,{children:\\"2\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mo,{children:\\"\\\\u2026\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"head\\"}),(0,e.jsx)(a.mi,{children:\\"h\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"O\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{MultiHead}(Q, K, V) = \\\\\\\\text{Concat}(\\\\\\\\text{head}_1, \\\\\\\\text{head}_2, \\\\\\\\dots, \\\\\\\\text{head}_h)W^O\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"MultiHead\\"})}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.1413em\\",verticalAlign:\\"-.25em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"Concat\\"})}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"1\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"minner\\",children:\\"\\\\u2026\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"h\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8913em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".02778em\\"},children:\\"O\\"})})]})})})})})]})]})]})]})}),\\" \\",(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"where\\\\xA0head\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"})]}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mtext,{children:\\"Attention\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"X\\"}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"Q\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"X\\"}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"X\\"}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mtext,{children:\\"Softmax\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\"(\\"}),(0,e.jsxs)(a.mfrac,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"})]}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"\\\\u22A4\\"})]})]}),(0,e.jsx)(a.msqrt,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mi,{children:\\"k\\"})]})})]}),(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\")\\"})]}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"V\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{where head}_i = \\\\\\\\text{Attention}(XW^Q_i, XW^K_i, XW^V_i) = \\\\\\\\text{Softmax}\\\\\\\\left(\\\\\\\\frac{Q_iK_i^\\\\\\\\top}{\\\\\\\\sqrt{d_k}}\\\\\\\\right)V_i\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8444em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"where\\\\xA0head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.2361em\\",verticalAlign:\\"-.2769em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"Attention\\"})}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".9592em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.4231em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.1809em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"Q\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2769em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8913em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.453em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".247em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07847em\\"},children:\\"X\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8913em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.453em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".247em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"2.4761em\\",verticalAlign:\\"-.95em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"Softmax\\"})}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"minner\\",children:[(0,e.jsx)(a.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"size3 delimsizing\\",children:\\"(\\"})}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mopen nulldelimiter\\"}),(0,e.jsx)(a.span,{className:\\"mfrac\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\"1.5261em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.2528em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord sqrt\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8572em\\"},children:[(0,e.jsxs)(a.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{paddingLeft:\\".833em\\"},children:(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-2.8172em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,e.jsx)(a.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,e.jsx)(a.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1828em\\"},children:(0,e.jsx)(a.span,{})})})]})})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.23em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.677em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8491em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.4413em\\",marginLeft:\\"-.0715em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"\\\\u22A4\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2587em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".93em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mclose nulldelimiter\\"})]}),(0,e.jsx)(a.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"size3 delimsizing\\",children:\\")\\"})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.2222em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})]})]})}),(0,e.jsxs)(a.p,{children:[\\"After this layer, we apply a skip connection and normalization, just as we did before. The outputs are then fed into the next attention layer, which lies at the heart of the model. As this layer is where the decoder integrates the outputs of the encoder it is therefore called the \\",(0,e.jsx)(a.strong,{children:\\"cross-attention layer\\"}),\\".\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"cross-attention\\",children:[(0,e.jsx)(a.a,{href:\\"#cross-attention\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Cross Attention\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now the \\",(0,e.jsx)(a.strong,{children:\\"cross-attention\\"}),\\" layer is where the decoder integrates the outputs of the encoder. Instead of performing self-attention solely on the target sequence, the decoder uses the encoder\'s outputs as the \\",(0,e.jsx)(a.strong,{children:\\"keys\\"}),\\" and \\",(0,e.jsx)(a.strong,{children:\\"values\\"}),\\" while the decoder\'s outputs from the previous layer serve as the \\",(0,e.jsx)(a.strong,{children:\\"queries\\"}),\\". The primary goal of the cross-attention layer is to allow the decoder to focus on relevant parts of the input sequence (processed by the encoder) when generating each token of the output sequence.\\"]}),(0,e.jsxs)(\\"figure\\",{style:{width:\\"100%\\",margin:\\"auto\\",paddingLeft:\\"0%\\"},children:[(0,e.jsx)(\\"img\\",{id:\\"cross\\",src:\\"/static/images/blog/transformers00/cross.png\\",alt:\\"Description of the image\\",style:{width:\\"100%\\",height:\\"auto\\"}}),(0,e.jsx)(\\"figcaption\\",{style:{textAlign:\\"center\\",fontSize:\\"0.9rem\\",color:\\"#666\\"},children:(0,e.jsx)(\\"a\\",{href:\\"https://toloka.ai/blog/transformer-architecture/\\",target:\\"_blank\\",rel:\\"noopener noreferrer\\",children:(0,e.jsxs)(a.p,{children:[\\"Image source\\",\\" \\"]})})})]}),(0,e.jsxs)(a.p,{children:[\\"Therefore, in the \\",(0,e.jsx)(a.strong,{children:\\"cross-attention layer\\"}),\\", we use the target embeddings as the \\",(0,e.jsx)(a.strong,{children:\\"queries\\"}),\\", which attend to the source sequence embeddings (the \\",(0,e.jsx)(a.strong,{children:\\"keys\\"}),\\"). The attention mechanism computes the alignment between the source and target sequences. Using the calculated attention weights, we multiply this matrix by the \\",(0,e.jsx)(a.strong,{children:\\"values\\"}),\\" (i.e., the outputs of the encoder). Again, formulating this mathematically and with the target embeddings \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"T\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"T\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"T\\"})]})})]}),\\" and encoder ouput \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"S\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"S\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05764em\\"},children:\\"S\\"})]})})]}),\\", we get\\"]}),(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mtext,{children:\\"MultiHead\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mtext,{children:\\"Concat\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"head\\"}),(0,e.jsx)(a.mn,{children:\\"1\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"head\\"}),(0,e.jsx)(a.mn,{children:\\"2\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mo,{children:\\"\\\\u2026\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"head\\"}),(0,e.jsx)(a.mi,{children:\\"h\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,e.jsxs)(a.msup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"O\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{MultiHead}(Q, K, V) = \\\\\\\\text{Concat}(\\\\\\\\text{head}_1, \\\\\\\\text{head}_2, \\\\\\\\dots, \\\\\\\\text{head}_h)W^O\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"MultiHead\\"})}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.1413em\\",verticalAlign:\\"-.25em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"Concat\\"})}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"1\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3011em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"2\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"minner\\",children:\\"\\\\u2026\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"h\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsx)(a.span,{className:\\"vlist-t\\",children:(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".8913em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".02778em\\"},children:\\"O\\"})})]})})})})})]})]})]})]})}),\\" \\",(0,e.jsx)(a.span,{className:\\"katex-display\\",children:(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mtext,{children:\\"where\\\\xA0head\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"})]}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mtext,{children:\\"Attention\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"T\\"}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"Q\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"S\\"}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"K\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"S\\"}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"W\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"V\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,e.jsx)(a.mo,{children:\\"=\\"}),(0,e.jsx)(a.mtext,{children:\\"Softmax\\"}),(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\"(\\"}),(0,e.jsxs)(a.mfrac,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"Q\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"})]}),(0,e.jsxs)(a.msubsup,{children:[(0,e.jsx)(a.mi,{children:\\"K\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"\\\\u22A4\\"})]})]}),(0,e.jsx)(a.msqrt,{children:(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mi,{children:\\"k\\"})]})})]}),(0,e.jsx)(a.mo,{fence:\\"true\\",children:\\")\\"})]}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"V\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"})]})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{where head}_i = \\\\\\\\text{Attention}(TW^Q_i, SW^K_i, SW^V_i) = \\\\\\\\text{Softmax}\\\\\\\\left(\\\\\\\\frac{Q_iK_i^\\\\\\\\top}{\\\\\\\\sqrt{d_k}}\\\\\\\\right)V_i\\"})]})})}),(0,e.jsxs)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".8444em\\",verticalAlign:\\"-.15em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"where\\\\xA0head\\"})}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.2361em\\",verticalAlign:\\"-.2769em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"Attention\\"})}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"T\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".9592em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.4231em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.1809em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"Q\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2769em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05764em\\"},children:\\"S\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8913em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.453em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".247em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05764em\\"},children:\\"S\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"W\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8913em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.453em\\",marginLeft:\\"-.1389em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".247em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,e.jsx)(a.span,{className:\\"mrel\\",children:\\"=\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"2.4761em\\",verticalAlign:\\"-.95em\\"}}),(0,e.jsx)(a.span,{className:\\"mord text\\",children:(0,e.jsx)(a.span,{className:\\"mord\\",children:\\"Softmax\\"})}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"minner\\",children:[(0,e.jsx)(a.span,{className:\\"mopen delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"size3 delimsizing\\",children:\\"(\\"})}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mopen nulldelimiter\\"}),(0,e.jsx)(a.span,{className:\\"mfrac\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\"1.5261em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.2528em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",children:(0,e.jsx)(a.span,{className:\\"mord sqrt\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8572em\\"},children:[(0,e.jsxs)(a.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{paddingLeft:\\".833em\\"},children:(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-2.8172em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,e.jsx)(a.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,e.jsx)(a.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".1828em\\"},children:(0,e.jsx)(a.span,{})})})]})})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.23em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsx)(a.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.677em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"Q\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist\\",style:{height:\\".8491em\\"},children:[(0,e.jsxs)(a.span,{style:{top:\\"-2.4413em\\",marginLeft:\\"-.0715em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]}),(0,e.jsxs)(a.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"\\\\u22A4\\"})})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".2587em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})]})]}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".93em\\"},children:(0,e.jsx)(a.span,{})})})]})}),(0,e.jsx)(a.span,{className:\\"mclose nulldelimiter\\"})]}),(0,e.jsx)(a.span,{className:\\"mclose delimcenter\\",style:{top:\\"0\\"},children:(0,e.jsx)(a.span,{className:\\"size3 delimsizing\\",children:\\")\\"})})]}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.2222em\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mathnormal mtight\\",children:\\"i\\"})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]})]})]})]})}),(0,e.jsxs)(a.p,{children:[\\"This operation accumulates information from the encoder, weighted by how much each target token attends to different parts of the source sequence. As usual, after this layer, we add the inputs of the layer to its output as a \\",(0,e.jsx)(a.strong,{children:\\"skip connection\\"}),\\". Following this, we apply \\",(0,e.jsx)(a.strong,{children:\\"normalization\\"}),\\" to the result.\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"end-of-the-decoder\\",children:[(0,e.jsx)(a.a,{href:\\"#end-of-the-decoder\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"End of the Decoder\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now, before reaching the end of the decoder block, we pass the current values through another \\",(0,e.jsx)(a.strong,{children:\\"feed-forward network (FFN)\\"}),\\". As with previous layers, we add the input of the FFN to its output via a \\",(0,e.jsx)(a.strong,{children:\\"skip connection\\"}),\\" and apply \\",(0,e.jsx)(a.strong,{children:\\"normalization\\"}),\\" to the result. This marks the conclusion of a single decoder block. In practice, we stack multiple decoder blocks in sequence, with each block refining the outputs of the previous one, enabling the model to better capture complex relationships within the data.\\"]}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"final-prediction\\",children:[(0,e.jsx)(a.a,{href:\\"#final-prediction\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Final prediction\\"]}),(0,e.jsxs)(a.p,{children:[\\"Now that we have the outputs of the decoder, we need to map them to \\",(0,e.jsx)(a.strong,{children:\\"probabilities\\"}),\\" over our vocabulary of tokens. Given the input:\\"]}),(0,e.jsxs)(a.ul,{children:[(0,e.jsxs)(a.li,{children:[(0,e.jsx)(a.strong,{children:\\"Source sentence (in English)\\"}),\\": \\",(0,e.jsx)(a.code,{children:\\"src = [976, 6446, 48704, 1072, 290, 8851, 42166, 13]\\"})]}),(0,e.jsxs)(a.li,{children:[(0,e.jsx)(a.strong,{children:\\"Target sentence (in German)\\"}),\\": \\",(0,e.jsx)(a.code,{children:\\"trg = [0, 12, 4433, 2304, 8872, 2240, 456, 2349, 13]\\"})]})]}),(0,e.jsxs)(a.p,{children:[\\"We aim to predict the next token for each position in the target sequence. This means our \\",(0,e.jsx)(a.strong,{children:\\"ground truth\\"}),\\" will be: \\",(0,e.jsx)(a.code,{children:\\"ground_truth = [12, 4433, 2304, 8872, 2240, 456, 2349, 13, 99999]\\"}),\\", where \\",(0,e.jsx)(a.code,{children:\\"99999\\"}),\\" represents the \\",(0,e.jsx)(a.code,{children:\\"<END>\\"}),\\" token.\\"]}),(0,e.jsxs)(a.p,{children:[\\"The output of the decoder has a shape of \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"a\\"}),(0,e.jsx)(a.mi,{children:\\"r\\"}),(0,e.jsx)(a.mi,{children:\\"g\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(target\\\\\\\\_seq\\\\\\\\_len, d_{\\\\\\\\text{model}})\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"a\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".02778em\\"},children:\\"r\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"g\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", which contains the contextualized embeddings of each token. However, to generate probabilities over the vocabulary, we need to map these outputs to a new shape: \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{children:\\"a\\"}),(0,e.jsx)(a.mi,{children:\\"r\\"}),(0,e.jsx)(a.mi,{children:\\"g\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"t\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"q\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"l\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mi,{children:\\"n\\"}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"v\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"c\\"}),(0,e.jsx)(a.mi,{children:\\"a\\"}),(0,e.jsx)(a.mi,{children:\\"b\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"z\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(target\\\\\\\\_seq\\\\\\\\_len, vocab\\\\\\\\_size)\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"a\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".02778em\\"},children:\\"r\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"g\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"v\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"oc\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"ab\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"s\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"ze\\"}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\".\\"]}),(0,e.jsxs)(a.p,{children:[\\"This is achieved by applying a \\",(0,e.jsx)(a.strong,{children:\\"linear projection\\"}),\\" (a dense layer) that transforms the decoder outputs into the vocabulary space. The \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"i\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\"-th entry of this transformed output will contain the probabilities over all tokens in the vocabulary, representing the likelihood of each token being the \\",(0,e.jsx)(a.strong,{children:\\"next token\\"}),\\" after token \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsx)(a.mrow,{children:(0,e.jsx)(a.mi,{children:\\"i\\"})}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"i\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\".6595em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"})]})})]}),\\".\\"]}),(0,e.jsxs)(a.h3,{className:\\"content-header\\",id:\\"steps\\",children:[(0,e.jsx)(a.a,{href:\\"#steps\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Steps:\\"]}),(0,e.jsxs)(a.ol,{children:[(0,e.jsxs)(a.li,{children:[(0,e.jsx)(a.strong,{children:\\"Linear Layer\\"}),\\": The decoder output is passed through a dense layer with weights of shape \\",(0,e.jsxs)(a.span,{className:\\"katex\\",children:[(0,e.jsx)(a.span,{className:\\"katex-mathml\\",children:(0,e.jsx)(a.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,e.jsxs)(a.semantics,{children:[(0,e.jsxs)(a.mrow,{children:[(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,e.jsxs)(a.msub,{children:[(0,e.jsx)(a.mi,{children:\\"d\\"}),(0,e.jsx)(a.mtext,{children:\\"model\\"})]}),(0,e.jsx)(a.mo,{separator:\\"true\\",children:\\",\\"}),(0,e.jsx)(a.mi,{children:\\"v\\"}),(0,e.jsx)(a.mi,{children:\\"o\\"}),(0,e.jsx)(a.mi,{children:\\"c\\"}),(0,e.jsx)(a.mi,{children:\\"a\\"}),(0,e.jsx)(a.mi,{children:\\"b\\"}),(0,e.jsx)(a.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,e.jsx)(a.mi,{children:\\"s\\"}),(0,e.jsx)(a.mi,{children:\\"i\\"}),(0,e.jsx)(a.mi,{children:\\"z\\"}),(0,e.jsx)(a.mi,{children:\\"e\\"}),(0,e.jsx)(a.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,e.jsx)(a.annotation,{encoding:\\"application/x-tex\\",children:\\"(d_{\\\\\\\\text{model}}, vocab\\\\\\\\_size)\\"})]})})}),(0,e.jsx)(a.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,e.jsxs)(a.span,{className:\\"base\\",children:[(0,e.jsx)(a.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,e.jsx)(a.span,{className:\\"mopen\\",children:\\"(\\"}),(0,e.jsxs)(a.span,{className:\\"mord\\",children:[(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,e.jsx)(a.span,{className:\\"msupsub\\",children:(0,e.jsxs)(a.span,{className:\\"vlist-t vlist-t2\\",children:[(0,e.jsxs)(a.span,{className:\\"vlist-r\\",children:[(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,e.jsxs)(a.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,e.jsx)(a.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,e.jsx)(a.span,{className:\\"mtight size3 sizing reset-size6\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight text\\",children:(0,e.jsx)(a.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,e.jsx)(a.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,e.jsx)(a.span,{className:\\"vlist-r\\",children:(0,e.jsx)(a.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,e.jsx)(a.span,{})})})]})})]}),(0,e.jsx)(a.span,{className:\\"mpunct\\",children:\\",\\"}),(0,e.jsx)(a.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"v\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"oc\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"ab\\"}),(0,e.jsx)(a.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"s\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"i\\"}),(0,e.jsx)(a.span,{className:\\"mord mathnormal\\",children:\\"ze\\"}),(0,e.jsx)(a.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\" to project each token embedding into the vocabulary space.\\"]}),(0,e.jsxs)(a.li,{children:[(0,e.jsx)(a.strong,{children:\\"Softmax\\"}),\\": A softmax operation is applied to the output of the linear layer to compute the probabilities for each token in the vocabulary.\\"]})]}),(0,e.jsx)(a.p,{children:\\"This final output provides a distribution over the vocabulary for each position in the target sequence, enabling the model to predict the next token at each step.\\"}),(0,e.jsxs)(a.h2,{className:\\"content-header\\",id:\\"next-up\\",children:[(0,e.jsx)(a.a,{href:\\"#next-up\\",\\"aria-hidden\\":\\"true\\",tabIndex:\\"-1\\",children:(0,e.jsx)(e.Fragment,{children:(0,e.jsx)(a.span,{className:\\"content-header-link\\",children:(0,e.jsxs)(a.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,e.jsx)(a.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,e.jsx)(a.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Next up\\"]}),(0,e.jsx)(a.p,{children:\\"Now that we understand how a Transformer works internally, in the next post, we will implement one from scratch. There, we will focus on building a translation model, applying the concepts we\'ve explored to transform a source sentence into its corresponding target sentence.\\"})]})}function d(s={}){let{wrapper:a}=s.components||{};return a?(0,e.jsx)(a,{...s,children:(0,e.jsx)(h,{...s})}):h(s)}return x(f);})();\\n;return Component;"},"_id":"blog/transfromer-00.mdx","_raw":{"sourceFilePath":"blog/transfromer-00.mdx","sourceFileName":"transfromer-00.mdx","sourceFileDir":"blog","contentType":"mdx","flattenedPath":"blog/transfromer-00"},"type":"Blog","readingTime":{"text":"21 min read","minutes":20.605,"time":1236300,"words":4121},"slug":"transfromer-00","path":"blog/transfromer-00","filePath":"blog/transfromer-00.mdx","toc":[{"value":"Architecture Overview","url":"#architecture-overview","depth":2},{"value":"Tokenization & Embedding","url":"#tokenization--embedding","depth":2},{"value":"Positional encoding","url":"#positional-encoding","depth":2},{"value":"Encoder","url":"#encoder-1","depth":1},{"value":"Self-Attention","url":"#self-attention","depth":2},{"value":"Skip connections & Normalization","url":"#skip-connections--normalization","depth":2},{"value":"FFN","url":"#ffn","depth":2},{"value":"Decoder","url":"#decoder-1","depth":1},{"value":"Masked Multi-Head Attention","url":"#masked-multi-head-attention","depth":2},{"value":"Masking","url":"#masking","depth":3},{"value":"Multi-Head Attention","url":"#multi-head-attention-1","depth":3},{"value":"Cross Attention","url":"#cross-attention","depth":2},{"value":"End of the Decoder","url":"#end-of-the-decoder","depth":2},{"value":"Final prediction","url":"#final-prediction","depth":2},{"value":"Steps:","url":"#steps","depth":3},{"value":"Next up","url":"#next-up","depth":2}],"structuredData":{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introduction to Transformers - Part 00 - Architecture","datePublished":"2024-08-21T00:00:00.000Z","dateModified":"2024-08-21T00:00:00.000Z","description":"A short introduction to the architecture behind transformers how they can be utilized in NLP tasks.","image":"/static/images/twitter-card.png","url":"https://janhardtke.com/blog/transfromer-00"}},{"title":"Introduction to Transformers - Part 01 - Implementation of a translation model","date":"2024-10-13T00:00:00.000Z","tags":["transformer","nlp","code"],"draft":false,"summary":"A full implementation of the Transformer architecture in PyTorch, built entirely from scratch, designed specifically for use in a translation model.","body":{"raw":"\\n### Introduction\\n\\nIn the previous post, we explored the inner workings of the Transformer architecture, dissecting its components and understanding how it forms the backbone of state-of-the-art models like BERT, GPT, and T5. Now, it\'s time to turn theory into practice.\\n\\nIn this post, we will implement a full Transformer model from scratch in **PyTorch** and apply it to a **translation task**. Specifically, we will use the **WMT14 English-German (en-de)** dataset, a benchmark dataset widely used for machine translation tasks.\\n\\n### Dataset Preparation and Preprocessing\\n\\nTo train our Transformer model, we need a dataset and a way to preprocess it into a format suitable for the model.\\nIn this example, we use the **WMT14 English-German (en-de)** dataset from the Hugging Face `datasets` library.\\nThis dataset is a common benchmark for machine translation tasks.\\n\\n---\\n\\n#### Loading the Dataset\\n\\n```python\\nfrom transformers import AutoTokenizer\\nfrom torch.utils.data import DataLoader\\nfrom datasets import load_dataset\\n\\ndataset = load_dataset(\\"wmt14\\", \\"de-en\\")\\n\\ndataset[\'train\'] = dataset[\'train\'].select(range(10000))\\ndataset[\'test\'] = dataset[\'test\'].select(range(1000))\\ndataset[\'validation\'] = dataset[\'validation\'].select(range(1000))\\n\\ndataset[\'train\'] = dataset[\'train\'].select(range(10000))\\ndataset[\'test\'] = dataset[\'test\'].select(range(1000))\\ndataset[\'validation\'] = dataset[\'validation\'].select(range(1000))\\n```\\n\\nThe dataset contains parallel sentences in German (de) and English (en), ideal for a translation model.\\n\\n#### Initializing the Tokenizer\\n\\n```python\\nfrom transformers import AutoTokenizer\\n\\ntokenizer = AutoTokenizer.from_pretrained(\\"bert-base-cased\\")\\nsrc_seq_len = 128\\ntrg_seq_len = 128\\nbatch_size = 256\\n\\ndef preprocess_function(examples):\\n    inputs = [item[\\"de\\"] for item in examples[\\"translation\\"]]\\n    targets = [item[\\"en\\"] for item in examples[\\"translation\\"]]\\n    labels = [item[\\"en\\"] for item in examples[\\"translation\\"]]\\n\\n    model_inputs = tokenizer(\\n        inputs,\\n        padding=\\"max_length\\",\\n        truncation=True,\\n        max_length=src_seq_len,\\n        add_special_tokens=False\\n    )\\n    model_inputs[\'src_mask\'] = model_inputs[\\"attention_mask\\"]\\n\\n    with tokenizer.as_target_tokenizer():\\n        targets = tokenizer(\\n            targets,\\n            padding=\\"max_length\\",\\n            truncation=True,\\n            max_length=trg_seq_len,\\n            add_special_tokens=True\\n        )\\n        labels = tokenizer(\\n            labels,\\n            padding=\\"max_length\\",\\n            truncation=True,\\n            max_length=trg_seq_len,\\n            add_special_tokens=True\\n        )\\n\\n    model_inputs[\\"target\\"] = targets[\\"input_ids\\"]\\n    model_inputs[\\"target_mask\\"] = targets[\\"attention_mask\\"]\\n    model_inputs[\\"labels\\"] = labels[\\"input_ids\\"]\\n\\n    return model_inputs\\n```\\n\\n#### Tokenization\\n\\nThe `AutoTokenizer` from Hugging Face is initialized with the `bert-base-cased` model. This tokenizer is used to tokenize both the source (German) and target (English) sentences in the dataset. The tokenization process involves splitting the text into smaller units (tokens) and mapping them to numerical IDs that the model can process.\\n\\n---\\n\\n#### Handling Input and Output Sequences\\n\\nThe preprocessing function performs the following key steps:\\n\\n1. **Extracting Text Data**:\\n\\n   - German sentences are extracted as inputs (source sequences).\\n   - English sentences are extracted as targets (**decoder** inputs) and labels (ground truth for loss computation).\\n\\n2. **Tokenizing Source Sequences**:\\n\\n   - German sentences are tokenized and padded or truncated to a fixed length defined by `src_seq_len` (128 tokens in this case).\\n   - Special tokens like `<START>` and `<END>` are not added for source sequences, as they are only required for the **decoder**.\\n\\n3. **Creating a Source Mask**:\\n\\n   - The tokenizer generates an attention mask (`src_mask`) for the source sequences. This mask indicates valid tokens (1) and padded tokens (0), which the model uses to ignore padding during computations.\\n     This (`src_mask`) will be used in the attention layers of the **encoder**, such that real tokens won\'t attend to padding tokens.\\n\\n4. **Tokenizing Target Sequences**:\\n\\n   - English sentences are tokenized twice:\\n     - **Targets**: Used as input to the **decoder** during training. Special tokens like `<START>` and `<END>` are added.\\n     - **Labels**: Used for loss computation. These represent the expected output tokens for the **decoder**.\\n\\n5. **Creating a Target Mask**:\\n\\n   - The tokenizer generates an attention mask (`target_mask`) for the target sequences, similar to the source mask, to handle padding effectively.\\n     Here the (`target_mask`) serves the same purpose as the (`src_mask`) in the **decoder**, it will be used in the attention layers of the **decoder**, to mask out padding tokens.\\n\\n## The Translation Model\\n\\nBelow, we describe the translation model, which builds upon the core principles of the Transformer architecture.\\nThis model incorporates the fundamental components of the Transformer while effectively handling **padding** and the **causal mask** required for cross-attention.\\nThe architecture processes the input sequences by first preparing them with appropriate masks and then passing them through the **encoder** and **decoder** components.\\n\\n```python\\nclass TranslationModel(nn.Module):\\n  def __init__(self,vocab_size,d_model,src_seq_len,trg_seq_len):\\n    super(TranslationModel, self).__init__()\\n    self.src_seq_len = src_seq_len\\n    self.trg_seq_len = trg_seq_len\\n\\n    self.encoder = Encoder(d_model=d_model,)\\n    self.decoder = Decoder(d_model=d_model,)\\n\\n    self.embedding_src = nn.Embedding(vocab_size,d_model)\\n    self.embedding_tgt = nn.Embedding(vocab_size,d_model)\\n\\n    self.positional_encoding_src = nn.Embedding(src_seq_len,d_model)\\n    self.positional_encoding_tgt = nn.Embedding(trg_seq_len,d_model)\\n\\n    self.src_pos = torch.arange(0,src_seq_len).unsqueeze(0).to(device)\\n    self.trg_pos = torch.arange(0,trg_seq_len).unsqueeze(0).to(device)\\n\\n    self.ffn = nn.Linear(d_model,vocab_size)\\n\\n  def forward(self,src,tgt,src_padding_mask,tgt_padding_mask):\\n\\n    src_padding_mask = src_padding_mask.unsqueeze(1).repeat(1, self.src_seq_len, 1)\\n    tgt_padding_mask = tgt_padding_mask.unsqueeze(1).repeat(1, self.trg_seq_len, 1)\\n    tgt_causal_mask = torch.tril(torch.ones_like(tgt_padding_mask)).to(device)\\n\\n    src_embed = self.embedding_src(src) + self.positional_encoding_src(self.src_pos)\\n    tgt_embed = self.embedding_tgt(tgt) + self.positional_encoding_tgt(self.trg_pos)\\n\\n    enc_out = self.encoder(src_embed,src_padding_mask)\\n    dec_out = self.decoder(tgt = tgt_embed,\\n                           memory=enc_out,\\n                           tgt_padding_mask = tgt_padding_mask,\\n                           tgt_causal_mask = tgt_causal_mask,\\n                           memory_padding_mask = src_padding_mask)\\n\\n    return self.ffn(dec_out)\\n```\\n\\nAs you can see, the first step in the model\'s design is the initialization of **embedding layers**, which hold the embeddings for the tokenized sequences.\\nThese embeddings represent each token as a dense vector in a high-dimensional space, providing the model with a numerical representation of the input.\\n\\nIn addition to the token embeddings, the model initializes two embedding layers for **positional encoding**.\\nUnlike the fixed sinusoidal encoding discussed in the previous post, this implementation uses **learnable positional encodings**.\\nThis approach is more flexible, allowing the model to adapt the positional information to the specific dataset and task during training.\\nEmpirical evidence shows that learnable positional encodings often lead to better performance compared to fixed encodings.\\n\\nIn the `_forward_` method, three masks are created to handle the input sequences. The `src_padding_mask` ensures the encoder ignores padding tokens in the source sequence. Similarly, the `tgt_padding_mask` prevents the decoder from processing padding tokens in the target sequence.\\nThe `tgt_causal_mask` enforces causality in the decoder, ensuring tokens only attend to earlier tokens during prediction.\\n\\n```python\\n  src_padding_mask = src_padding_mask.unsqueeze(1).repeat(1, self.src_seq_len, 1)\\n  tgt_padding_mask = tgt_padding_mask.unsqueeze(1).repeat(1, self.trg_seq_len, 1)\\n  tgt_causal_mask = torch.tril(torch.ones_like(tgt_padding_mask)).to(device)\\n```\\n\\nWhat we do here is transform the **src_padding_mask** and **tgt_padding_mask** from 1D arrays into **matrix masks**. Since the tokenizer only creates 1D arrays, we need to expand them into a matrix form to use them effectively in the attention layer. This transformation is achieved by stacking each 1D array `self.src_seq_len` times, ensuring that padding tokens are ignored during attention calculations.\\nThe same process is applied to the **tgt_padding_mask**.\\nFor the **cross-attention layer**, we generate the **causal mask**. This mask enforces causality by ensuring that tokens can only attend to themselves or tokens that came before them.\\n\\nAfter preparing the masks, we proceed to retrieve the embeddings for both the source and target sequences.\\nThese embeddings are combined with positional encodings to inject positional information into the token representations. This step ensures the model understands the order of tokens within the sequences.\\nOnce the source embeddings are ready, they are passed into the **encoder**, where the input sequence is processed and contextualized. The output of the encoder is then used as input to the **decoder**, which generates the output sequence.\\nWith this general understanding, we will now take a closer look at the architecture of the **encoder**.\\n\\n## Encoder\\n\\nBelow is the architecture of the **Encoder**, which is composed of multiple **EncoderBlocks**. The **Encoder** class itself is straightforward—it initializes $$n$$ **EncoderBlocks** and feeds the output of one block into the next in sequence.\\n\\n```python\\nclass EncoderBlock(nn.Module):\\n  def __init__(self,d_model=256,heads=4,hidden=1024,dropout=0.1):\\n    super(EncoderBlock, self).__init__()\\n    self.multi_head_attention = MultiHeadAttention(heads=heads,d_model=d_model)\\n    self.norm1 = nn.LayerNorm(d_model)\\n    self.norm2 = nn.LayerNorm(d_model)\\n    self.mlp = nn.Sequential(nn.Linear(d_model,hidden),\\n                             nn.GELU(),\\n                             nn.Linear(hidden,d_model,\\n                             nn.Dropout(dropout)\\n                             ))\\n\\n  def forward(self,src,mask):\\n    att_output = self.multi_head_attention(src,src,src,mask)\\n    skip_con = att_output + src\\n    norm_output = self.norm1(skip_con)\\n    mlp_out = self.mlp(norm_output)\\n    return self.norm2(mlp_out + norm_output)\\n\\n\\nclass Encoder(nn.Module):\\n  def __init__(self,num_layers=6,d_model=256,heads=4,hidden=1024):\\n      super(Encoder, self).__init__()\\n      self.layers = nn.ModuleList([EncoderBlock(d_model=d_model,heads=heads,hidden=hidden) for i in range(num_layers)])\\n\\n  def forward(self,src,mask):\\n    for layer in self.layers:\\n      src = layer(src,mask)\\n    return src\\n```\\n\\nThe interesting part of the encoder lies in the **EncoderBlock**. Here, the source sequence is passed as **Queries**, **Keys**, and **Values** into the **MultiHeadAttention** block.\\nAdditionally, we pass the **src_padding_mask** to ensure that padding tokens are ignored during attention calculations.\\nAfter computing the output of the **MultiHeadAttention** block, a **skip connection** is applied by adding the input back to the output.\\nThis result is then normalized using a **LayerNorm** to improve training stability.\\nNext, the output is passed through a simple **Feed-Forward Network (FFN)**, which includes another skip connection and a **Dropout** layer for regularization.\\n\\n## Multi-Head Attention\\n\\n```python\\nclass MultiHeadAttention(nn.Module):\\n  def __init__(self, heads=4,d_model=256):\\n    super(MultiHeadAttention, self).__init__()\\n    self.heads = heads\\n    self.d_model = d_model\\n    self.W_q = nn.Linear(d_model,d_model)\\n    self.W_k = nn.Linear(d_model,d_model)\\n    self.W_v = nn.Linear(d_model,d_model)\\n\\n    self.W_o = nn.Linear(d_model,d_model)\\n\\n  def forward(self, q,k,v,mask):\\n    d_k = self.d_model // self.heads\\n    q,k,v = self.W_q(q),self.W_k(k),self.W_v(v)\\n\\n    q = q.view(q.shape[0],q.shape[1],self.heads,-1).transpose(1,2) # (batch,h,seq_len,d_k)\\n    k = k.view(k.shape[0],k.shape[1],self.heads,-1).transpose(1,2) # (batch,h,seq_len,d_k)\\n    v = v.view(v.shape[0],v.shape[1],self.heads,-1).transpose(1,2) # (batch,h,seq_len,d_k)\\n\\n    res = torch.matmul(q,k.transpose(-2,-1))  /  math.sqrt(d_k)\\n\\n    if mask is not None:\\n      mask = mask.unsqueeze(1)\\n      res = torch.masked_fill(res,mask==0,float(\'-inf\'))\\n\\n    attention = nn.functional.softmax(res,dim=-1)\\n\\n    # (batch,h,seq_len,d_k) -> (batch,seq_len,h,d_k) -> (batch,h,seq_len,d_model)\\n    output = torch.matmul(attention,v).transpose(1,2).contiguous().view(q.shape[0],-1,self.d_model)\\n    output = self.W_o(output)\\n\\n    return output\\n```\\n\\nThis implementation of **multi-head attention** closely follows the formulation outlined in the previous post.\\nlast post.\\n\\n```python\\n    d_k = self.d_model // self.heads\\n    q,k,v = self.W_q(q),self.W_k(k),self.W_v(v)\\n```\\n\\nFirst, the embedding dimension for each head is calculated by dividing the model\'s embedding dimension by the number of heads. This is done to split the input into multiple smaller attention heads, allowing the model to focus on different aspects of the input simultaneously.\\nNext, learnable **weight matrices** are applied to the input sequences to project them into the **Query (Q)**, **Key (K)**, and **Value (V)** spaces.\\n\\n```python\\n    q = q.view(q.shape[0],q.shape[1],self.heads,-1).transpose(1,2) # (batch,h,seq_len,d_k)\\n    k = k.view(k.shape[0],k.shape[1],self.heads,-1).transpose(1,2) # (batch,h,seq_len,d_k)\\n    v = v.view(v.shape[0],v.shape[1],self.heads,-1).transpose(1,2) # (batch,h,seq_len,d_k)\\n```\\n\\nHere we bring the tensor into the required shape, as they are of shape $$(batch,seq\\\\_len,d_{\\\\text{model}})$$\\nand should be of shape $$(batch,h,seq\\\\_len,d_k)$$, for multi head attention.\\n\\n```python\\n    res = torch.matmul(q,k.transpose(-2,-1))  /  math.sqrt(d_k)\\n\\n    if mask is not None:\\n      mask = mask.unsqueeze(1)\\n      res = torch.masked_fill(res,mask==0,float(\'-inf\'))\\n```\\n\\nTo compute the attention scores, we first calculate $$\\\\frac{QK^T}{\\\\sqrt{d_k}}$$.\\nWe then apply the mask to the attention scores. Padding tokens are handled by setting their corresponding positions in the attention mask to $$-\\\\infty$$. This ensures that, when we apply the softmax function, those positions are effectively ignored.\\nThe formula for softmax is:\\n\\n$$\\n\\\\text{softmax}(x_i) = \\\\frac{e^{x_i}}{\\\\sum_{j} e^{x_j}}\\n$$\\n\\nBy setting the masked values to $$-\\\\infty$$, their exponential becomes:\\n\\n$$\\ne^{-\\\\infty} = 0\\n$$\\n\\nThis means the contributions of these positions to the numerator and denominator of the softmax equation are completely removed.\\n\\n```python\\n  attention = nn.functional.softmax(res,dim=-1)\\n\\n  # (batch,h,seq_len,d_k) -> (batch,seq_len,h,d_k) -> (batch,h,seq_len,d_model)\\n  output = torch.matmul(attention,v).transpose(1,2).contiguous().view(q.shape[0],-1,self.d_model)\\n  output = self.W_o(output)\\n```\\n\\nAfter applying the mask, the next step is to apply the softmax function to each row of the attention matrix.\\nOnce the attention scores are multiplied with $$V$$, we handle the multiple heads by concatenating them. The tensor is reshaped from $$(\\\\text{batch}, h, \\\\text{seq\\\\_len}, d_k)$$ back to $$(\\\\text{batch}, \\\\text{seq\\\\_len}, d_{\\\\text{model}})$$, restoring the original embedding dimension.\\n\\nFinally, the concatenated output is passed through the last weight matrix. This produces the final output of the attention layer, concluding its computations.\\n\\n## Decoder\\n\\nNow that we have an understanding of the **encoder**, we turn our attention to the **decoder**. The decoder shares many similarities with the encoder but introduces two key distinctions.\\nThe first is the application of the **causal mask** in addition to the padding mask.\\nThe second is the inclusion of the **cross-attention layer**. This layer allows the decoder to attend to the encoder\'s outputs,\\n\\n```python\\n\\nclass DecoderBlock(nn.Module):\\n  def __init__(self,d_model=256,heads=4,hidden=1024,dropout=0.1):\\n    super(DecoderBlock, self).__init__()\\n    self.masked_multi_head_attention = MultiHeadAttention(heads=heads,d_model=d_model)\\n    self.cross_multi_head_attention = MultiHeadAttention(heads=heads,d_model=d_model)\\n\\n    self.norm1 = nn.LayerNorm(d_model)\\n    self.norm2 = nn.LayerNorm(d_model)\\n    self.norm3 = nn.LayerNorm(d_model)\\n\\n    self.mlp = nn.Sequential(nn.Linear(d_model,hidden),\\n                             nn.GELU(),\\n                             nn.Linear(hidden,d_model),\\n                             nn.Dropout(dropout))\\n\\n  def forward(self,tgt,memory,tgt_padding_mask,tgt_causal_mask,memory_padding_mask):\\n    tgt_padding_mask = (tgt_causal_mask & tgt_padding_mask).int()\\n\\n    att_output = self.masked_multi_head_attention(tgt,tgt,tgt,tgt_padding_mask)\\n    norm_output = self.norm1(att_output + tgt )\\n    cross_attn_output = self.cross_multi_head_attention(norm_output,memory,memory,memory_padding_mask)\\n    norm_output = self.norm2(cross_attn_output + norm_output)\\n    mlp_out = self.mlp(norm_output)\\n    return self.norm3(mlp_out + norm_output)\\n\\nclass Decoder(nn.Module):\\n  def __init__(self,num_layers=6,d_model=256,heads=4,hidden=1024):\\n      super(Decoder, self).__init__()\\n      self.layers = nn.ModuleList([DecoderBlock(d_model=d_model,heads=heads,hidden=hidden) for i in range(num_layers)])\\n\\n  def forward(self,tgt,memory,tgt_padding_mask,tgt_causal_mask,memory_padding_mask):\\n    for layer in self.layers:\\n      tgt = layer(tgt,memory,tgt_padding_mask,tgt_causal_mask,memory_padding_mask)\\n    return tgt\\n```\\n\\nThe **Decoder** class assembles multiple **DecoderBlocks** and passes them the respective masks required for the attention mechanisms.\\nAlong with the target padding mask and causal mask, the decoder requires the memory (encoder output) and memory_padding_mask (source padding mask).\\nIn the **DecoderBlock**, the target padding mask is combined with the causal mask to ensure that tokens in the target sequence cannot attend to padding tokens or tokens that come after them in the sequence.\\nThis combined mask is applied to the target tokens, which are then fed into the first attention block.\\nhe output of this block is processed using a skip connection, followed by a LayerNorm to stabilize training.\\nNext, the cross-attention is computed. In this step, the target tokens (queries) attend to the encoder outputs (keys) and aggregate information from the encoder outputs (values) based on the attention mechanism.\\nTo ensure proper operation, the memory_padding_mask is applied so that padding tokens in the encoder outputs are ignored.\\nAfter that the architecture of the decoder is same as the encoders.\\n\\n## Training loop\\n\\n```python\\n\\nwarmup = 10\\nlr = 2.5e-4\\nmin_lr = 1e-6\\n\\nclass InverseSquareRootLR(torch.optim.lr_scheduler._LRScheduler):\\n    def __init__(self, optimizer, warmup_steps, init_lr, min_lr=1e-9, last_epoch=-1):\\n        self.warmup_steps = warmup_steps\\n        self.init_lr = init_lr\\n        self.min_lr = min_lr\\n        super(InverseSquareRootLR, self).__init__(optimizer, last_epoch)\\n\\n    def get_lr(self):\\n        step = self.last_epoch + 1\\n        if step < self.warmup_steps:\\n            lr = self.init_lr * (step / self.warmup_steps)\\n        else:\\n            lr = self.init_lr * math.sqrt(self.warmup_steps / step)\\n\\n        lr = max(lr, self.min_lr)\\n\\n        return [lr for _ in self.base_lrs]\\n\\nepochs = 100\\nmodel = TranslationModel(vocab_size=tokenizer.vocab_size,d_model=512,src_seq_len=src_seq_len,trg_seq_len=trg_seq_len)\\nmodel.to(device)\\noptim = torch.optim.AdamW(model.parameters(),lr=lr,betas=(0.9, 0.98))\\nlr_scheduler = InverseSquareRootLR(optim,warmup,lr,min_lr=min_lr)\\nloss_fn = nn.CrossEntropyLoss(ignore_index=tokenizer.pad_token_id)\\nfor epoch in range(epochs):\\n    for batch in train_dataloader:\\n        src = batch[\\"input_ids\\"].to(device)\\n        src_attention_mask = batch[\\"src_mask\\"].to(device)\\n        tgt = batch[\\"target\\"].to(device)\\n        tgt_attention_mask = batch[\\"target_mask\\"].to(device)\\n\\n        labels = batch[\\"labels\\"].to(device)[:,1:]\\n\\n        pad_tokens = torch.full((labels.shape[0], 1), tokenizer.pad_token_id, dtype=tgt.dtype).to(device)\\n        labels = torch.cat((labels, pad_tokens), dim=-1)\\n        output = model(src,tgt,src_attention_mask,tgt_attention_mask)\\n\\n        output = output.view(-1,output.shape[-1])\\n        labels = labels.view(-1)\\n\\n        loss = loss_fn(output,labels)\\n        optim.zero_grad()\\n        loss.backward()\\n        torch.nn.utils.clip_grad_norm_(model.parameters(), max_norm=1.0)\\n\\n        optim.step()\\n        lr_scheduler.step()\\n\\n    print(loss)\\n\\n```\\n\\nNow lets first look at the model initialization code\\n\\n```python\\nepochs = 100\\nmodel = TranslationModel(vocab_size=tokenizer.vocab_size,d_model=512,src_seq_len=src_seq_len,trg_seq_len=trg_seq_len)\\nmodel.to(device)\\noptim = torch.optim.AdamW(model.parameters(),lr=lr,betas=(0.9, 0.98))\\nlr_scheduler = InverseSquareRootLR(optim,warmup,lr,min_lr=min_lr)\\nloss_fn = nn.CrossEntropyLoss(ignore_index=tokenizer.pad_token_id)\\n```\\n\\nIn this step, we initialize the model, set up the optimizer, and define the loss function. The loss function used is **CrossEntropyLoss**, which is commonly employed for sequence-to-sequence tasks. CrossEntropyLoss is mathematically defined as:\\n\\n$$\\n\\\\text{CrossEntropyLoss}(y, \\\\hat{y}) = - \\\\frac{1}{N} \\\\sum_{i=1}^N \\\\sum_{j=1}^C y_{ij} \\\\log(\\\\hat{y}_{ij})\\n$$\\n\\nHere:\\n\\n- $$y$$ represents the true distribution (one-hot encoded ground truth).\\n- $$\\\\hat{y}$$ represents the predicted probability distribution from the model.\\n- $$N$$ is the number of samples in the batch.\\n- $$C$$ is the number of classes (vocabulary size in this case).\\n\\nThis loss function calculates the negative log likelihood of the correct class, weighted by the true distribution. It is averaged over all tokens in the batch, penalizing predictions that deviate from the true class probabilities.\\nThe `ignore_index` parameter tells the CrossEntropyLoss to set probabilities $$\\\\hat{y}_{ij}$$ to 0, where $$j= \\\\text{pad\\\\_token\\\\_id}$$. This will exclude\\nthe padding values in the loss computation.\\n\\nNext, we adjust the shape of the label tokens to ensure they align correctly with the target tokens. Both the target tokens and the label tokens currently contain `<START>` and `<END>` tokens. However, for training, the labels need to be shifted one token to the left.\\n\\nThis means the `<START>` token is removed from the labels, and a `<PAD>` token is added at the end to maintain the correct sequence length. This shift ensures that each label token corresponds to the prediction of the decoder for the previous target token.\\n\\n```python\\nsrc = batch[\\"input_ids\\"].to(device)\\nsrc_attention_mask = batch[\\"src_mask\\"].to(device)\\ntgt = batch[\\"target\\"].to(device)\\ntgt_attention_mask = batch[\\"target_mask\\"].to(device)\\nlabels = batch[\\"labels\\"].to(device)[:,1:]\\n\\npad_tokens = torch.full((labels.shape[0], 1), tokenizer.pad_token_id, dtype=tgt.dtype).to(device)\\nlabels = torch.cat((labels, pad_tokens), dim=-1)\\n```\\n\\nWe then feed in these inputs into the model.\\n\\n```python\\noutput = model(src,tgt,src_attention_mask,tgt_attention_mask)\\n\\noutput = output.view(-1,output.shape[-1])\\nlabels = labels.view(-1)\\n\\nloss = loss_fn(output,labels)\\n```\\n\\nAfter processing, the model produces an output tensor of shape $$(\\\\text{batch}, \\\\text{seq\\\\_len}, \\\\text{vocab\\\\_size})$$.\\nThis tensor contains the prediction vectors for the entire vocabulary at each position in the sequence.\\nThese vectors do not represent probabilities yet, as the **CrossEntropyLoss** function internally applies a softmax operation to convert them into probabilities.\\nFor the **CrossEntropyLoss** to work with a batched case, it expects a 2D tensor as input.\\nTo satisfy this requirement, we reshape the output tensor into the shape $$(\\\\text{batch} \\\\times \\\\text{seq\\\\_len}, \\\\text{vocab\\\\_size})$$, effectively flattening the batch and sequence dimensions while keeping the vocabulary dimension intact.\\n\\nSimilarly, the label tensor is reshaped to have the shape $$(\\\\text{batch} \\\\times \\\\text{seq\\\\_len})$$. This ensures that each label aligns correctly with the corresponding prediction vector for the loss calculation.\\n\\nNow lettings this run will train our model to translate german into english sentences.\\nWith this current configuration the model contains roughly 75M parameters.\\nIn the next post, we will explore how to adjust this architecture to recreate the well-known **Llama 3** foundational language model from Meta.\\nWhile the current implementation of our Transformer adheres closely to its vanilla formulation, Llama 3 represents a state-of-the-art large language model (LLM) that builds on and extends the original Transformer design.\\nWe will delve into the architectural changes and optimizations that have been introduced since the original Transformer, examining how these innovations contribute to the exceptional performance of a model like Llama 3.\\n","code":"var Component=(()=>{var m=Object.create;var c=Object.defineProperty;var h=Object.getOwnPropertyDescriptor;var u=Object.getOwnPropertyNames;var N=Object.getPrototypeOf,k=Object.prototype.hasOwnProperty;var g=(a,e)=>()=>(e||a((e={exports:{}}).exports,e),e.exports),_=(a,e)=>{for(var s in e)c(a,s,{get:e[s],enumerable:!0})},i=(a,e,s,l)=>{if(e&&typeof e==\\"object\\"||typeof e==\\"function\\")for(let t of u(e))!k.call(a,t)&&t!==s&&c(a,t,{get:()=>e[t],enumerable:!(l=h(e,t))||l.enumerable});return a};var y=(a,e,s)=>(s=a!=null?m(N(a)):{},i(e||!a||!a.__esModule?c(s,\\"default\\",{value:a,enumerable:!0}):s,a)),f=a=>i(c({},\\"__esModule\\",{value:!0}),a);var r=g((x,o)=>{o.exports=_jsx_runtime});var w={};_(w,{default:()=>d,frontmatter:()=>b});var n=y(r()),b={title:\\"Introduction to Transformers - Part 01 - Implementation of a translation model\\",date:\\"2024-10-13\\",tags:[\\"transformer\\",\\"nlp\\",\\"code\\"],draft:!1,summary:\\"A full implementation of the Transformer architecture in PyTorch, built entirely from scratch, designed specifically for use in a translation model.\\"};function p(a){let e={a:\\"a\\",annotation:\\"annotation\\",code:\\"code\\",h2:\\"h2\\",h3:\\"h3\\",h4:\\"h4\\",hr:\\"hr\\",li:\\"li\\",math:\\"math\\",mfrac:\\"mfrac\\",mi:\\"mi\\",mn:\\"mn\\",mo:\\"mo\\",mover:\\"mover\\",mrow:\\"mrow\\",msqrt:\\"msqrt\\",msub:\\"msub\\",msup:\\"msup\\",mtext:\\"mtext\\",munder:\\"munder\\",munderover:\\"munderover\\",ol:\\"ol\\",p:\\"p\\",path:\\"path\\",pre:\\"pre\\",semantics:\\"semantics\\",span:\\"span\\",strong:\\"strong\\",svg:\\"svg\\",ul:\\"ul\\",...a.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)(e.h3,{className:\\"content-header\\",id:\\"introduction\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#introduction\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Introduction\\"]}),(0,n.jsx)(e.p,{children:\\"In the previous post, we explored the inner workings of the Transformer architecture, dissecting its components and understanding how it forms the backbone of state-of-the-art models like BERT, GPT, and T5. Now, it\'s time to turn theory into practice.\\"}),(0,n.jsxs)(e.p,{children:[\\"In this post, we will implement a full Transformer model from scratch in \\",(0,n.jsx)(e.strong,{children:\\"PyTorch\\"}),\\" and apply it to a \\",(0,n.jsx)(e.strong,{children:\\"translation task\\"}),\\". Specifically, we will use the \\",(0,n.jsx)(e.strong,{children:\\"WMT14 English-German (en-de)\\"}),\\" dataset, a benchmark dataset widely used for machine translation tasks.\\"]}),(0,n.jsxs)(e.h3,{className:\\"content-header\\",id:\\"dataset-preparation-and-preprocessing\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#dataset-preparation-and-preprocessing\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Dataset Preparation and Preprocessing\\"]}),(0,n.jsxs)(e.p,{children:[\\"To train our Transformer model, we need a dataset and a way to preprocess it into a format suitable for the model. In this example, we use the \\",(0,n.jsx)(e.strong,{children:\\"WMT14 English-German (en-de)\\"}),\\" dataset from the Hugging Face \\",(0,n.jsx)(e.code,{children:\\"datasets\\"}),\\" library. This dataset is a common benchmark for machine translation tasks.\\"]}),(0,n.jsx)(e.hr,{}),(0,n.jsxs)(e.h4,{className:\\"content-header\\",id:\\"loading-the-dataset\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#loading-the-dataset\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Loading the Dataset\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"from\\"}),\\" transformers \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"import\\"}),` AutoTokenizer\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"from\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"utils\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"data \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"import\\"}),` DataLoader\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"from\\"}),\\" datasets \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"import\\"}),` load_dataset\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"dataset \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" load_dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"wmt14\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"de-en\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'train\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'train\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"select\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"10000\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'test\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'test\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"select\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1000\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'validation\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'validation\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"select\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1000\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'train\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'train\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"select\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"10000\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'test\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'test\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"select\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1000\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'validation\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" dataset\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'validation\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"select\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1000\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsx)(e.p,{children:\\"The dataset contains parallel sentences in German (de) and English (en), ideal for a translation model.\\"}),(0,n.jsxs)(e.h4,{className:\\"content-header\\",id:\\"initializing-the-tokenizer\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#initializing-the-tokenizer\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Initializing the Tokenizer\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"from\\"}),\\" transformers \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"import\\"}),` AutoTokenizer\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"tokenizer \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" AutoTokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"from_pretrained\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"bert-base-cased\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"src_seq_len \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"128\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"trg_seq_len \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"128\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"batch_size \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"256\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"preprocess_function\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"examples\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    inputs \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),\\"item\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"de\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" item \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" examples\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"translation\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    targets \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),\\"item\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"en\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" item \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" examples\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"translation\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),\\"item\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"en\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" item \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" examples\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"translation\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    model_inputs \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        inputs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        padding\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"max_length\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        truncation\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"True\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        max_length\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        add_special_tokens\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"False\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    model_inputs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'src_mask\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" model_inputs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"attention_mask\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"with\\"}),\\" tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"as_target_tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        targets \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            targets\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            padding\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"max_length\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            truncation\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"True\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            max_length\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            add_special_tokens\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"True\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            padding\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"max_length\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            truncation\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"True\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            max_length\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            add_special_tokens\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"True\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    model_inputs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"target\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" targets\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"input_ids\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    model_inputs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"target_mask\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" targets\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"attention_mask\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    model_inputs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"labels\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"input_ids\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),` model_inputs\\n`]})]})}),(0,n.jsxs)(e.h4,{className:\\"content-header\\",id:\\"tokenization\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#tokenization\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Tokenization\\"]}),(0,n.jsxs)(e.p,{children:[\\"The \\",(0,n.jsx)(e.code,{children:\\"AutoTokenizer\\"}),\\" from Hugging Face is initialized with the \\",(0,n.jsx)(e.code,{children:\\"bert-base-cased\\"}),\\" model. This tokenizer is used to tokenize both the source (German) and target (English) sentences in the dataset. The tokenization process involves splitting the text into smaller units (tokens) and mapping them to numerical IDs that the model can process.\\"]}),(0,n.jsx)(e.hr,{}),(0,n.jsxs)(e.h4,{className:\\"content-header\\",id:\\"handling-input-and-output-sequences\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#handling-input-and-output-sequences\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Handling Input and Output Sequences\\"]}),(0,n.jsx)(e.p,{children:\\"The preprocessing function performs the following key steps:\\"}),(0,n.jsxs)(e.ol,{children:[(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\\"Extracting Text Data\\"}),\\":\\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsx)(e.li,{children:\\"German sentences are extracted as inputs (source sequences).\\"}),(0,n.jsxs)(e.li,{children:[\\"English sentences are extracted as targets (\\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\" inputs) and labels (ground truth for loss computation).\\"]})]})]}),(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\\"Tokenizing Source Sequences\\"}),\\":\\"]}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[\\"German sentences are tokenized and padded or truncated to a fixed length defined by \\",(0,n.jsx)(e.code,{children:\\"src_seq_len\\"}),\\" (128 tokens in this case).\\"]}),(0,n.jsxs)(e.li,{children:[\\"Special tokens like \\",(0,n.jsx)(e.code,{children:\\"<START>\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"<END>\\"}),\\" are not added for source sequences, as they are only required for the \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\".\\"]})]})]}),(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\\"Creating a Source Mask\\"}),\\":\\"]}),(0,n.jsx)(e.ul,{children:(0,n.jsxs)(e.li,{children:[\\"The tokenizer generates an attention mask (\\",(0,n.jsx)(e.code,{children:\\"src_mask\\"}),\\") for the source sequences. This mask indicates valid tokens (1) and padded tokens (0), which the model uses to ignore padding during computations. This (\\",(0,n.jsx)(e.code,{children:\\"src_mask\\"}),\\") will be used in the attention layers of the \\",(0,n.jsx)(e.strong,{children:\\"encoder\\"}),\\", such that real tokens won\'t attend to padding tokens.\\"]})})]}),(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\\"Tokenizing Target Sequences\\"}),\\":\\"]}),(0,n.jsx)(e.ul,{children:(0,n.jsxs)(e.li,{children:[\\"English sentences are tokenized twice:\\",(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\\"Targets\\"}),\\": Used as input to the \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\" during training. Special tokens like \\",(0,n.jsx)(e.code,{children:\\"<START>\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"<END>\\"}),\\" are added.\\"]}),(0,n.jsxs)(e.li,{children:[(0,n.jsx)(e.strong,{children:\\"Labels\\"}),\\": Used for loss computation. These represent the expected output tokens for the \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\".\\"]})]})]})})]}),(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.p,{children:[(0,n.jsx)(e.strong,{children:\\"Creating a Target Mask\\"}),\\":\\"]}),(0,n.jsx)(e.ul,{children:(0,n.jsxs)(e.li,{children:[\\"The tokenizer generates an attention mask (\\",(0,n.jsx)(e.code,{children:\\"target_mask\\"}),\\") for the target sequences, similar to the source mask, to handle padding effectively. Here the (\\",(0,n.jsx)(e.code,{children:\\"target_mask\\"}),\\") serves the same purpose as the (\\",(0,n.jsx)(e.code,{children:\\"src_mask\\"}),\\") in the \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\", it will be used in the attention layers of the \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\", to mask out padding tokens.\\"]})})]})]}),(0,n.jsxs)(e.h2,{className:\\"content-header\\",id:\\"the-translation-model\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#the-translation-model\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"The Translation Model\\"]}),(0,n.jsxs)(e.p,{children:[\\"Below, we describe the translation model, which builds upon the core principles of the Transformer architecture. This model incorporates the fundamental components of the Transformer while effectively handling \\",(0,n.jsx)(e.strong,{children:\\"padding\\"}),\\" and the \\",(0,n.jsx)(e.strong,{children:\\"causal mask\\"}),\\" required for cross-attention. The architecture processes the input sequences by first preparing them with appropriate masks and then passing them through the \\",(0,n.jsx)(e.strong,{children:\\"encoder\\"}),\\" and \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\" components.\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"class\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token class-name\\",children:\\"TranslationModel\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Module\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"__init__\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"super\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"TranslationModel\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"__init__\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"src_seq_len \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),` src_seq_len\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"trg_seq_len \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),` trg_seq_len\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"encoder \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" Encoder\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"decoder \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" Decoder\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"embedding_src \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Embedding\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"embedding_tgt \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Embedding\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"positional_encoding_src \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Embedding\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"positional_encoding_tgt \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Embedding\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"src_pos \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"arange\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"trg_pos \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"arange\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"ffn \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"forward\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    src_padding_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" src_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"repeat\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    tgt_padding_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"repeat\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    tgt_causal_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"tril\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"ones_like\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    src_embed \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"embedding_src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"positional_encoding_src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"src_pos\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    tgt_embed \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"embedding_tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"positional_encoding_tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"trg_pos\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    enc_out \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"encoder\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"src_embed\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    dec_out \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"decoder\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"tgt \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tgt_embed\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                           memory\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"enc_out\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                           tgt_padding_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                           tgt_causal_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tgt_causal_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                           memory_padding_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" src_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"ffn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"dec_out\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"As you can see, the first step in the model\'s design is the initialization of \\",(0,n.jsx)(e.strong,{children:\\"embedding layers\\"}),\\", which hold the embeddings for the tokenized sequences. These embeddings represent each token as a dense vector in a high-dimensional space, providing the model with a numerical representation of the input.\\"]}),(0,n.jsxs)(e.p,{children:[\\"In addition to the token embeddings, the model initializes two embedding layers for \\",(0,n.jsx)(e.strong,{children:\\"positional encoding\\"}),\\". Unlike the fixed sinusoidal encoding discussed in the previous post, this implementation uses \\",(0,n.jsx)(e.strong,{children:\\"learnable positional encodings\\"}),\\". This approach is more flexible, allowing the model to adapt the positional information to the specific dataset and task during training. Empirical evidence shows that learnable positional encodings often lead to better performance compared to fixed encodings.\\"]}),(0,n.jsxs)(e.p,{children:[\\"In the \\",(0,n.jsx)(e.code,{children:\\"_forward_\\"}),\\" method, three masks are created to handle the input sequences. The \\",(0,n.jsx)(e.code,{children:\\"src_padding_mask\\"}),\\" ensures the encoder ignores padding tokens in the source sequence. Similarly, the \\",(0,n.jsx)(e.code,{children:\\"tgt_padding_mask\\"}),\\" prevents the decoder from processing padding tokens in the target sequence. The \\",(0,n.jsx)(e.code,{children:\\"tgt_causal_mask\\"}),\\" enforces causality in the decoder, ensuring tokens only attend to earlier tokens during prediction.\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  src_padding_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" src_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"repeat\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  tgt_padding_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"repeat\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  tgt_causal_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"tril\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"ones_like\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"What we do here is transform the \\",(0,n.jsx)(e.strong,{children:\\"src_padding_mask\\"}),\\" and \\",(0,n.jsx)(e.strong,{children:\\"tgt_padding_mask\\"}),\\" from 1D arrays into \\",(0,n.jsx)(e.strong,{children:\\"matrix masks\\"}),\\". Since the tokenizer only creates 1D arrays, we need to expand them into a matrix form to use them effectively in the attention layer. This transformation is achieved by stacking each 1D array \\",(0,n.jsx)(e.code,{children:\\"self.src_seq_len\\"}),\\" times, ensuring that padding tokens are ignored during attention calculations. The same process is applied to the \\",(0,n.jsx)(e.strong,{children:\\"tgt_padding_mask\\"}),\\". For the \\",(0,n.jsx)(e.strong,{children:\\"cross-attention layer\\"}),\\", we generate the \\",(0,n.jsx)(e.strong,{children:\\"causal mask\\"}),\\". This mask enforces causality by ensuring that tokens can only attend to themselves or tokens that came before them.\\"]}),(0,n.jsxs)(e.p,{children:[\\"After preparing the masks, we proceed to retrieve the embeddings for both the source and target sequences. These embeddings are combined with positional encodings to inject positional information into the token representations. This step ensures the model understands the order of tokens within the sequences. Once the source embeddings are ready, they are passed into the \\",(0,n.jsx)(e.strong,{children:\\"encoder\\"}),\\", where the input sequence is processed and contextualized. The output of the encoder is then used as input to the \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\", which generates the output sequence. With this general understanding, we will now take a closer look at the architecture of the \\",(0,n.jsx)(e.strong,{children:\\"encoder\\"}),\\".\\"]}),(0,n.jsxs)(e.h2,{className:\\"content-header\\",id:\\"encoder\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#encoder\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Encoder\\"]}),(0,n.jsxs)(e.p,{children:[\\"Below is the architecture of the \\",(0,n.jsx)(e.strong,{children:\\"Encoder\\"}),\\", which is composed of multiple \\",(0,n.jsx)(e.strong,{children:\\"EncoderBlocks\\"}),\\". The \\",(0,n.jsx)(e.strong,{children:\\"Encoder\\"}),\\" class itself is straightforward\\\\u2014it initializes \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\\"n\\"})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"n\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".4306em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"n\\"})]})})]}),\\" \\",(0,n.jsx)(e.strong,{children:\\"EncoderBlocks\\"}),\\" and feeds the output of one block into the next in sequence.\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"class\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token class-name\\",children:\\"EncoderBlock\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Module\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"__init__\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"256\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"4\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1024\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"dropout\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0.1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"super\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"EncoderBlock\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"__init__\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"multi_head_attention \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" MultiHeadAttention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm1 \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"LayerNorm\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm2 \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"LayerNorm\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"mlp \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Sequential\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                             nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"GELU\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                             nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                             nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Dropout\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"dropout\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                             \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"forward\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    att_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"multi_head_attention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    skip_con \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" att_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),` src\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    norm_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm1\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"skip_con\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    mlp_out \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"mlp\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"norm_output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm2\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"mlp_out \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),\\" norm_output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"class\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token class-name\\",children:\\"Encoder\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Module\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"__init__\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"num_layers\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"6\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"256\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"4\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1024\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"super\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"Encoder\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"__init__\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"layers \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"ModuleList\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),\\"EncoderBlock\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" i \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"num_layers\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"forward\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" layer \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"layers\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      src \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" layer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),` src\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"The interesting part of the encoder lies in the \\",(0,n.jsx)(e.strong,{children:\\"EncoderBlock\\"}),\\". Here, the source sequence is passed as \\",(0,n.jsx)(e.strong,{children:\\"Queries\\"}),\\", \\",(0,n.jsx)(e.strong,{children:\\"Keys\\"}),\\", and \\",(0,n.jsx)(e.strong,{children:\\"Values\\"}),\\" into the \\",(0,n.jsx)(e.strong,{children:\\"MultiHeadAttention\\"}),\\" block. Additionally, we pass the \\",(0,n.jsx)(e.strong,{children:\\"src_padding_mask\\"}),\\" to ensure that padding tokens are ignored during attention calculations. After computing the output of the \\",(0,n.jsx)(e.strong,{children:\\"MultiHeadAttention\\"}),\\" block, a \\",(0,n.jsx)(e.strong,{children:\\"skip connection\\"}),\\" is applied by adding the input back to the output. This result is then normalized using a \\",(0,n.jsx)(e.strong,{children:\\"LayerNorm\\"}),\\" to improve training stability. Next, the output is passed through a simple \\",(0,n.jsx)(e.strong,{children:\\"Feed-Forward Network (FFN)\\"}),\\", which includes another skip connection and a \\",(0,n.jsx)(e.strong,{children:\\"Dropout\\"}),\\" layer for regularization.\\"]}),(0,n.jsxs)(e.h2,{className:\\"content-header\\",id:\\"multi-head-attention\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#multi-head-attention\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Multi-Head Attention\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"class\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token class-name\\",children:\\"MultiHeadAttention\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Module\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"__init__\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"4\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"256\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"super\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"MultiHeadAttention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"__init__\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"heads \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),` heads\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"d_model \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),` d_model\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_q \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_k \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_v \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_o \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"forward\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    d_k \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"d_model \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"//\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),`heads\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"v \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    q \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k)\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    k \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k)\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    v \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k)\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    res \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"matmul\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\"  \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"/\\"}),\\"  math\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"sqrt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"if\\"}),\\" mask \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"is\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"not\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"None\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      res \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"masked_fill\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"res\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"mask\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"==\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"float\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'-inf\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    attention \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"functional\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"softmax\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"res\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"dim\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k) -> (batch,seq_len,h,d_k) -> (batch,h,seq_len,d_model)\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"matmul\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"attention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"contiguous\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_o\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),` output\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"This implementation of \\",(0,n.jsx)(e.strong,{children:\\"multi-head attention\\"}),\\" closely follows the formulation outlined in the previous post. last post.\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    d_k \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"d_model \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"//\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),`heads\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"v \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"First, the embedding dimension for each head is calculated by dividing the model\'s embedding dimension by the number of heads. This is done to split the input into multiple smaller attention heads, allowing the model to focus on different aspects of the input simultaneously. Next, learnable \\",(0,n.jsx)(e.strong,{children:\\"weight matrices\\"}),\\" are applied to the input sequences to project them into the \\",(0,n.jsx)(e.strong,{children:\\"Query (Q)\\"}),\\", \\",(0,n.jsx)(e.strong,{children:\\"Key (K)\\"}),\\", and \\",(0,n.jsx)(e.strong,{children:\\"Value (V)\\"}),\\" spaces.\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    q \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k)\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    k \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k)\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    v \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k)\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"Here we bring the tensor into the required shape, as they are of shape \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mi,{children:\\"b\\"}),(0,n.jsx)(e.mi,{children:\\"a\\"}),(0,n.jsx)(e.mi,{children:\\"t\\"}),(0,n.jsx)(e.mi,{children:\\"c\\"}),(0,n.jsx)(e.mi,{children:\\"h\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mi,{children:\\"s\\"}),(0,n.jsx)(e.mi,{children:\\"e\\"}),(0,n.jsx)(e.mi,{children:\\"q\\"}),(0,n.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,n.jsx)(e.mi,{children:\\"l\\"}),(0,n.jsx)(e.mi,{children:\\"e\\"}),(0,n.jsx)(e.mi,{children:\\"n\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"d\\"}),(0,n.jsx)(e.mtext,{children:\\"model\\"})]}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"(batch,seq\\\\\\\\_len,d_{\\\\\\\\text{model}})\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"ba\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"c\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"h\\"}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,n.jsx)(e.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight text\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\" and should be of shape \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mi,{children:\\"b\\"}),(0,n.jsx)(e.mi,{children:\\"a\\"}),(0,n.jsx)(e.mi,{children:\\"t\\"}),(0,n.jsx)(e.mi,{children:\\"c\\"}),(0,n.jsx)(e.mi,{children:\\"h\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mi,{children:\\"h\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mi,{children:\\"s\\"}),(0,n.jsx)(e.mi,{children:\\"e\\"}),(0,n.jsx)(e.mi,{children:\\"q\\"}),(0,n.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"_\\"}),(0,n.jsx)(e.mi,{children:\\"l\\"}),(0,n.jsx)(e.mi,{children:\\"e\\"}),(0,n.jsx)(e.mi,{children:\\"n\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"d\\"}),(0,n.jsx)(e.mi,{children:\\"k\\"})]}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"(batch,h,seq\\\\\\\\_len,d_k)\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"ba\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"t\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"c\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"h\\"}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"h\\"}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"se\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"q\\"}),(0,n.jsx)(e.span,{className:\\"mord\\",style:{marginRight:\\".02778em\\"},children:\\"_\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".01968em\\"},children:\\"l\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"n\\"}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", for multi head attention.\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    res \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"matmul\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\"  \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"/\\"}),\\"  math\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"sqrt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_k\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"if\\"}),\\" mask \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"is\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"not\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token boolean\\",children:\\"None\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"unsqueeze\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      res \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"masked_fill\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"res\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"mask\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"==\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"float\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\\"\'-inf\'\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"To compute the attention scores, we first calculate \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\\"Q\\"}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\\"K\\"}),(0,n.jsx)(e.mi,{children:\\"T\\"})]})]}),(0,n.jsx)(e.msqrt,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"d\\"}),(0,n.jsx)(e.mi,{children:\\"k\\"})]})})]})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\frac{QK^T}{\\\\\\\\sqrt{d_k}}\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.6275em\\",verticalAlign:\\"-.538em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mopen nulldelimiter\\"}),(0,n.jsx)(e.span,{className:\\"mfrac\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.0895em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-2.5864em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight sqrt\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".8622em\\"},children:[(0,n.jsxs)(e.span,{className:\\"svg-align\\",style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mtight\\",style:{paddingLeft:\\".833em\\"},children:(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"d\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3448em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.3488em\\",marginLeft:\\"0\\",marginRight:\\".0714em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".1512em\\"},children:(0,n.jsx)(e.span,{})})})]})})]})})]}),(0,n.jsxs)(e.span,{style:{top:\\"-2.8222em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight hide-tail\\",style:{minWidth:\\".853em\\",height:\\"1.08em\\"},children:(0,n.jsx)(e.svg,{viewBox:\\"0 0 400000 1080\\",xmlns:\\"http://www.w3.org/2000/svg\\",height:\\"1.08em\\",preserveAspectRatio:\\"xMinYMin slice\\",width:\\"400em\\",children:(0,n.jsx)(e.path,{d:`M95,702\\nc-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14\\nc0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54\\nc44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10\\ns173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429\\nc69,-144,104.5,-217.7,106.5,-221\\nl0 -0\\nc5.3,-9.3,12,-14,20,-14\\nH400000v40H845.2724\\ns-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7\\nc-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z\\nM834 80h400000v40h-400000z`})})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".1778em\\"},children:(0,n.jsx)(e.span,{})})})]})})})})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.23em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.4461em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"Q\\"}),(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"K\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsx)(e.span,{className:\\"vlist-t\\",children:(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".9191em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.931em\\",marginRight:\\".0714em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".13889em\\"},children:\\"T\\"})})]})})})})})]})]})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".538em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"mclose nulldelimiter\\"})]})]})})]}),\\". We then apply the mask to the attention scores. Padding tokens are handled by setting their corresponding positions in the attention mask to \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,n.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u221E\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"-\\\\\\\\infty\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6667em\\",verticalAlign:\\"-.0833em\\"}}),(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2212\\"}),(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u221E\\"})]})})]}),\\". This ensures that, when we apply the softmax function, those positions are effectively ignored. The formula for softmax is:\\"]}),(0,n.jsx)(e.span,{className:\\"katex-display\\",children:(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:\\"softmax\\"}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"x\\"}),(0,n.jsx)(e.mi,{children:\\"i\\"})]}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,n.jsx)(e.mo,{children:\\"=\\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\\"e\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"x\\"}),(0,n.jsx)(e.mi,{children:\\"i\\"})]})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.munder,{children:[(0,n.jsx)(e.mo,{children:\\"\\\\u2211\\"}),(0,n.jsx)(e.mi,{children:\\"j\\"})]}),(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\\"e\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"x\\"}),(0,n.jsx)(e.mi,{children:\\"j\\"})]})]})]})]})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{softmax}(x_i) = \\\\\\\\frac{e^{x_i}}{\\\\\\\\sum_{j} e^{x_j}}\\"})]})})}),(0,n.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"softmax\\"})}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"x\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,n.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"2.4632em\\",verticalAlign:\\"-1.1218em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mopen nulldelimiter\\"}),(0,n.jsx)(e.span,{className:\\"mfrac\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.3414em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-2.314em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsxs)(e.span,{className:\\"mop\\",children:[(0,n.jsx)(e.span,{className:\\"mop op-symbol small-op\\",style:{position:\\"relative\\",top:\\"0\\"},children:\\"\\\\u2211\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".162em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.4003em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".4358em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsx)(e.span,{className:\\"vlist-t\\",children:(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".6065em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-3.0051em\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"x\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3281em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.357em\\",marginLeft:\\"0\\",marginRight:\\".0714em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2819em\\"},children:(0,n.jsx)(e.span,{})})})]})})]})})})]})})})})})]})]})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.23em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.677em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord\\",children:(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsx)(e.span,{className:\\"vlist-t\\",children:(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".6644em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-3.063em\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"x\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3281em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.357em\\",marginLeft:\\"0\\",marginRight:\\".0714em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.5em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size3 size1\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".143em\\"},children:(0,n.jsx)(e.span,{})})})]})})]})})})]})})})})})]})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"1.1218em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"mclose nulldelimiter\\"})]})]})]})]})}),(0,n.jsxs)(e.p,{children:[\\"By setting the masked values to \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,n.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u221E\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"-\\\\\\\\infty\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6667em\\",verticalAlign:\\"-.0833em\\"}}),(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2212\\"}),(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u221E\\"})]})})]}),\\", their exponential becomes:\\"]}),(0,n.jsx)(e.span,{className:\\"katex-display\\",children:(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsxs)(e.msup,{children:[(0,n.jsx)(e.mi,{children:\\"e\\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,n.jsx)(e.mi,{mathvariant:\\"normal\\",children:\\"\\\\u221E\\"})]})]}),(0,n.jsx)(e.mo,{children:\\"=\\"}),(0,n.jsx)(e.mn,{children:\\"0\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"e^{-\\\\\\\\infty} = 0\\"})]})})}),(0,n.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8213em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"e\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsx)(e.span,{className:\\"vlist-t\\",children:(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".8213em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-3.113em\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u2212\\"}),(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:\\"\\\\u221E\\"})]})})]})})})})})]}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,n.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6444em\\"}}),(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"0\\"})]})]})]})}),(0,n.jsx)(e.p,{children:\\"This means the contributions of these positions to the numerator and denominator of the softmax equation are completely removed.\\"}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  attention \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"functional\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"softmax\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"res\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"dim\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token comment\\",children:\\"# (batch,h,seq_len,d_k) -> (batch,seq_len,h,d_k) -> (batch,h,seq_len,d_model)\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"matmul\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"attention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"v\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"transpose\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"contiguous\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"q\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"W_o\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"After applying the mask, the next step is to apply the softmax function to each row of the attention matrix. Once the attention scores are multiplied with \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\\"V\\"})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"V\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".22222em\\"},children:\\"V\\"})]})})]}),\\", we handle the multiple heads by concatenating them. The tensor is reshaped from \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mtext,{children:\\"batch\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mi,{children:\\"h\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mtext,{children:\\"seq_len\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"d\\"}),(0,n.jsx)(e.mi,{children:\\"k\\"})]}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"(\\\\\\\\text{batch}, h, \\\\\\\\text{seq\\\\\\\\_len}, d_k)\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"batch\\"})}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"h\\"}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"seq_len\\"})}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".03148em\\"},children:\\"k\\"})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\" back to \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mtext,{children:\\"batch\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mtext,{children:\\"seq_len\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"d\\"}),(0,n.jsx)(e.mtext,{children:\\"model\\"})]}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"(\\\\\\\\text{batch}, \\\\\\\\text{seq\\\\\\\\_len}, d_{\\\\\\\\text{model}})\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"batch\\"})}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"seq_len\\"})}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",children:\\"d\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3361em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"0\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight text\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:\\"model\\"})})})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".15em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\", restoring the original embedding dimension.\\"]}),(0,n.jsx)(e.p,{children:\\"Finally, the concatenated output is passed through the last weight matrix. This produces the final output of the attention layer, concluding its computations.\\"}),(0,n.jsxs)(e.h2,{className:\\"content-header\\",id:\\"decoder\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#decoder\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Decoder\\"]}),(0,n.jsxs)(e.p,{children:[\\"Now that we have an understanding of the \\",(0,n.jsx)(e.strong,{children:\\"encoder\\"}),\\", we turn our attention to the \\",(0,n.jsx)(e.strong,{children:\\"decoder\\"}),\\". The decoder shares many similarities with the encoder but introduces two key distinctions. The first is the application of the \\",(0,n.jsx)(e.strong,{children:\\"causal mask\\"}),\\" in addition to the padding mask. The second is the inclusion of the \\",(0,n.jsx)(e.strong,{children:\\"cross-attention layer\\"}),\\". This layer allows the decoder to attend to the encoder\'s outputs,\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"class\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token class-name\\",children:\\"DecoderBlock\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Module\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"__init__\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"256\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"4\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1024\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"dropout\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0.1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"super\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"DecoderBlock\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"__init__\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"masked_multi_head_attention \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" MultiHeadAttention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"cross_multi_head_attention \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" MultiHeadAttention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm1 \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"LayerNorm\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm2 \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"LayerNorm\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm3 \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"LayerNorm\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"mlp \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Sequential\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                             nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"GELU\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                             nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Linear\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"                             nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Dropout\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"dropout\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"forward\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_causal_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    tgt_padding_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"tgt_causal_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"&\\"}),\\" tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"int\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    att_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"masked_multi_head_attention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    norm_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm1\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"att_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),\\" tgt \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    cross_attn_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"cross_multi_head_attention\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"norm_output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    norm_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm2\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"cross_attn_output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),\\" norm_output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    mlp_out \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"mlp\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"norm_output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"norm3\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"mlp_out \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),\\" norm_output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"class\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token class-name\\",children:\\"Decoder\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"Module\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"__init__\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"num_layers\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"6\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"256\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"4\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1024\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"super\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"Decoder\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"__init__\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"layers \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"ModuleList\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),\\"DecoderBlock\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"heads\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"hidden\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" i \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"num_layers\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"  \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"forward\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_causal_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" layer \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"layers\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"      tgt \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" layer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_causal_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"memory_padding_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),` tgt\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"The \\",(0,n.jsx)(e.strong,{children:\\"Decoder\\"}),\\" class assembles multiple \\",(0,n.jsx)(e.strong,{children:\\"DecoderBlocks\\"}),\\" and passes them the respective masks required for the attention mechanisms. Along with the target padding mask and causal mask, the decoder requires the memory (encoder output) and memory_padding_mask (source padding mask). In the \\",(0,n.jsx)(e.strong,{children:\\"DecoderBlock\\"}),\\", the target padding mask is combined with the causal mask to ensure that tokens in the target sequence cannot attend to padding tokens or tokens that come after them in the sequence. This combined mask is applied to the target tokens, which are then fed into the first attention block. he output of this block is processed using a skip connection, followed by a LayerNorm to stabilize training. Next, the cross-attention is computed. In this step, the target tokens (queries) attend to the encoder outputs (keys) and aggregate information from the encoder outputs (values) based on the attention mechanism. To ensure proper operation, the memory_padding_mask is applied so that padding tokens in the encoder outputs are ignored. After that the architecture of the decoder is same as the encoders.\\"]}),(0,n.jsxs)(e.h2,{className:\\"content-header\\",id:\\"training-loop\\",children:[(0,n.jsx)(e.a,{\\"aria-hidden\\":\\"true\\",href:\\"#training-loop\\",tabIndex:\\"-1\\",children:(0,n.jsx)(n.Fragment,{children:(0,n.jsx)(e.span,{className:\\"content-header-link\\",children:(0,n.jsxs)(e.svg,{viewBox:\\"0 0 20 20\\",xmlns:\\"http://www.w3.org/2000/svg\\",className:\\"h-5 linkicon w-5\\",fill:\\"currentColor\\",children:[(0,n.jsx)(e.path,{d:\\"M12.232 4.232a2.5 2.5 0 0 1 3.536 3.536l-1.225 1.224a.75.75 0 0 0 1.061 1.06l1.224-1.224a4 4 0 0 0-5.656-5.656l-3 3a4 4 0 0 0 .225 5.865.75.75 0 0 0 .977-1.138 2.5 2.5 0 0 1-.142-3.667l3-3Z\\"}),(0,n.jsx)(e.path,{d:\\"M11.603 7.963a.75.75 0 0 0-.977 1.138 2.5 2.5 0 0 1 .142 3.667l-3 3a2.5 2.5 0 0 1-3.536-3.536l1.225-1.224a.75.75 0 0 0-1.061-1.06l-1.224 1.224a4 4 0 1 0 5.656 5.656l3-3a4 4 0 0 0-.225-5.865Z\\"})]})})})}),\\"Training loop\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"warmup \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"10\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"2.5e-4\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"min_lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1e-6\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"class\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token class-name\\",children:\\"InverseSquareRootLR\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"optim\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"lr_scheduler\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"_LRScheduler\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"__init__\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" optimizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" warmup_steps\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" init_lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" min_lr\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1e-9\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" last_epoch\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"warmup_steps \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),` warmup_steps\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"init_lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),` init_lr\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"min_lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),` min_lr\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"super\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"InverseSquareRootLR\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"__init__\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"optimizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" last_epoch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"def\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token function\\",children:\\"get_lr\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        step \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"last_epoch \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"+\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"if\\"}),\\" step \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"<\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"warmup_steps\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"init_lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"*\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"step \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"/\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"warmup_steps\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"else\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"            lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"init_lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"*\\"}),\\" math\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"sqrt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"warmup_steps \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"/\\"}),\\" step\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        lr \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"max\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"min_lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"return\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),\\"lr \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" _ \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" self\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"base_lrs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"epochs \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"100\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"model \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" TranslationModel\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"512\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"optim \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"optim\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"AdamW\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"parameters\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"lr\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"betas\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0.9\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0.98\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"lr_scheduler \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" InverseSquareRootLR\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"optim\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"warmup\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"min_lr\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"min_lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"loss_fn \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"CrossEntropyLoss\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"ignore_index\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"pad_token_id\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" epoch \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token builtin\\",children:\\"range\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"epochs\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"for\\"}),\\" batch \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"in\\"}),\\" train_dataloader\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        src \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"input_ids\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        src_attention_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"src_mask\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        tgt \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"target\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        tgt_attention_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"target_mask\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"labels\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        pad_tokens \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"full\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"pad_token_id\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" dtype\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"dtype\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"cat\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" pad_tokens\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" dim\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_attention_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_attention_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        loss \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" loss_fn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        optim\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"zero_grad\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        loss\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"backward\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"utils\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"clip_grad_norm_\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"parameters\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" max_norm\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1.0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        optim\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"step\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"        lr_scheduler\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"step\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"    \\",(0,n.jsx)(e.span,{className:\\"token keyword\\",children:\\"print\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"loss\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`})]})}),(0,n.jsx)(e.p,{children:\\"Now lets first look at the model initialization code\\"}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"epochs \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"100\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"model \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" TranslationModel\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"vocab_size\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"d_model\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"512\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"src_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"trg_seq_len\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"optim \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"optim\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"AdamW\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"parameters\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"lr\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"betas\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0.9\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0.98\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"lr_scheduler \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" InverseSquareRootLR\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"optim\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"warmup\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"min_lr\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"min_lr\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"loss_fn \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" nn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"CrossEntropyLoss\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"ignore_index\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"pad_token_id\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"In this step, we initialize the model, set up the optimizer, and define the loss function. The loss function used is \\",(0,n.jsx)(e.strong,{children:\\"CrossEntropyLoss\\"}),\\", which is commonly employed for sequence-to-sequence tasks. CrossEntropyLoss is mathematically defined as:\\"]}),(0,n.jsx)(e.span,{className:\\"katex-display\\",children:(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",display:\\"block\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mtext,{children:\\"CrossEntropyLoss\\"}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mi,{children:\\"y\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsxs)(e.mover,{accent:\\"true\\",children:[(0,n.jsx)(e.mi,{children:\\"y\\"}),(0,n.jsx)(e.mo,{children:\\"^\\"})]}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"}),(0,n.jsx)(e.mo,{children:\\"=\\"}),(0,n.jsx)(e.mo,{children:\\"\\\\u2212\\"}),(0,n.jsxs)(e.mfrac,{children:[(0,n.jsx)(e.mn,{children:\\"1\\"}),(0,n.jsx)(e.mi,{children:\\"N\\"})]}),(0,n.jsxs)(e.munderover,{children:[(0,n.jsx)(e.mo,{children:\\"\\\\u2211\\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\\"i\\"}),(0,n.jsx)(e.mo,{children:\\"=\\"}),(0,n.jsx)(e.mn,{children:\\"1\\"})]}),(0,n.jsx)(e.mi,{children:\\"N\\"})]}),(0,n.jsxs)(e.munderover,{children:[(0,n.jsx)(e.mo,{children:\\"\\\\u2211\\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\\"j\\"}),(0,n.jsx)(e.mo,{children:\\"=\\"}),(0,n.jsx)(e.mn,{children:\\"1\\"})]}),(0,n.jsx)(e.mi,{children:\\"C\\"})]}),(0,n.jsxs)(e.msub,{children:[(0,n.jsx)(e.mi,{children:\\"y\\"}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\\"i\\"}),(0,n.jsx)(e.mi,{children:\\"j\\"})]})]}),(0,n.jsx)(e.mi,{children:\\"log\\"}),(0,n.jsx)(e.mo,{children:\\"\\\\u2061\\"}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsxs)(e.msub,{children:[(0,n.jsxs)(e.mover,{accent:\\"true\\",children:[(0,n.jsx)(e.mi,{children:\\"y\\"}),(0,n.jsx)(e.mo,{children:\\"^\\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\\"i\\"}),(0,n.jsx)(e.mi,{children:\\"j\\"})]})]}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\text{CrossEntropyLoss}(y, \\\\\\\\hat{y}) = - \\\\\\\\frac{1}{N} \\\\\\\\sum_{i=1}^N \\\\\\\\sum_{j=1}^C y_{ij} \\\\\\\\log(\\\\\\\\hat{y}_{ij})\\"})]})})}),(0,n.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"CrossEntropyLoss\\"})}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord accent\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".6944em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"accent-body\\",style:{left:\\"-.1944em\\"},children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"^\\"})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".1944em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,n.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"3.2421em\\",verticalAlign:\\"-1.4138em\\"}}),(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"\\\\u2212\\"}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mopen nulldelimiter\\"}),(0,n.jsx)(e.span,{className:\\"mfrac\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.3214em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-2.314em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord\\",children:(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10903em\\"},children:\\"N\\"})})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.23em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"frac-line\\",style:{borderBottomWidth:\\".04em\\"}})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.677em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"1\\"})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".686em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"mclose nulldelimiter\\"})]}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mop op-limits\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.8283em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-1.8723em\\",marginLeft:\\"0\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.05em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",children:\\"i\\"}),(0,n.jsx)(e.span,{className:\\"mtight mrel\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.05em\\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\\"mop op-symbol large-op\\",children:\\"\\\\u2211\\"})})]}),(0,n.jsxs)(e.span,{style:{top:\\"-4.3em\\",marginLeft:\\"0\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.05em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".10903em\\"},children:\\"N\\"})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"1.2777em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mop op-limits\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\"1.8283em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-1.8723em\\",marginLeft:\\"0\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.05em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsxs)(e.span,{className:\\"mord mtight\\",children:[(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"}),(0,n.jsx)(e.span,{className:\\"mtight mrel\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:\\"1\\"})]})})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3.05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.05em\\"}}),(0,n.jsx)(e.span,{children:(0,n.jsx)(e.span,{className:\\"mop op-symbol large-op\\",children:\\"\\\\u2211\\"})})]}),(0,n.jsxs)(e.span,{style:{top:\\"-4.3em\\",marginLeft:\\"0\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3.05em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"C\\"})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\"1.4138em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"ij\\"})})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsxs)(e.span,{className:\\"mop\\",children:[\\"lo\\",(0,n.jsx)(e.span,{style:{marginRight:\\".01389em\\"},children:\\"g\\"})]}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord accent\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".6944em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"accent-body\\",style:{left:\\"-.1944em\\"},children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"^\\"})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".1944em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"ij\\"})})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,n.jsx)(e.span,{})})})]})})]}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]})}),(0,n.jsx)(e.p,{children:\\"Here:\\"}),(0,n.jsxs)(e.ul,{children:[(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\\"y\\"})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"y\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".625em\\",verticalAlign:\\"-.1944em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})]})})]}),\\" represents the true distribution (one-hot encoded ground truth).\\"]}),(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.mover,{accent:\\"true\\",children:[(0,n.jsx)(e.mi,{children:\\"y\\"}),(0,n.jsx)(e.mo,{children:\\"^\\"})]})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\hat{y}\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".8889em\\",verticalAlign:\\"-.1944em\\"}}),(0,n.jsx)(e.span,{className:\\"mord accent\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".6944em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"accent-body\\",style:{left:\\"-.1944em\\"},children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"^\\"})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".1944em\\"},children:(0,n.jsx)(e.span,{})})})]})})]})})]}),\\" represents the predicted probability distribution from the model.\\"]}),(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\\"N\\"})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"N\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".10903em\\"},children:\\"N\\"})]})})]}),\\" is the number of samples in the batch.\\"]}),(0,n.jsxs)(e.li,{children:[(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsx)(e.mi,{children:\\"C\\"})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"C\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".6833em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".07153em\\"},children:\\"C\\"})]})})]}),\\" is the number of classes (vocabulary size in this case).\\"]})]}),(0,n.jsxs)(e.p,{children:[\\"This loss function calculates the negative log likelihood of the correct class, weighted by the true distribution. It is averaged over all tokens in the batch, penalizing predictions that deviate from the true class probabilities. The \\",(0,n.jsx)(e.code,{children:\\"ignore_index\\"}),\\" parameter tells the CrossEntropyLoss to set probabilities \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsx)(e.mrow,{children:(0,n.jsxs)(e.msub,{children:[(0,n.jsxs)(e.mover,{accent:\\"true\\",children:[(0,n.jsx)(e.mi,{children:\\"y\\"}),(0,n.jsx)(e.mo,{children:\\"^\\"})]}),(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\\"i\\"}),(0,n.jsx)(e.mi,{children:\\"j\\"})]})]})}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"\\\\\\\\hat{y}_{ij}\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".9805em\\",verticalAlign:\\"-.2861em\\"}}),(0,n.jsxs)(e.span,{className:\\"mord\\",children:[(0,n.jsx)(e.span,{className:\\"mord accent\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist\\",style:{height:\\".6944em\\"},children:[(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".03588em\\"},children:\\"y\\"})]}),(0,n.jsxs)(e.span,{style:{top:\\"-3em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"3em\\"}}),(0,n.jsx)(e.span,{className:\\"accent-body\\",style:{left:\\"-.1944em\\"},children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"^\\"})})]})]}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".1944em\\"},children:(0,n.jsx)(e.span,{})})})]})}),(0,n.jsx)(e.span,{className:\\"msupsub\\",children:(0,n.jsxs)(e.span,{className:\\"vlist-t vlist-t2\\",children:[(0,n.jsxs)(e.span,{className:\\"vlist-r\\",children:[(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".3117em\\"},children:(0,n.jsxs)(e.span,{style:{top:\\"-2.55em\\",marginLeft:\\"-.0359em\\",marginRight:\\".05em\\"},children:[(0,n.jsx)(e.span,{className:\\"pstrut\\",style:{height:\\"2.7em\\"}}),(0,n.jsx)(e.span,{className:\\"mtight sizing reset-size6 size3\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight\\",children:(0,n.jsx)(e.span,{className:\\"mord mtight mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"ij\\"})})})]})}),(0,n.jsx)(e.span,{className:\\"vlist-s\\",children:\\"\\\\u200B\\"})]}),(0,n.jsx)(e.span,{className:\\"vlist-r\\",children:(0,n.jsx)(e.span,{className:\\"vlist\\",style:{height:\\".2861em\\"},children:(0,n.jsx)(e.span,{})})})]})})]})]})})]}),\\" to 0, where \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mi,{children:\\"j\\"}),(0,n.jsx)(e.mo,{children:\\"=\\"}),(0,n.jsx)(e.mtext,{children:\\"pad_token_id\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"j= \\\\\\\\text{pad\\\\\\\\_token\\\\\\\\_id}\\"})]})})}),(0,n.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\".854em\\",verticalAlign:\\"-.1944em\\"}}),(0,n.jsx)(e.span,{className:\\"mord mathnormal\\",style:{marginRight:\\".05724em\\"},children:\\"j\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}}),(0,n.jsx)(e.span,{className:\\"mrel\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2778em\\"}})]}),(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.0044em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"pad_token_id\\"})})]})]})]}),\\". This will exclude the padding values in the loss computation.\\"]}),(0,n.jsxs)(e.p,{children:[\\"Next, we adjust the shape of the label tokens to ensure they align correctly with the target tokens. Both the target tokens and the label tokens currently contain \\",(0,n.jsx)(e.code,{children:\\"<START>\\"}),\\" and \\",(0,n.jsx)(e.code,{children:\\"<END>\\"}),\\" tokens. However, for training, the labels need to be shifted one token to the left.\\"]}),(0,n.jsxs)(e.p,{children:[\\"This means the \\",(0,n.jsx)(e.code,{children:\\"<START>\\"}),\\" token is removed from the labels, and a \\",(0,n.jsx)(e.code,{children:\\"<PAD>\\"}),\\" token is added at the end to maintain the correct sequence length. This shift ensures that each label token corresponds to the prediction of the decoder for the previous target token.\\"]}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"src \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"input_ids\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"src_attention_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"src_mask\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"tgt \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"target\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"tgt_attention_mask \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"target_mask\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" batch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token string\\",children:\'\\"labels\\"\'}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\":\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"pad_tokens \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"full\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"0\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" \\",(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" tokenizer\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"pad_token_id\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" dtype\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"dtype\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"to\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"device\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" torch\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"cat\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" pad_tokens\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\" dim\\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsx)(e.p,{children:\\"We then feed in these inputs into the model.\\"}),(0,n.jsx)(e.pre,{className:\\"language-python\\",children:(0,n.jsxs)(e.code,{className:\\"language-python code-highlight\\",children:[(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" model\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"src\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"src_attention_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"tgt_attention_mask\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"output \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"shape\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"[\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"]\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"labels \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\".\\"}),\\"view\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"-\\"}),(0,n.jsx)(e.span,{className:\\"token number\\",children:\\"1\\"}),(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]}),(0,n.jsx)(e.span,{className:\\"code-line\\",children:`\\n`}),(0,n.jsxs)(e.span,{className:\\"code-line\\",children:[\\"loss \\",(0,n.jsx)(e.span,{className:\\"token operator\\",children:\\"=\\"}),\\" loss_fn\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\"(\\"}),\\"output\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\",\\"}),\\"labels\\",(0,n.jsx)(e.span,{className:\\"token punctuation\\",children:\\")\\"}),`\\n`]})]})}),(0,n.jsxs)(e.p,{children:[\\"After processing, the model produces an output tensor of shape \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mtext,{children:\\"batch\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mtext,{children:\\"seq_len\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mtext,{children:\\"vocab_size\\"}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"(\\\\\\\\text{batch}, \\\\\\\\text{seq\\\\\\\\_len}, \\\\\\\\text{vocab\\\\\\\\_size})\\"})]})})}),(0,n.jsx)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"batch\\"})}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"seq_len\\"})}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"vocab_size\\"})}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})})]}),\\". This tensor contains the prediction vectors for the entire vocabulary at each position in the sequence. These vectors do not represent probabilities yet, as the \\",(0,n.jsx)(e.strong,{children:\\"CrossEntropyLoss\\"}),\\" function internally applies a softmax operation to convert them into probabilities. For the \\",(0,n.jsx)(e.strong,{children:\\"CrossEntropyLoss\\"}),\\" to work with a batched case, it expects a 2D tensor as input. To satisfy this requirement, we reshape the output tensor into the shape \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mtext,{children:\\"batch\\"}),(0,n.jsx)(e.mo,{children:\\"\\\\xD7\\"}),(0,n.jsx)(e.mtext,{children:\\"seq_len\\"}),(0,n.jsx)(e.mo,{separator:\\"true\\",children:\\",\\"}),(0,n.jsx)(e.mtext,{children:\\"vocab_size\\"}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"(\\\\\\\\text{batch} \\\\\\\\times \\\\\\\\text{seq\\\\\\\\_len}, \\\\\\\\text{vocab\\\\\\\\_size})\\"})]})})}),(0,n.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"batch\\"})}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,n.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\xD7\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"seq_len\\"})}),(0,n.jsx)(e.span,{className:\\"mpunct\\",children:\\",\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".1667em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"vocab_size\\"})}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]}),\\", effectively flattening the batch and sequence dimensions while keeping the vocabulary dimension intact.\\"]}),(0,n.jsxs)(e.p,{children:[\\"Similarly, the label tensor is reshaped to have the shape \\",(0,n.jsxs)(e.span,{className:\\"katex\\",children:[(0,n.jsx)(e.span,{className:\\"katex-mathml\\",children:(0,n.jsx)(e.math,{xmlns:\\"http://www.w3.org/1998/Math/MathML\\",children:(0,n.jsxs)(e.semantics,{children:[(0,n.jsxs)(e.mrow,{children:[(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\"(\\"}),(0,n.jsx)(e.mtext,{children:\\"batch\\"}),(0,n.jsx)(e.mo,{children:\\"\\\\xD7\\"}),(0,n.jsx)(e.mtext,{children:\\"seq_len\\"}),(0,n.jsx)(e.mo,{stretchy:\\"false\\",children:\\")\\"})]}),(0,n.jsx)(e.annotation,{encoding:\\"application/x-tex\\",children:\\"(\\\\\\\\text{batch} \\\\\\\\times \\\\\\\\text{seq\\\\\\\\_len})\\"})]})})}),(0,n.jsxs)(e.span,{className:\\"katex-html\\",\\"aria-hidden\\":\\"true\\",children:[(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1em\\",verticalAlign:\\"-.25em\\"}}),(0,n.jsx)(e.span,{className:\\"mopen\\",children:\\"(\\"}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"batch\\"})}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}}),(0,n.jsx)(e.span,{className:\\"mbin\\",children:\\"\\\\xD7\\"}),(0,n.jsx)(e.span,{className:\\"mspace\\",style:{marginRight:\\".2222em\\"}})]}),(0,n.jsxs)(e.span,{className:\\"base\\",children:[(0,n.jsx)(e.span,{className:\\"strut\\",style:{height:\\"1.06em\\",verticalAlign:\\"-.31em\\"}}),(0,n.jsx)(e.span,{className:\\"mord text\\",children:(0,n.jsx)(e.span,{className:\\"mord\\",children:\\"seq_len\\"})}),(0,n.jsx)(e.span,{className:\\"mclose\\",children:\\")\\"})]})]})]}),\\". This ensures that each label aligns correctly with the corresponding prediction vector for the loss calculation.\\"]}),(0,n.jsxs)(e.p,{children:[\\"Now lettings this run will train our model to translate german into english sentences. With this current configuration the model contains roughly 75M parameters. In the next post, we will explore how to adjust this architecture to recreate the well-known \\",(0,n.jsx)(e.strong,{children:\\"Llama 3\\"}),\\" foundational language model from Meta. While the current implementation of our Transformer adheres closely to its vanilla formulation, Llama 3 represents a state-of-the-art large language model (LLM) that builds on and extends the original Transformer design. We will delve into the architectural changes and optimizations that have been introduced since the original Transformer, examining how these innovations contribute to the exceptional performance of a model like Llama 3.\\"]})]})}function d(a={}){let{wrapper:e}=a.components||{};return e?(0,n.jsx)(e,{...a,children:(0,n.jsx)(p,{...a})}):p(a)}return f(w);})();\\n;return Component;"},"_id":"blog/transfromer-01.mdx","_raw":{"sourceFilePath":"blog/transfromer-01.mdx","sourceFileName":"transfromer-01.mdx","sourceFileDir":"blog","contentType":"mdx","flattenedPath":"blog/transfromer-01"},"type":"Blog","readingTime":{"text":"14 min read","minutes":13.73,"time":823800,"words":2746},"slug":"transfromer-01","path":"blog/transfromer-01","filePath":"blog/transfromer-01.mdx","toc":[{"value":"Introduction","url":"#introduction","depth":3},{"value":"Dataset Preparation and Preprocessing","url":"#dataset-preparation-and-preprocessing","depth":3},{"value":"Loading the Dataset","url":"#loading-the-dataset","depth":4},{"value":"Initializing the Tokenizer","url":"#initializing-the-tokenizer","depth":4},{"value":"Tokenization","url":"#tokenization","depth":4},{"value":"Handling Input and Output Sequences","url":"#handling-input-and-output-sequences","depth":4},{"value":"The Translation Model","url":"#the-translation-model","depth":2},{"value":"Encoder","url":"#encoder","depth":2},{"value":"Multi-Head Attention","url":"#multi-head-attention","depth":2},{"value":"Decoder","url":"#decoder","depth":2},{"value":"Training loop","url":"#training-loop","depth":2}],"structuredData":{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introduction to Transformers - Part 01 - Implementation of a translation model","datePublished":"2024-10-13T00:00:00.000Z","dateModified":"2024-10-13T00:00:00.000Z","description":"A full implementation of the Transformer architecture in PyTorch, built entirely from scratch, designed specifically for use in a translation model.","image":"/static/images/twitter-card.png","url":"https://janhardtke.com/blog/transfromer-01"}},{"title":"Introduction to Transformers - Part 02 - Llama 3 - Building a LLM from scratch","date":"2024-10-25T00:00:00.000Z","tags":["transformer","nlp","code"],"draft":false,"summary":"Learn how to adapt the vanilla Transformer to build a state-of-the-art LLM like Meta\'s Llama 3, exploring key architectural changes and optimizations.","body":{"raw":"","code":"var Component=(()=>{var u=Object.create;var o=Object.defineProperty;var d=Object.getOwnPropertyDescriptor;var x=Object.getOwnPropertyNames;var L=Object.getPrototypeOf,h=Object.prototype.hasOwnProperty;var p=(t,a)=>()=>(a||t((a={exports:{}}).exports,a),a.exports),g=(t,a)=>{for(var r in a)o(t,r,{get:a[r],enumerable:!0})},i=(t,a,r,s)=>{if(a&&typeof a==\\"object\\"||typeof a==\\"function\\")for(let n of x(a))!h.call(t,n)&&n!==r&&o(t,n,{get:()=>a[n],enumerable:!(s=d(a,n))||s.enumerable});return t};var M=(t,a,r)=>(r=t!=null?u(L(t)):{},i(a||!t||!t.__esModule?o(r,\\"default\\",{value:t,enumerable:!0}):r,t)),_=t=>i(o({},\\"__esModule\\",{value:!0}),t);var c=p((w,m)=>{m.exports=_jsx_runtime});var y={};g(y,{default:()=>f,frontmatter:()=>j});var e=M(c()),j={title:\\"Introduction to Transformers - Part 02 - Llama 3 - Building a LLM from scratch\\",date:\\"2024-10-25\\",tags:[\\"transformer\\",\\"nlp\\",\\"code\\"],draft:!1,summary:\\"Learn how to adapt the vanilla Transformer to build a state-of-the-art LLM like Meta\'s Llama 3, exploring key architectural changes and optimizations.\\"};function l(t){return(0,e.jsx)(e.Fragment,{})}function f(t={}){let{wrapper:a}=t.components||{};return a?(0,e.jsx)(a,{...t,children:(0,e.jsx)(l,{...t})}):l(t)}return _(y);})();\\n;return Component;"},"_id":"blog/transfromer-02.mdx","_raw":{"sourceFilePath":"blog/transfromer-02.mdx","sourceFileName":"transfromer-02.mdx","sourceFileDir":"blog","contentType":"mdx","flattenedPath":"blog/transfromer-02"},"type":"Blog","readingTime":{"text":"0 min read","minutes":0,"time":0,"words":0},"slug":"transfromer-02","path":"blog/transfromer-02","filePath":"blog/transfromer-02.mdx","toc":[],"structuredData":{"@context":"https://schema.org","@type":"BlogPosting","headline":"Introduction to Transformers - Part 02 - Llama 3 - Building a LLM from scratch","datePublished":"2024-10-25T00:00:00.000Z","dateModified":"2024-10-25T00:00:00.000Z","description":"Learn how to adapt the vanilla Transformer to build a state-of-the-art LLM like Meta\'s Llama 3, exploring key architectural changes and optimizations.","image":"/static/images/twitter-card.png","url":"https://janhardtke.com/blog/transfromer-02"}}]'),t=JSON.parse('[{"name":"Jan Hardtke","avatar":"/static/images/avatar.jpeg","body":{"raw":"","code":"var Component=(()=>{var f=Object.create;var o=Object.defineProperty;var _=Object.getOwnPropertyDescriptor;var d=Object.getOwnPropertyNames;var g=Object.getPrototypeOf,j=Object.prototype.hasOwnProperty;var p=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),M=(t,e)=>{for(var n in e)o(t,n,{get:e[n],enumerable:!0})},s=(t,e,n,m)=>{if(e&&typeof e==\\"object\\"||typeof e==\\"function\\")for(let r of d(e))!j.call(t,r)&&r!==n&&o(t,r,{get:()=>e[r],enumerable:!(m=_(e,r))||m.enumerable});return t};var l=(t,e,n)=>(n=t!=null?f(g(t)):{},s(e||!t||!t.__esModule?o(n,\\"default\\",{value:t,enumerable:!0}):n,t)),v=t=>s(o({},\\"__esModule\\",{value:!0}),t);var i=p((X,c)=>{c.exports=_jsx_runtime});var D={};M(D,{default:()=>x,frontmatter:()=>C});var a=l(i()),C={name:\\"Jan Hardtke\\",avatar:\\"/static/images/avatar.jpeg\\"};function u(t){return(0,a.jsx)(a.Fragment,{})}function x(t={}){let{wrapper:e}=t.components||{};return e?(0,a.jsx)(e,{...t,children:(0,a.jsx)(u,{...t})}):u(t)}return v(D);})();\\n;return Component;"},"_id":"authors/default.mdx","_raw":{"sourceFilePath":"authors/default.mdx","sourceFileName":"default.mdx","sourceFileDir":"authors","contentType":"mdx","flattenedPath":"authors/default"},"type":"Authors","readingTime":{"text":"0 min read","minutes":0,"time":0,"words":0},"slug":"default","path":"authors/default","filePath":"authors/default.mdx","toc":[]}]');[...n,...t]}};